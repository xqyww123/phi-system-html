<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"/><link rel="stylesheet" type="text/css" href="isabelle.css"/>
<title>Theory Phi_Semantics.PhiSem_Mem_C_Base</title>
</head>


<body>
<div class="head">
<h1>Theory Phi_Semantics.PhiSem_Mem_C_Base</h1>
</div>

<pre class="source"><span class="keyword1"><span class="command"><span>theory</span></span></span><span> </span><a href="Phi_Semantics.PhiSem_Mem_C_Base.html"><span>PhiSem_Mem_C_Base</span></a><span>
  </span><span class="keyword2"><span class="keyword"><span>imports</span></span></span><span> </span><a href="../Phi_Semantics/PhiSem_Aggregate_Base.html"><span>PhiSem_Aggregate_Base</span></a><span> </span><a href="../Phi_Semantics/Phi_System.Resource_Template.html"><span>Phi_System.Resource_Template</span></a><span> </span><a href="../Phi_Semantics/PhiSem_Void.html"><span>PhiSem_Void</span></a><span>
</span><span class="keyword2"><span class="keyword"><span>begin</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>section</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹Semantics›</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>debt_axiomatization</span></span></span><span>
        </span><span class="free"><span class="entity_def" id="PhiSem_Mem_C_Base.MemObj_Size|const"><span>MemObj_Size</span></span></span><span>     </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>‹</span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Semantics_Framework.html#Phi_Semantics_Framework.TY|type"><span>TY</span></a><span> </span><span class="main"><span>⇒</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.nat|type"><span>nat</span></a><span>›</span></span></span><span>
    </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="free"><span class="entity_def" id="PhiSem_Mem_C_Base.idx_step_offset|const"><span>idx_step_offset</span></span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>‹</span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Semantics_Framework.html#Phi_Semantics_Framework.TY|type"><span>TY</span></a><span> </span><span class="main"><span>⇒</span></span><span> </span><a class="entity_ref" href="../Phi_System/Phi_Element_Path.html#Phi_Element_Path.aggregate_index|type"><span>aggregate_index</span></a><span> </span><span class="main"><span>⇒</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.nat|type"><span>nat</span></a><span>›</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="entity_def" id="PhiSem_Mem_C_Base.memobj_size_step|fact"><span class="entity_def" id="PhiSem_Mem_C_Base.memobj_size_step|thm"><span>memobj_size_step</span></span></span><span> </span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>‹</span><a class="entity_ref" href="../Phi_Semantics/PhiSem_Aggregate_Base.html#PhiSem_Aggregate_Base.valid_idx_step|const"><span>valid_idx_step</span></a><span> </span><span class="free"><span>T</span></span><span> </span><span class="free"><span>i</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="free"><span>MemObj_Size</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Phi_Semantics/PhiSem_Aggregate_Base.html#PhiSem_Aggregate_Base.idx_step_type|const"><span>idx_step_type</span></a><span> </span><span class="free"><span>i</span></span><span> </span><span class="free"><span>T</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span> </span><span class="free"><span>MemObj_Size</span></span><span> </span><span class="free"><span>T</span></span><span>›</span></span></span><span>
    </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="entity_def" id="PhiSem_Mem_C_Base.idx_step_offset_size|fact"><span class="entity_def" id="PhiSem_Mem_C_Base.idx_step_offset_size|thm"><span>idx_step_offset_size</span></span></span><span class="main"><span>:</span></span><span>
          </span><span class="quoted"><span class="quoted"><span>‹</span><a class="entity_ref" href="../Phi_Semantics/PhiSem_Aggregate_Base.html#PhiSem_Aggregate_Base.valid_idx_step|const"><span>valid_idx_step</span></a><span> </span><span class="free"><span>T</span></span><span> </span><span class="free"><span>i</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="free"><span>idx_step_offset</span></span><span> </span><span class="free"><span>T</span></span><span> </span><span class="free"><span>i</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span> </span><span class="free"><span>MemObj_Size</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Phi_Semantics/PhiSem_Aggregate_Base.html#PhiSem_Aggregate_Base.idx_step_type|const"><span>idx_step_type</span></a><span> </span><span class="free"><span>i</span></span><span> </span><span class="free"><span>T</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span> </span><span class="free"><span>MemObj_Size</span></span><span> </span><span class="free"><span>T</span></span><span>›</span></span></span><span>
    </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="entity_def" id="PhiSem_Mem_C_Base.idx_step_offset_no_overlap|fact"><span class="entity_def" id="PhiSem_Mem_C_Base.idx_step_offset_no_overlap|thm"><span>idx_step_offset_no_overlap</span></span></span><span class="main"><span>:</span></span><span>
          </span><span class="quoted"><span class="quoted"><span>‹</span><a class="entity_ref" href="../Phi_Semantics/PhiSem_Aggregate_Base.html#PhiSem_Aggregate_Base.valid_idx_step|const"><span>valid_idx_step</span></a><span> </span><span class="free"><span>T</span></span><span> </span><span class="free"><span>i</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><a class="entity_ref" href="../Phi_Semantics/PhiSem_Aggregate_Base.html#PhiSem_Aggregate_Base.valid_idx_step|const"><span>valid_idx_step</span></a><span> </span><span class="free"><span>T</span></span><span> </span><span class="free"><span>j</span></span><span> </span><span class="main"><span>⟹</span></span><span>
                </span><span class="free"><span>idx_step_offset</span></span><span> </span><span class="free"><span>T</span></span><span> </span><span class="free"><span>i</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span> </span><span class="free"><span>idx_step_offset</span></span><span> </span><span class="free"><span>T</span></span><span> </span><span class="free"><span>j</span></span><span> </span><span class="main"><span>⟹</span></span><span>
                </span><span class="free"><span>idx_step_offset</span></span><span> </span><span class="free"><span>T</span></span><span> </span><span class="free"><span>j</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span> </span><span class="free"><span>idx_step_offset</span></span><span> </span><span class="free"><span>T</span></span><span> </span><span class="free"><span>i</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span> </span><span class="free"><span>MemObj_Size</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Phi_Semantics/PhiSem_Aggregate_Base.html#PhiSem_Aggregate_Base.idx_step_type|const"><span>idx_step_type</span></a><span> </span><span class="free"><span>i</span></span><span> </span><span class="free"><span>T</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>⟹</span></span><span>
                </span><span class="free"><span>i</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="free"><span>j</span></span><span>›</span></span></span><span>
    </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="entity_def" id="PhiSem_Mem_C_Base.memobj_size_void|fact"><span class="entity_def" id="PhiSem_Mem_C_Base.memobj_size_void|thm"><span>memobj_size_void</span></span></span><span class="main"><span>[</span></span><span class="operator"><span>simp</span></span><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>‹</span><span class="free"><span>MemObj_Size</span></span><span> </span><a class="entity_ref" href="../Phi_Semantics/PhiSem_Void.html#PhiSem_Void.\&lt;v&gt;\&lt;o&gt;\&lt;i&gt;\&lt;d&gt;|const"><span>𝗏𝗈𝗂𝖽</span></a><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span>›</span></span></span><span>
    </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="entity_def" id="PhiSem_Mem_C_Base.phantom_mem_value_uniq|fact"><span class="entity_def" id="PhiSem_Mem_C_Base.phantom_mem_value_uniq|thm"><span>phantom_mem_value_uniq</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>‹</span><span class="free"><span>MemObj_Size</span></span><span> </span><span class="free"><span>TY</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="free"><span>u</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span> </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Semantics_Framework.html#Phi_Semantics_Framework.Well_Type|const"><span>Well_Type</span></a><span> </span><span class="free"><span>TY</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="free"><span>v</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span> </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Semantics_Framework.html#Phi_Semantics_Framework.Well_Type|const"><span>Well_Type</span></a><span> </span><span class="free"><span>TY</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="free"><span>u</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="free"><span>v</span></span><span>›</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="PhiSem_Mem_C_Base.index_offset.simps|fact"><span class="entity_def" id="PhiSem_Mem_C_Base.index_offset_def|fact"><span class="entity_def" id="PhiSem_Mem_C_Base.index_offset.simps(2)|thm"><span class="entity_def" id="PhiSem_Mem_C_Base.index_offset.simps(1)|thm"><span class="entity_def" id="PhiSem_Mem_C_Base.index_offset_def|thm"><span class="entity_def" id="PhiSem_Mem_C_Base.index_offset_def|axiom"><span>primrec</span></span></span></span></span></span></span></span></span><span> </span><span class="entity"><span class="entity_def" id="PhiSem_Mem_C_Base.index_offset|const"><span>index_offset</span></span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>‹</span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Semantics_Framework.html#Phi_Semantics_Framework.TY|type"><span>TY</span></a><span> </span><span class="main"><span>⇒</span></span><span> </span><a class="entity_ref" href="../Phi_System/Phi_Element_Path.html#Phi_Element_Path.aggregate_path|type"><span>aggregate_path</span></a><span> </span><span class="main"><span>⇒</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.nat|type"><span>nat</span></a><span>›</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>‹</span><span class="free"><span>index_offset</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>T</span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/List.html#List.list.Nil|const"><span>[]</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span>›</span></span></span><span>
      </span><span class="main"><span>|</span></span><span> </span><span class="quoted"><span class="quoted"><span>‹</span><span class="free"><span>index_offset</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>T</span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span class="bound"><span class="entity"><span>i</span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/List.html#List.list.Cons|const"><span>#</span></a></span><span class="free"><span class="bound"><span class="entity"><span>idx</span></span></span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#PhiSem_Mem_C_Base.idx_step_offset|const"><span>idx_step_offset</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>T</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>i</span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span> </span><span class="free"><span>index_offset</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Phi_Semantics/PhiSem_Aggregate_Base.html#PhiSem_Aggregate_Base.idx_step_type|const"><span>idx_step_type</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>i</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>T</span></span></span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>idx</span></span></span></span><span>›</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="PhiSem_Mem_C_Base.index_offset_tail|fact"><span class="entity_def" id="PhiSem_Mem_C_Base.index_offset_tail|thm"><span>index_offset_tail</span></span></span><span class="main"><span>[</span></span><span class="operator"><span>simp</span></span><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span>
  </span><span class="quoted"><span class="quoted"><span>‹</span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#PhiSem_Mem_C_Base.index_offset|const"><span>index_offset</span></a><span> </span><span class="free"><span>T</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>idx</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/List.html#List.append|const"><span>@</span></a></span><span class="main"><span>[</span></span><span class="free"><span>i</span></span><span class="main"><span>]</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#PhiSem_Mem_C_Base.index_offset|const"><span>index_offset</span></a><span> </span><span class="free"><span>T</span></span><span> </span><span class="free"><span>idx</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span> </span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#PhiSem_Mem_C_Base.idx_step_offset|const"><span>idx_step_offset</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Phi_Semantics/PhiSem_Aggregate_Base.html#PhiSem_Aggregate_Base.index_type|const"><span>index_type</span></a><span> </span><span class="free"><span>idx</span></span><span> </span><span class="free"><span>T</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>i</span></span><span>›</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Tools/induct.ML.html#HOL.induct|method"><span class="operator"><span>induct</span></span></a><span> </span><span class="quoted"><span class="free"><span>idx</span></span></span><span> </span><span class="quasi_keyword"><span>arbitrary</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><span class="quoted"><span class="free"><span>T</span></span></span><span class="main"><span class="keyword3"><span>;</span></span></span><span> </span><span class="operator"><span>simp</span></span><span class="main"><span>)</span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="PhiSem_Mem_C_Base.fold_tail|fact"><span class="entity_def" id="PhiSem_Mem_C_Base.fold_tail|thm"><span>fold_tail</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="quoted"><span class="quoted"><span>‹</span><a class="entity_ref" href="../../HOL/HOL/List.html#List.fold|const"><span>fold</span></a><span> </span><span class="free"><span>f</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>l</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/List.html#List.append|const"><span>@</span></a></span><span> </span><span class="main"><span>[</span></span><span class="free"><span>x</span></span><span class="main"><span>]</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="free"><span>f</span></span><span> </span><span class="free"><span>x</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/Fun.html#Fun.comp|const"><span>o</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/List.html#List.fold|const"><span>fold</span></a><span> </span><span class="free"><span>f</span></span><span> </span><span class="free"><span>l</span></span><span>›</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Tools/induct.ML.html#HOL.induct|method"><span class="operator"><span>induct</span></span></a><span> </span><span class="quoted"><span class="free"><span>l</span></span></span><span class="main"><span class="keyword3"><span>;</span></span></span><span> </span><span class="operator"><span>simp</span></span><span class="main"><span>)</span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="PhiSem_Mem_C_Base.index_offset_upper_bound|fact"><span class="entity_def" id="PhiSem_Mem_C_Base.index_offset_upper_bound|thm"><span>index_offset_upper_bound</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="quoted"><span class="quoted"><span>‹</span><a class="entity_ref" href="../Phi_Semantics/PhiSem_Aggregate_Base.html#PhiSem_Aggregate_Base.valid_index|const"><span>valid_index</span></a><span> </span><span class="free"><span>T</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>base</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/List.html#List.append|const"><span>@</span></a></span><span class="free"><span>idx</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>⟹</span></span><span>
   </span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#PhiSem_Mem_C_Base.index_offset|const"><span>index_offset</span></a><span> </span><span class="free"><span>T</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>base</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/List.html#List.append|const"><span>@</span></a></span><span class="free"><span>idx</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span> </span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#PhiSem_Mem_C_Base.MemObj_Size|const"><span>MemObj_Size</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Phi_Semantics/PhiSem_Aggregate_Base.html#PhiSem_Aggregate_Base.index_type|const"><span>index_type</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span>base</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/List.html#List.append|const"><span>@</span></a></span><span class="free"><span>idx</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>T</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span> </span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#PhiSem_Mem_C_Base.index_offset|const"><span>index_offset</span></a><span> </span><span class="free"><span>T</span></span><span> </span><span class="free"><span>base</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span> </span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#PhiSem_Mem_C_Base.MemObj_Size|const"><span>MemObj_Size</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Phi_Semantics/PhiSem_Aggregate_Base.html#PhiSem_Aggregate_Base.index_type|const"><span>index_type</span></a><span> </span><span class="free"><span>base</span></span><span> </span><span class="free"><span>T</span></span><span class="main"><span>)</span></span><span>›</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Tools/induct.ML.html#HOL.induct|method"><span class="operator"><span>induct</span></span></a><span> </span><span class="quoted"><span class="free"><span>idx</span></span></span><span> </span><span class="quasi_keyword"><span>arbitrary</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><span class="quoted"><span class="free"><span>base</span></span></span><span> </span><span class="quasi_keyword"><span>rule</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/List.html#List.rev_induct|fact"><span>rev_induct</span></a><span class="main"><span class="keyword3"><span>;</span></span></span><span>
      </span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>del</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/List.html#List.append_assoc|fact"><span>append_assoc</span></a><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/List.html#List.append_assoc|fact"><span>append_assoc</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>symmetric</span></span><span class="main"><span class="main"><span>]</span></span></span><span> </span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#PhiSem_Mem_C_Base.fold_tail|fact"><span>fold_tail</span></a><span class="main"><span class="keyword3"><span>;</span></span></span><span>
      </span><span class="operator"><span>insert</span></span><span> </span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#PhiSem_Mem_C_Base.idx_step_offset_size|fact"><span>idx_step_offset_size</span></a><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.fastforce|method"><span class="operator"><span>fastforce</span></span></a><span class="main"><span>)</span></span><span>

</span><span class="keyword1"><span class="command"><span>lemmas</span></span></span><span> </span><span class="entity_def" id="PhiSem_Mem_C_Base.index_offset_upper_bound_0|fact"><span class="entity_def" id="PhiSem_Mem_C_Base.index_offset_upper_bound_0|thm"><span>index_offset_upper_bound_0</span></span></span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#PhiSem_Mem_C_Base.index_offset_upper_bound|fact"><span>index_offset_upper_bound</span></a><span class="main"><span>[</span></span><span class="keyword2"><span class="keyword"><a class="entity_ref" href="../Phi_System/ISABELLE_HOME/src/HOL/Eisbach/eisbach_rule_insts.ML.html#Eisbach.where|attribute"><span class="operator"><span>where</span></span></a></span></span><span> base </span><span class="main"><span class="main"><span>=</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><a class="entity_ref" href="../../HOL/HOL/List.html#List.list.Nil|const"><span>[]</span></a></span><span>"</span></span></span><span class="main"><span>,</span></span><span> </span><span class="operator"><span>simplified</span></span><span class="main"><span>]</span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="PhiSem_Mem_C_Base.index_offset_bound|fact"><span class="entity_def" id="PhiSem_Mem_C_Base.index_offset_bound|thm"><span>index_offset_bound</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="quoted"><span class="quoted"><span>‹</span><a class="entity_ref" href="../Phi_Semantics/PhiSem_Aggregate_Base.html#PhiSem_Aggregate_Base.valid_index|const"><span>valid_index</span></a><span> </span><span class="free"><span>T</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>base</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/List.html#List.append|const"><span>@</span></a></span><span class="free"><span>idx</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>⟹</span></span><span>
  </span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#PhiSem_Mem_C_Base.index_offset|const"><span>index_offset</span></a><span> </span><span class="free"><span>T</span></span><span> </span><span class="free"><span>base</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span> </span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#PhiSem_Mem_C_Base.index_offset|const"><span>index_offset</span></a><span> </span><span class="free"><span>T</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>base</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/List.html#List.append|const"><span>@</span></a></span><span class="free"><span>idx</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#PhiSem_Mem_C_Base.index_offset|const"><span>index_offset</span></a><span> </span><span class="free"><span>T</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>base</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/List.html#List.append|const"><span>@</span></a></span><span class="free"><span>idx</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span> </span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#PhiSem_Mem_C_Base.index_offset|const"><span>index_offset</span></a><span> </span><span class="free"><span>T</span></span><span> </span><span class="free"><span>base</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span> </span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#PhiSem_Mem_C_Base.MemObj_Size|const"><span>MemObj_Size</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Phi_Semantics/PhiSem_Aggregate_Base.html#PhiSem_Aggregate_Base.index_type|const"><span>index_type</span></a><span> </span><span class="free"><span>base</span></span><span> </span><span class="free"><span>T</span></span><span class="main"><span>)</span></span><span>›</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Tools/induct.ML.html#HOL.induct|method"><span class="operator"><span>induct</span></span></a><span> </span><span class="quoted"><span class="free"><span>idx</span></span></span><span> </span><span class="quasi_keyword"><span>arbitrary</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><span class="quoted"><span class="free"><span>base</span></span></span><span> </span><span class="quasi_keyword"><span>rule</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/List.html#List.rev_induct|fact"><span>rev_induct</span></a><span class="main"><span class="keyword3"><span>;</span></span></span><span>
         </span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>del</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/List.html#List.append_assoc|fact"><span>append_assoc</span></a><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/List.html#List.append_assoc|fact"><span>append_assoc</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>symmetric</span></span><span class="main"><span class="main"><span>]</span></span></span><span> </span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#PhiSem_Mem_C_Base.fold_tail|fact"><span>fold_tail</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#PhiSem_Mem_C_Base.idx_step_offset_size|fact"><span>idx_step_offset_size</span></a><span> </span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#PhiSem_Mem_C_Base.index_offset_upper_bound|fact"><span>index_offset_upper_bound</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.fastforce|method"><span class="operator"><span>fastforce</span></span></a><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="PhiSem_Mem_C_Base.phantom_mem_semantic_type_def|fact"><span class="entity_def" id="PhiSem_Mem_C_Base.phantom_mem_semantic_type_def|thm"><span class="entity_def" id="PhiSem_Mem_C_Base.phantom_mem_semantic_type_def_raw|axiom"><span>definition</span></span></span></span></span></span><span> </span><span class="entity"><span class="entity_def" id="PhiSem_Mem_C_Base.phantom_mem_semantic_type|const"><span>phantom_mem_semantic_type</span></span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>‹</span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Semantics_Framework.html#Phi_Semantics_Framework.TY|type"><span>TY</span></a><span> </span><span class="main"><span>⇒</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.bool|type"><span>bool</span></a><span>›</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>‹</span><span class="free"><span>phantom_mem_semantic_type</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>TY</span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.iff|const"><span>⟷</span></a></span><span> </span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#PhiSem_Mem_C_Base.MemObj_Size|const"><span>MemObj_Size</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>TY</span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span>›</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="PhiSem_Mem_C_Base.phantom_mem_semantic_type_single_value|fact"><span class="entity_def" id="PhiSem_Mem_C_Base.phantom_mem_semantic_type_single_value|thm"><span>phantom_mem_semantic_type_single_value</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="quoted"><span class="quoted"><span>‹ </span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#PhiSem_Mem_C_Base.phantom_mem_semantic_type|const"><span>phantom_mem_semantic_type</span></a><span> </span><span class="free"><span>TY</span></span><span>
</span><span class="main"><span>⟹</span></span><span> </span><span class="free"><span>u</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span> </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Semantics_Framework.html#Phi_Semantics_Framework.Well_Type|const"><span>Well_Type</span></a><span> </span><span class="free"><span>TY</span></span><span>
</span><span class="main"><span>⟹</span></span><span> </span><span class="free"><span>v</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span> </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Semantics_Framework.html#Phi_Semantics_Framework.Well_Type|const"><span>Well_Type</span></a><span> </span><span class="free"><span>TY</span></span><span>
</span><span class="main"><span>⟹</span></span><span> </span><span class="free"><span>u</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="free"><span>v</span></span><span> ›</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#PhiSem_Mem_C_Base.phantom_mem_semantic_type_def|fact"><span>phantom_mem_semantic_type_def</span></a><span>
  </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#PhiSem_Mem_C_Base.phantom_mem_value_uniq|fact"><span>phantom_mem_value_uniq</span></a><span class="main"><span>[</span></span><span class="operator"><span>unfolded</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.is_singleton_def|fact"><span>is_singleton_def</span></a><span class="main"><span>]</span></span><span>
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/HOL/Tools/Metis/metis_tactic.ML.html#Metis.metis|method"><span class="operator"><span>metis</span></span></a><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="PhiSem_Mem_C_Base.index_offset_bound_strict|fact"><span class="entity_def" id="PhiSem_Mem_C_Base.index_offset_bound_strict|thm"><span>index_offset_bound_strict</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="quoted"><span class="quoted"><span>‹</span><a class="entity_ref" href="../Phi_Semantics/PhiSem_Aggregate_Base.html#PhiSem_Aggregate_Base.valid_index|const"><span>valid_index</span></a><span> </span><span class="free"><span>T</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>base</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/List.html#List.append|const"><span>@</span></a></span><span class="free"><span>idx</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Not|const"><span>¬</span></a></span><span> </span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#PhiSem_Mem_C_Base.phantom_mem_semantic_type|const"><span>phantom_mem_semantic_type</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Phi_Semantics/PhiSem_Aggregate_Base.html#PhiSem_Aggregate_Base.index_type|const"><span>index_type</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span>base</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/List.html#List.append|const"><span>@</span></a></span><span class="free"><span>idx</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>T</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>⟹</span></span><span>
  </span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#PhiSem_Mem_C_Base.index_offset|const"><span>index_offset</span></a><span> </span><span class="free"><span>T</span></span><span> </span><span class="free"><span>base</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>≤</span></a></span><span> </span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#PhiSem_Mem_C_Base.index_offset|const"><span>index_offset</span></a><span> </span><span class="free"><span>T</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>base</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/List.html#List.append|const"><span>@</span></a></span><span class="free"><span>idx</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#PhiSem_Mem_C_Base.index_offset|const"><span>index_offset</span></a><span> </span><span class="free"><span>T</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>base</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/List.html#List.append|const"><span>@</span></a></span><span class="free"><span>idx</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span> </span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#PhiSem_Mem_C_Base.index_offset|const"><span>index_offset</span></a><span> </span><span class="free"><span>T</span></span><span> </span><span class="free"><span>base</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span> </span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#PhiSem_Mem_C_Base.MemObj_Size|const"><span>MemObj_Size</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Phi_Semantics/PhiSem_Aggregate_Base.html#PhiSem_Aggregate_Base.index_type|const"><span>index_type</span></a><span> </span><span class="free"><span>base</span></span><span> </span><span class="free"><span>T</span></span><span class="main"><span>)</span></span><span>›</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#PhiSem_Mem_C_Base.phantom_mem_semantic_type_def|fact"><span>phantom_mem_semantic_type_def</span></a><span>
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Tools/induct.ML.html#HOL.induct|method"><span class="operator"><span>induct</span></span></a><span> </span><span class="quoted"><span class="free"><span>idx</span></span></span><span> </span><span class="quasi_keyword"><span>arbitrary</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><span class="quoted"><span class="free"><span>base</span></span></span><span> </span><span class="quasi_keyword"><span>rule</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/List.html#List.rev_induct|fact"><span>rev_induct</span></a><span class="main"><span class="keyword3"><span>;</span></span></span><span>
      </span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>del</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/List.html#List.append_assoc|fact"><span>append_assoc</span></a><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/List.html#List.append_assoc|fact"><span>append_assoc</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>symmetric</span></span><span class="main"><span class="main"><span>]</span></span></span><span> </span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#PhiSem_Mem_C_Base.fold_tail|fact"><span>fold_tail</span></a><span class="main"><span class="keyword3"><span>;</span></span></span><span>
      </span><span class="operator"><span>insert</span></span><span> </span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#PhiSem_Mem_C_Base.idx_step_offset_size|fact"><span>idx_step_offset_size</span></a><span> </span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#PhiSem_Mem_C_Base.index_offset_upper_bound|fact"><span>index_offset_upper_bound</span></a><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.fastforce|method"><span class="operator"><span>fastforce</span></span></a><span class="main"><span>)</span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="PhiSem_Mem_C_Base.phantom_mem_semantic_type_element|fact"><span class="entity_def" id="PhiSem_Mem_C_Base.phantom_mem_semantic_type_element|thm"><span>phantom_mem_semantic_type_element</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="quoted"><span class="quoted"><span>‹ </span><a class="entity_ref" href="../Phi_Semantics/PhiSem_Aggregate_Base.html#PhiSem_Aggregate_Base.valid_idx_step|const"><span>valid_idx_step</span></a><span> </span><span class="free"><span>TY</span></span><span> </span><span class="free"><span>i</span></span><span>
</span><span class="main"><span>⟹</span></span><span> </span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#PhiSem_Mem_C_Base.phantom_mem_semantic_type|const"><span>phantom_mem_semantic_type</span></a><span> </span><span class="free"><span>TY</span></span><span>
</span><span class="main"><span>⟹</span></span><span> </span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#PhiSem_Mem_C_Base.phantom_mem_semantic_type|const"><span>phantom_mem_semantic_type</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Phi_Semantics/PhiSem_Aggregate_Base.html#PhiSem_Aggregate_Base.idx_step_type|const"><span>idx_step_type</span></a><span> </span><span class="free"><span>i</span></span><span> </span><span class="free"><span>TY</span></span><span class="main"><span>)</span></span><span>›</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#PhiSem_Mem_C_Base.phantom_mem_semantic_type_def|fact"><span>phantom_mem_semantic_type_def</span></a><span>
  </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#PhiSem_Mem_C_Base.memobj_size_step|fact"><span>memobj_size_step</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.fastforce|method"><span class="operator"><span>fastforce</span></span></a><span>



</span><span class="keyword1"><span class="command"><span>section</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹Fiction›</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>text</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹They are not semantics, but parameters of the inference system.

</span><span class="antiquoted"><span class="raw_text"><span class="operator"><span>‹</span></span><span>Map_of_Val›</span></span></span><span> can be defined from </span><span class="antiquoted"><span class="raw_text"><span class="operator"><span>‹</span></span><span>valid_idx_step, idx_step_type›</span></span></span><span> and </span><span class="antiquoted"><span class="raw_text"><span class="operator"><span>‹</span></span><span>idx_step_value›</span></span></span><span>, e.g.,

</span><span class="antiquoted"><span class="raw_text"><span class="operator"><span>‹</span></span><span>primrec Map_of_Val :: ‹TY ⇒ VAL ⇒ aggregate_path ⇀ VAL›
  where ‹Map_of_Val _  v [] = Some v›
      | ‹Map_of_Val TY v (i#idx) = (if valid_idx_step TY i
                                    then Map_of_Val (idx_step_type i TY) (idx_step_value i v) idx
                                    else None)›
›</span></span></span><span>

but we do not fix the definition because, </span><span class="antiquoted"><span class="raw_text"><span class="operator"><span>‹</span></span><span>idx_step_value›</span></span></span><span> and </span><span class="antiquoted"><span class="raw_text"><span class="operator"><span>‹</span></span><span>idx_step_type›</span></span></span><span> only determines the
children of a node but not the value of the node. Whether the node is valued, affects whether and
how could the tree be separated. The naive definition above actually disables any separation because
the value bound to the node contains the entire data, so actually meaningless for the purpose of
being a tree enabling separation of aggregate structures.
›</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>debt_axiomatization</span></span></span><span> </span><span class="free"><span class="entity_def" id="PhiSem_Mem_C_Base.Map_of_Val|const"><span>Map_of_Val</span></span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>‹</span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Semantics_Framework.html#Phi_Semantics_Framework.VAL|type"><span>VAL</span></a><span> </span><span class="main"><span>⇒</span></span><span> </span><a class="entity_ref" href="../Phi_System/Phi_Element_Path.html#Phi_Element_Path.aggregate_path|type"><span>aggregate_path</span></a><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Map.html#Map.map|type"><span>⇀</span></a></span><span> </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Semantics_Framework.html#Phi_Semantics_Framework.VAL|type"><span>VAL</span></a><span>›</span></span></span><span>
                </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="free"><span class="entity_def" id="PhiSem_Mem_C_Base.Dom_of_TY|const"><span>Dom_of_TY</span></span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>‹</span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Semantics_Framework.html#Phi_Semantics_Framework.TY|type"><span>TY</span></a><span> </span><span class="main"><span>⇒</span></span><span> </span><a class="entity_ref" href="../Phi_System/Phi_Element_Path.html#Phi_Element_Path.aggregate_path|type"><span>aggregate_path</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.set|type"><span>set</span></a><span>›</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="entity_def" id="PhiSem_Mem_C_Base.Map_of_Val_inj|fact"><span class="entity_def" id="PhiSem_Mem_C_Base.Map_of_Val_inj|thm"><span>Map_of_Val_inj</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>‹</span><span class="free"><span>Va</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span> </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Semantics_Framework.html#Phi_Semantics_Framework.Well_Type|const"><span>Well_Type</span></a><span> </span><span class="free"><span>T</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="free"><span>Vb</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span> </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Semantics_Framework.html#Phi_Semantics_Framework.Well_Type|const"><span>Well_Type</span></a><span> </span><span class="free"><span>T</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="free"><span>Map_of_Val</span></span><span> </span><span class="free"><span>Va</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="free"><span>Map_of_Val</span></span><span> </span><span class="free"><span>Vb</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="free"><span>Va</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="free"><span>Vb</span></span><span>›</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span>   </span><span class="entity_def" id="PhiSem_Mem_C_Base.Map_of_Val_dom|fact"><span class="entity_def" id="PhiSem_Mem_C_Base.Map_of_Val_dom|thm"><span>Map_of_Val_dom</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>‹</span><span class="free"><span>Va</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span> </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Semantics_Framework.html#Phi_Semantics_Framework.Well_Type|const"><span>Well_Type</span></a><span> </span><span class="free"><span>T</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Map.html#Map.dom|const"><span>dom</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span>Map_of_Val</span></span><span> </span><span class="free"><span>Va</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="free"><span>Dom_of_TY</span></span><span> </span><span class="free"><span>T</span></span><span>›</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span>   </span><span class="entity_def" id="PhiSem_Mem_C_Base.Dom_of_TY_step|fact"><span class="entity_def" id="PhiSem_Mem_C_Base.Dom_of_TY_step|thm"><span>Dom_of_TY_step</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>‹</span><a class="entity_ref" href="../Phi_Semantics/PhiSem_Aggregate_Base.html#PhiSem_Aggregate_Base.valid_idx_step|const"><span>valid_idx_step</span></a><span> </span><span class="free"><span>T</span></span><span> </span><span class="free"><span>i</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="free"><span>Dom_of_TY</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Phi_Semantics/PhiSem_Aggregate_Base.html#PhiSem_Aggregate_Base.idx_step_type|const"><span>idx_step_type</span></a><span> </span><span class="free"><span>i</span></span><span> </span><span class="free"><span>T</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.subset_eq|const"><span>⊆</span></a></span><span> </span><span class="free"><span>Dom_of_TY</span></span><span> </span><span class="free"><span>T</span></span><span>›</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span>   </span><span class="entity_def" id="PhiSem_Mem_C_Base.Mapof_not_1|fact"><span class="entity_def" id="PhiSem_Mem_C_Base.Mapof_not_1|thm"><span>Mapof_not_1</span></span></span><span class="main"><span>[</span></span><span class="operator"><span>simp</span></span><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>‹</span><span class="free"><span>V</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span> </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Semantics_Framework.html#Phi_Semantics_Framework.Well_Type|const"><span>Well_Type</span></a><span> </span><span class="free"><span>TY</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="free"><span>Map_of_Val</span></span><span> </span><span class="free"><span>V</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.not_equal|const"><span>≠</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span>›</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span>   </span><span class="entity_def" id="PhiSem_Mem_C_Base.Map_of_Val_pull_step|fact"><span class="entity_def" id="PhiSem_Mem_C_Base.Map_of_Val_pull_step|thm"><span>Map_of_Val_pull_step</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>‹</span><a class="entity_ref" href="../Phi_Semantics/PhiSem_Aggregate_Base.html#PhiSem_Aggregate_Base.valid_idx_step|const"><span>valid_idx_step</span></a><span> </span><span class="free"><span>T</span></span><span> </span><span class="free"><span>i</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="free"><span>V</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span> </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Semantics_Framework.html#Phi_Semantics_Framework.Well_Type|const"><span>Well_Type</span></a><span> </span><span class="free"><span>T</span></span><span>
                          </span><span class="main"><span>⟹</span></span><span> </span><a class="entity_ref" href="../Phi_System/Phi_Algebras.Map_of_Tree.html#Map_of_Tree.pull_map|const"><span>pull_map</span></a><span> </span><span class="main"><span>[</span></span><span class="free"><span>i</span></span><span class="main"><span>]</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>Map_of_Val</span></span><span> </span><span class="free"><span>V</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="free"><span>Map_of_Val</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Phi_Semantics/PhiSem_Aggregate_Base.html#PhiSem_Aggregate_Base.idx_step_value|const"><span>idx_step_value</span></a><span> </span><span class="free"><span>i</span></span><span> </span><span class="free"><span>V</span></span><span class="main"><span>)</span></span><span>›</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span>   </span><span class="entity_def" id="PhiSem_Mem_C_Base.Map_of_Val_mod_step|fact"><span class="entity_def" id="PhiSem_Mem_C_Base.Map_of_Val_mod_step|thm"><span>Map_of_Val_mod_step</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>‹</span><a class="entity_ref" href="../Phi_Semantics/PhiSem_Aggregate_Base.html#PhiSem_Aggregate_Base.valid_idx_step|const"><span>valid_idx_step</span></a><span> </span><span class="free"><span>T</span></span><span> </span><span class="free"><span>i</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="free"><span>v</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span> </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Semantics_Framework.html#Phi_Semantics_Framework.Well_Type|const"><span>Well_Type</span></a><span> </span><span class="free"><span>T</span></span><span>
                         </span><span class="main"><span>⟹</span></span><span> </span><span class="free"><span>Map_of_Val</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Phi_Semantics/PhiSem_Aggregate_Base.html#PhiSem_Aggregate_Base.idx_step_mod_value|const"><span>idx_step_mod_value</span></a><span> </span><span class="free"><span>i</span></span><span> </span><span class="free"><span>f</span></span><span> </span><span class="free"><span>v</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="free"><span>Map_of_Val</span></span><span> </span><span class="free"><span>v</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Map.html#Map.map_add|const"><span>++</span></a></span><span> </span><a class="entity_ref" href="../Phi_System/Phi_Algebras.Map_of_Tree.html#Map_of_Tree.push_map|const"><span>push_map</span></a><span> </span><span class="main"><span>[</span></span><span class="free"><span>i</span></span><span class="main"><span>]</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>Map_of_Val</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>f</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Phi_Semantics/PhiSem_Aggregate_Base.html#PhiSem_Aggregate_Base.idx_step_value|const"><span>idx_step_value</span></a><span> </span><span class="free"><span>i</span></span><span> </span><span class="free"><span>v</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>›</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="PhiSem_Mem_C_Base.Map_of_Val_pull|fact"><span class="entity_def" id="PhiSem_Mem_C_Base.Map_of_Val_pull|thm"><span>Map_of_Val_pull</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="quoted"><span class="quoted"><span>‹</span><a class="entity_ref" href="../Phi_Semantics/PhiSem_Aggregate_Base.html#PhiSem_Aggregate_Base.valid_index|const"><span>valid_index</span></a><span> </span><span class="free"><span>T</span></span><span> </span><span class="free"><span>idx</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="free"><span>V</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span> </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Semantics_Framework.html#Phi_Semantics_Framework.Well_Type|const"><span>Well_Type</span></a><span> </span><span class="free"><span>T</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><a class="entity_ref" href="../Phi_System/Phi_Algebras.Map_of_Tree.html#Map_of_Tree.pull_map|const"><span>pull_map</span></a><span> </span><span class="free"><span>idx</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#PhiSem_Mem_C_Base.Map_of_Val|const"><span>Map_of_Val</span></a><span> </span><span class="free"><span>V</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#PhiSem_Mem_C_Base.Map_of_Val|const"><span>Map_of_Val</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Phi_Semantics/PhiSem_Aggregate_Base.html#PhiSem_Aggregate_Base.index_value|const"><span>index_value</span></a><span> </span><span class="free"><span>idx</span></span><span> </span><span class="free"><span>V</span></span><span class="main"><span>)</span></span><span>›</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Tools/induct.ML.html#HOL.induct|method"><span class="operator"><span>induct</span></span></a><span> </span><span class="quoted"><span class="free"><span>idx</span></span></span><span> </span><span class="quasi_keyword"><span>arbitrary</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><span class="quoted"><span class="free"><span>V</span></span></span><span> </span><span class="quoted"><span class="free"><span>T</span></span></span><span class="main"><span class="keyword3"><span>;</span></span></span><span> </span><span class="operator"><span>simp</span></span><span class="main"><span class="keyword3"><span>;</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/HOL/Tools/Metis/metis_tactic.ML.html#Metis.metis|method"><span class="operator"><span>metis</span></span></a><span> </span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#PhiSem_Mem_C_Base.Map_of_Val_pull_step|fact"><span>Map_of_Val_pull_step</span></a><span> </span><a class="entity_ref" href="../Phi_Semantics/PhiSem_Aggregate_Base.html#PhiSem_Aggregate_Base.idx_step_value_welltyp|fact"><span>idx_step_value_welltyp</span></a><span> </span><a class="entity_ref" href="../Phi_System/Phi_Algebras.Map_of_Tree.html#Map_of_Tree.pull_map_cons|fact"><span>pull_map_cons</span></a><span class="main"><span>)</span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="PhiSem_Mem_C_Base.Dom_of_TY|fact"><span class="entity_def" id="PhiSem_Mem_C_Base.Dom_of_TY|thm"><span>Dom_of_TY</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="quoted"><span class="quoted"><span>‹</span><a class="entity_ref" href="../Phi_Semantics/PhiSem_Aggregate_Base.html#PhiSem_Aggregate_Base.valid_index|const"><span>valid_index</span></a><span> </span><span class="free"><span>T</span></span><span> </span><span class="free"><span>idx</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#PhiSem_Mem_C_Base.Dom_of_TY|const"><span>Dom_of_TY</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Phi_Semantics/PhiSem_Aggregate_Base.html#PhiSem_Aggregate_Base.index_type|const"><span>index_type</span></a><span> </span><span class="free"><span>idx</span></span><span> </span><span class="free"><span>T</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.subset_eq|const"><span>⊆</span></a></span><span> </span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#PhiSem_Mem_C_Base.Dom_of_TY|const"><span>Dom_of_TY</span></a><span> </span><span class="free"><span>T</span></span><span>›</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Tools/induct.ML.html#HOL.induct|method"><span class="operator"><span>induct</span></span></a><span> </span><span class="quoted"><span class="free"><span>idx</span></span></span><span> </span><span class="quasi_keyword"><span>arbitrary</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><span class="quoted"><span class="free"><span>T</span></span></span><span class="main"><span class="keyword3"><span>;</span></span></span><span> </span><span class="operator"><span>simp</span></span><span class="main"><span class="keyword3"><span>;</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/HOL/Tools/Meson/meson_tactic.ML.html#Meson.meson|method"><span class="operator"><span>meson</span></span></a><span> </span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#PhiSem_Mem_C_Base.Dom_of_TY_step|fact"><span>Dom_of_TY_step</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.preorder_class.dual_order.trans|fact"><span>dual_order.trans</span></a><span class="main"><span>)</span></span><span>

</span><span class="comment1"><span>(* deprecated
lemma total_Mapof_disjoint:
   ‹g ## (push_map idx (to_share ∘ h))
⟹ to_share ∘ f = g * (push_map idx (to_share ∘ h))
⟹ dom g ∩ dom (push_map idx (to_share ∘ h)) = {}›
  using to_share_total_disjoint push_map_to_share by metis *)</span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="PhiSem_Mem_C_Base.map_add_subsumed_dom|fact"><span class="entity_def" id="PhiSem_Mem_C_Base.map_add_subsumed_dom|thm"><span>map_add_subsumed_dom</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="quoted"><span class="quoted"><span>‹</span><a class="entity_ref" href="../../HOL/HOL/Map.html#Map.dom|const"><span>dom</span></a><span> </span><span class="free"><span>f</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.subset_eq|const"><span>⊆</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Map.html#Map.dom|const"><span>dom</span></a><span> </span><span class="free"><span>g</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="free"><span>f</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Map.html#Map.map_add|const"><span>++</span></a></span><span> </span><span class="free"><span>g</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="free"><span>g</span></span><span>›</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Map.html#Map.map_add_def|fact"><span>map_add_def</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Map.html#Map.dom_def|fact"><span>dom_def</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.subset_eq|fact"><span>subset_eq</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.fun_eq_iff|fact"><span>fun_eq_iff</span></a><span> </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="operator"><span>simp</span></span><span>
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/HOL/Tools/Metis/metis_tactic.ML.html#Metis.metis|method"><span class="operator"><span>metis</span></span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Option.html#Option.option.case_eq_if|fact"><span>option.case_eq_if</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Option.html#Option.option.collapse|fact"><span>option.collapse</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Option.html#Option.option.simps|fact"><span>option.simps</span></a><span class="main"><span class="main"><span>(</span></span></span><span>3</span><span class="main"><span class="main"><span>)</span></span></span><span class="main"><span>)</span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="PhiSem_Mem_C_Base.Map_of_Val_mod|fact"><span class="entity_def" id="PhiSem_Mem_C_Base.Map_of_Val_mod|thm"><span>Map_of_Val_mod</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="quoted"><span class="quoted"><span>‹ </span><a class="entity_ref" href="../Phi_Semantics/PhiSem_Aggregate_Base.html#PhiSem_Aggregate_Base.valid_index|const"><span>valid_index</span></a><span> </span><span class="free"><span>T</span></span><span> </span><span class="free"><span>idx</span></span><span>
</span><span class="main"><span>⟹</span></span><span> </span><span class="free"><span>v</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span> </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Semantics_Framework.html#Phi_Semantics_Framework.Well_Type|const"><span>Well_Type</span></a><span> </span><span class="free"><span>T</span></span><span>
</span><span class="main"><span>⟹</span></span><span> </span><span class="free"><span>u</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span> </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Semantics_Framework.html#Phi_Semantics_Framework.Well_Type|const"><span>Well_Type</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Phi_Semantics/PhiSem_Aggregate_Base.html#PhiSem_Aggregate_Base.index_type|const"><span>index_type</span></a><span> </span><span class="free"><span>idx</span></span><span> </span><span class="free"><span>T</span></span><span class="main"><span>)</span></span><span>
</span><span class="main"><span>⟹</span></span><span> </span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#PhiSem_Mem_C_Base.Map_of_Val|const"><span>Map_of_Val</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Phi_Semantics/PhiSem_Aggregate_Base.html#PhiSem_Aggregate_Base.index_mod_value|const"><span>index_mod_value</span></a><span> </span><span class="free"><span>idx</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="main"><span class="bound"><span>_</span></span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>u</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>v</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#PhiSem_Mem_C_Base.Map_of_Val|const"><span>Map_of_Val</span></a><span> </span><span class="free"><span>v</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Map.html#Map.map_add|const"><span>++</span></a></span><span> </span><a class="entity_ref" href="../Phi_System/Phi_Algebras.Map_of_Tree.html#Map_of_Tree.push_map|const"><span>push_map</span></a><span> </span><span class="free"><span>idx</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#PhiSem_Mem_C_Base.Map_of_Val|const"><span>Map_of_Val</span></a><span> </span><span class="free"><span>u</span></span><span class="main"><span>)</span></span><span>›</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Tools/induct.ML.html#HOL.induct|method"><span class="operator"><span>induct</span></span></a><span> </span><span class="quoted"><span class="free"><span>idx</span></span></span><span> </span><span class="quasi_keyword"><span>arbitrary</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><span class="quoted"><span class="free"><span>u</span></span></span><span> </span><span class="quoted"><span class="free"><span>v</span></span></span><span> </span><span class="quoted"><span class="free"><span>T</span></span></span><span class="main"><span class="keyword3"><span>;</span></span></span><span> </span><span class="operator"><span>simp</span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#PhiSem_Mem_C_Base.Map_of_Val_dom|fact"><span>Map_of_Val_dom</span></a><span> </span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#PhiSem_Mem_C_Base.map_add_subsumed_dom|fact"><span>map_add_subsumed_dom</span></a><span> </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/HOL/Tools/Metis/metis_tactic.ML.html#Metis.metis|method"><span class="operator"><span>metis</span></span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.preorder_class.order_refl|fact"><span>order_refl</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/classical.ML.html#HOL.clarify|method"><span class="operator"><span>clarify</span></span></a><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../Phi_Semantics/PhiSem_Aggregate_Base.html#PhiSem_Aggregate_Base.idx_step_value_welltyp|fact"><span>idx_step_value_welltyp</span></a><span> </span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#PhiSem_Mem_C_Base.Map_of_Val_mod_step|fact"><span>Map_of_Val_mod_step</span></a><span>  </span><a class="entity_ref" href="../Phi_System/Phi_Algebras.Map_of_Tree.html#Map_of_Tree.push_map_distrib_map_add|fact"><span>push_map_distrib_map_add</span></a><span>
                        </span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#PhiSem_Mem_C_Base.Map_of_Val_pull_step|fact"><span>Map_of_Val_pull_step</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>symmetric</span></span><span class="main"><span class="main"><span>]</span></span></span><span> </span><a class="entity_ref" href="../Phi_System/Phi_Algebras.Map_of_Tree.html#Map_of_Tree.push_pull_map|fact"><span>push_pull_map</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Map.html#Map.map_add_subsumed2|fact"><span>map_add_subsumed2</span></a><span>
                        </span><a class="entity_ref" href="../Phi_System/Phi_Algebras.Map_of_Tree.html#Map_of_Tree.push_map_push_map|fact"><span>push_map_push_map</span></a><span class="main"><span>)</span></span><span>

</span><span class="comment1"><span>(* lemma Map_of_Val_modify_fiction:
   ‹valid_index T idx
⟹ v ∈ Well_Type T
⟹ u ∈ Well_Type (index_type idx T)
⟹ u'∈ Well_Type (index_type idx T)
⟹ g ## (push_map idx (to_share ∘ Map_of_Val u))
⟹ to_share ∘ (Map_of_Val v) = g * (push_map idx (to_share ∘ Map_of_Val u))
⟹ to_share ∘ (Map_of_Val (index_mod_value idx (λ_. u') v)) = g * (push_map idx (to_share ∘ Map_of_Val u'))›
  apply (simp add: Map_of_Val_mod to_share_funcomp_map_add push_map_to_share
      times_fun_map_add_right total_Mapof_disjoint[simplified push_map_to_share]
      Map_of_Val_same_dom push_map_dom_eq)
  subgoal premises prems proof -
    have ‹dom g ∩ dom (to_share ∘ push_map idx (Map_of_Val u)) = {}›
      using prems to_share_total_disjoint by blast
    moreover have t1:
      ‹dom (to_share ∘ push_map idx (Map_of_Val u)) = dom (to_share ∘ push_map idx (Map_of_Val u'))›
      using prems by (metis Map_of_Val_same_dom dom_map_option_comp push_map_dom_eq)
    ultimately have ‹dom g ∩ dom (to_share ∘ push_map idx (Map_of_Val u')) = {}› by metis
    note [simp] = times_fun_map_add_right[OF this]
    show ?thesis by simp (metis t1 map_add_subsumed_dom order_eq_refl)
  qed
  done
(* lemma pull_map_share_Mapof_not_eq_1[simp]:
  ‹valid_index (Typeof v) idx ⟹ pull_map idx (share n (to_share ∘ Map_of_Val v)) = 1 ⟷ n = 0›
  by (cases ‹n = 0›; simp add: pull_map_share pull_map_to_share Map_of_Val_pull)
*)*)</span></span><span>

</span><span class="comment1"><span>(* deprecated
lemma map_add_restrict_itself [simp]: ‹(f ++ g) |` dom g = g›
  unfolding fun_eq_iff restrict_map_def map_add_def
  by (simp add: domIff option.case_eq_if)

lemma Map_of_Val_inj_plus:
  ‹Va ∈ Well_Type T ⟹ Vb ∈ Well_Type T ⟹ f ++ Map_of_Val Va = f ++ Map_of_Val Vb ⟹ Va = Vb›
proof (rule Map_of_Val_inj, assumption)
  assume tyA: ‹Va ∈ Well_Type T›
     and tyB: ‹Vb ∈ Well_Type T›
     and feq: ‹f ++ Map_of_Val Va = f ++ Map_of_Val Vb›
  then have ‹(f ++ Map_of_Val Va) |` dom (Map_of_Val Va) = (f ++ Map_of_Val Vb) |` dom (Map_of_Val Vb)›
    using Map_of_Val_dom by metis 
  note this [simplified]
  then show ‹Map_of_Val Va = Map_of_Val Vb› .
qed

definition ‹Val_of_Map TY M = (@V. (∃f. f ++ Map_of_Val V = M) ∧ V ∈ Well_Type TY)›

lemma Val_of_Map_append[simp]:
  ‹v ∈ Well_Type T ⟹ Val_of_Map T (f ++ Map_of_Val v) = v›
  unfolding Val_of_Map_def
  using someI[where P=‹λV. (∃fa. fa ++ Map_of_Val V = f ++ Map_of_Val v) ∧ V ∈ Well_Type T› and x=v, simplified]
        Map_of_Val_inj_plus
  by (metis (no_types, lifting) Map_of_Val_dom map_add_restrict_itself) 

lemmas Val_of_Map[simp] = Val_of_Map_append[where f = ‹Map.empty›, simplified] *)</span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="PhiSem_Mem_C_Base.Map_of_Val_ins_def|fact"><span class="entity_def" id="PhiSem_Mem_C_Base.Map_of_Val_ins_def|thm"><span class="entity_def" id="PhiSem_Mem_C_Base.Map_of_Val_ins_def_raw|axiom"><span>definition</span></span></span></span></span></span><span> </span><span class="entity"><span class="entity_def" id="PhiSem_Mem_C_Base.Map_of_Val_ins|const"><span>Map_of_Val_ins</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>‹</span><span class="free"><span>Map_of_Val_ins</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/Fun.html#Fun.comp|const"><span>(o)</span></a></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/Option.html#Option.option.map_option|const"><span>map_option</span></a><span> </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Algebras.Algebras.html#Algebras.discrete.discrete|const"><span>discrete</span></a><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>
                            </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/Fun.html#Fun.comp|const"><span>o</span></a></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="bound"><span>V</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span>case</span></span><span> </span><span class="bound"><span>V</span></span><span> </span><span class="keyword1"><span>of</span></span><span> Some </span><span class="bound"><span>V'</span></span><span> </span><span class="main"><span>⇒</span></span><span> </span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#PhiSem_Mem_C_Base.Map_of_Val|const"><span>Map_of_Val</span></a><span> </span><span class="bound"><span>V'</span></span><span> </span><span class="main"><span>|</span></span><span> None </span><span class="main"><span>⇒</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>
                            </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/Fun.html#Fun.comp|const"><span>o</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Option.html#Option.option.map_option|const"><span>map_option</span></a><span> </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Algebras.Algebras.html#Algebras.discrete.dest|const"><span>discrete.dest</span></a><span>›</span></span></span><span>
</span><span class="keyword1"><span class="command"><span class="entity_def" id="PhiSem_Mem_C_Base.Map_of_Val_ins_dom_def|fact"><span class="entity_def" id="PhiSem_Mem_C_Base.Map_of_Val_ins_dom_def|thm"><span class="entity_def" id="PhiSem_Mem_C_Base.Map_of_Val_ins_dom_def_raw|axiom"><span>definition</span></span></span></span></span></span><span> </span><span class="entity"><span class="entity_def" id="PhiSem_Mem_C_Base.Map_of_Val_ins_dom|const"><span>Map_of_Val_ins_dom</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>‹</span><span class="free"><span>Map_of_Val_ins_dom</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>TY</span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="main"><span>{</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Option.html#Option.option.pred_option|const"><span>pred_option</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="bound"><span>x'</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Algebras.Algebras.html#Algebras.discrete.dest|const"><span>discrete.dest</span></a><span> </span><span class="bound"><span>x'</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span> </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Semantics_Framework.html#Phi_Semantics_Framework.Well_Type|const"><span>Well_Type</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>TY</span></span></span></span><span class="main"><span>)</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>}</span></span><span>›</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="PhiSem_Mem_C_Base.Map_of_Val_ins_eval|fact"><span class="entity_def" id="PhiSem_Mem_C_Base.Map_of_Val_ins_eval(2)|thm"><span class="entity_def" id="PhiSem_Mem_C_Base.Map_of_Val_ins_eval(1)|thm"><span>Map_of_Val_ins_eval</span></span></span></span><span class="main"><span>[</span></span><span class="operator"><span>simp</span></span><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span>
  </span><span class="quoted"><span class="quoted"><span>‹</span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#PhiSem_Mem_C_Base.Map_of_Val_ins|const"><span>Map_of_Val_ins</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/Option.html#Option.option.Some|const"><span>Some</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Algebras.Algebras.html#Algebras.discrete.discrete|const"><span>discrete</span></a><span> </span><span class="free"><span>u</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/Option.html#Option.option.map_option|const"><span>map_option</span></a><span> </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Algebras.Algebras.html#Algebras.discrete.discrete|const"><span>discrete</span></a><span class="main"><span>)</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/Fun.html#Fun.comp|const"><span>o</span></a></span><span> </span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#PhiSem_Mem_C_Base.Map_of_Val|const"><span>Map_of_Val</span></a><span> </span><span class="free"><span>u</span></span><span>›</span></span></span><span>
  </span><span class="quoted"><span class="quoted"><span>‹</span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#PhiSem_Mem_C_Base.Map_of_Val_ins|const"><span>Map_of_Val_ins</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Option.html#Option.option.None|const"><span>None</span></a><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span>›</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#PhiSem_Mem_C_Base.Map_of_Val_ins_def|fact"><span>Map_of_Val_ins_def</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span class="main"><span class="keyword3"><span>+</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="PhiSem_Mem_C_Base.Map_of_Val_ins_None|fact"><span class="entity_def" id="PhiSem_Mem_C_Base.Map_of_Val_ins_None|thm"><span>Map_of_Val_ins_None</span></span></span><span class="main"><span>[</span></span><span class="operator"><span>simp</span></span><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span>
  </span><span class="quoted"><span class="quoted"><span>‹ </span><span class="free"><span>x</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span> </span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#PhiSem_Mem_C_Base.Map_of_Val_ins_dom|const"><span>Map_of_Val_ins_dom</span></a><span> </span><span class="free"><span>TY</span></span><span>
</span><span class="main"><span>⟹</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#PhiSem_Mem_C_Base.Map_of_Val_ins|const"><span>Map_of_Val_ins</span></a><span> </span><span class="free"><span>x</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>x</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Option.html#Option.option.None|const"><span>None</span></a><span class="main"><span>)</span></span><span>›</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#PhiSem_Mem_C_Base.Map_of_Val_ins_def|fact"><span>Map_of_Val_ins_def</span></a><span> </span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#PhiSem_Mem_C_Base.Map_of_Val_ins_dom_def|fact"><span>Map_of_Val_ins_dom_def</span></a><span>
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Tools/induct.ML.html#HOL.cases|method"><span class="operator"><span>cases</span></span></a><span> </span><span class="quoted"><span class="free"><span>x</span></span></span><span class="main"><span class="keyword3"><span>;</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.clarsimp|method"><span class="operator"><span>clarsimp</span></span></a><span class="main"><span class="keyword3"><span>;</span></span></span><span>
      </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/HOL/Tools/SMT/smt_systems.ML.html#SMT.smt|method"><span class="operator"><span>smt</span></span></a><span> </span><span class="main"><span class="main"><span>(</span></span></span><span>verit</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#PhiSem_Mem_C_Base.Mapof_not_1|fact"><span>Mapof_not_1</span></a><span> </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Algebras.Algebras.html#Algebras.dom_1|fact"><span>dom_1</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Map.html#Map.dom_eq_empty_conv|fact"><span>dom_eq_empty_conv</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Map.html#Map.dom_map_option_comp|fact"><span>dom_map_option_comp</span></a><span class="main"><span>)</span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="PhiSem_Mem_C_Base.Map_of_Val_ins_dom_NONE|fact"><span class="entity_def" id="PhiSem_Mem_C_Base.Map_of_Val_ins_dom_NONE|thm"><span>Map_of_Val_ins_dom_NONE</span></span></span><span class="main"><span>[</span></span><span class="operator"><span>simp</span></span><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span>
  </span><span class="quoted"><span class="quoted"><span>‹ </span><a class="entity_ref" href="../../HOL/HOL/Option.html#Option.option.None|const"><span>None</span></a><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span> </span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#PhiSem_Mem_C_Base.Map_of_Val_ins_dom|const"><span>Map_of_Val_ins_dom</span></a><span> </span><span class="free"><span>TY</span></span><span> ›</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#PhiSem_Mem_C_Base.Map_of_Val_ins_dom_def|fact"><span>Map_of_Val_ins_dom_def</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="PhiSem_Mem_C_Base.Map_of_Val_ins_dom_eval|fact"><span class="entity_def" id="PhiSem_Mem_C_Base.Map_of_Val_ins_dom_eval|thm"><span>Map_of_Val_ins_dom_eval</span></span></span><span class="main"><span>[</span></span><span class="operator"><span>simp</span></span><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span>
  </span><span class="quoted"><span class="quoted"><span>‹</span><a class="entity_ref" href="../../HOL/HOL/Option.html#Option.option.Some|const"><span>Some</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Algebras.Algebras.html#Algebras.discrete.discrete|const"><span>discrete</span></a><span> </span><span class="free"><span>u</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span> </span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#PhiSem_Mem_C_Base.Map_of_Val_ins_dom|const"><span>Map_of_Val_ins_dom</span></a><span> </span><span class="free"><span>TY</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.iff|const"><span>⟷</span></a></span><span> </span><span class="free"><span>u</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span> </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Semantics_Framework.html#Phi_Semantics_Framework.Well_Type|const"><span>Well_Type</span></a><span> </span><span class="free"><span>TY</span></span><span>›</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#PhiSem_Mem_C_Base.Map_of_Val_ins_dom_def|fact"><span>Map_of_Val_ins_dom_def</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="PhiSem_Mem_C_Base.\&lt;F&gt;_functional_condition_Map_of_Val_ins_dom|fact"><span class="entity_def" id="PhiSem_Mem_C_Base.\&lt;F&gt;_functional_condition_Map_of_Val_ins_dom|thm"><span>ℱ_functional_condition_Map_of_Val_ins_dom</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="quoted"><span class="quoted"><span>‹</span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Algebras.Phi_Fiction.html#Phi_Fiction.\&lt;F&gt;_functional_condition|const"><span>ℱ_functional_condition</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#PhiSem_Mem_C_Base.Map_of_Val_ins_dom|const"><span>Map_of_Val_ins_dom</span></a><span> </span><span class="free"><span>TY</span></span><span class="main"><span>)</span></span><span>›</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Algebras.Phi_Fiction.html#Phi_Fiction.\&lt;F&gt;_functional_condition_def|fact"><span>ℱ_functional_condition_def</span></a><span> </span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#PhiSem_Mem_C_Base.Map_of_Val_ins_dom_def|fact"><span>Map_of_Val_ins_dom_def</span></a><span>
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.clarsimp|method"><span class="operator"><span>clarsimp</span></span></a><span class="main"><span class="keyword3"><span>;</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Tools/induct_tacs.ML.html#HOL.case_tac|method"><span class="operator"><span>case_tac</span></span></a><span> </span><span class="quoted"><span class="improper"><span>r</span></span></span><span class="main"><span class="keyword3"><span>;</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Tools/induct_tacs.ML.html#HOL.case_tac|method"><span class="operator"><span>case_tac</span></span></a><span> </span><span class="quoted"><span class="improper"><span class="quoted"><span class="improper"><span>x</span></span></span></span></span><span class="main"><span class="keyword3"><span>;</span></span></span><span> </span><span class="operator"><span>simp</span></span><span class="main"><span>)</span></span><span>

</span><span class="comment1"><span>(*
interpretation Map_of_Val_ins_UNIV: cancl_sep_orthogonal_monoid ‹Map_of_Val_ins› UNIV
  apply (standard; clarsimp simp add: Map_of_Val_ins_def split_discrete_meta_all
                                      Map_of_Val_ins_dom_def
                            split: option.split)
  apply (auto simp add: fun_eq_iff split_option_ex times_fun 
                                  sep_disj_fun_def split_discrete_meta_all
                        split: option.split)[1]
  using Mapof_not_1 apply fastforce *)</span></span><span>
  

</span><span class="keyword1"><span class="command"><span class="entity_def" id="PhiSem_Mem_C_Base.Map_of_Val_ins.\&lt;F&gt;_functional_refinement|fact"><span class="entity_def" id="PhiSem_Mem_C_Base.Map_of_Val_ins.\&lt;F&gt;_functional_refinement_complex|fact"><span class="entity_def" id="PhiSem_Mem_C_Base.Map_of_Val_ins.cancl_sep_orthogonal_monoid_axioms|fact"><span class="entity_def" id="PhiSem_Mem_C_Base.Map_of_Val_ins.\&lt;F&gt;_functional_projection|fact"><span class="entity_def" id="PhiSem_Mem_C_Base.Map_of_Val_ins.simple_homo_mul|fact"><span class="entity_def" id="PhiSem_Mem_C_Base.Map_of_Val_ins.sep_orthogonal_monoid_axioms|fact"><span class="entity_def" id="PhiSem_Mem_C_Base.Map_of_Val_ins.one_in_D|fact"><span class="entity_def" id="PhiSem_Mem_C_Base.Map_of_Val_ins.sep_orthogonal_1_axioms|fact"><span class="entity_def" id="PhiSem_Mem_C_Base.Map_of_Val_ins.homo_one|fact"><span class="entity_def" id="PhiSem_Mem_C_Base.Map_of_Val_ins.homo_one_axioms|fact"><span class="entity_def" id="PhiSem_Mem_C_Base.Map_of_Val_ins.sep_orthogonal&apos;|fact"><span class="entity_def" id="PhiSem_Mem_C_Base.Map_of_Val_ins.sep_orthogonal|fact"><span class="entity_def" id="PhiSem_Mem_C_Base.Map_of_Val_ins.sep_orthogonal_axioms|fact"><span class="entity_def" id="PhiSem_Mem_C_Base.Map_of_Val_ins.homo_join_sub|fact"><span class="entity_def" id="PhiSem_Mem_C_Base.Map_of_Val_ins.homo_join_sub_axioms|fact"><span class="entity_def" id="PhiSem_Mem_C_Base.Map_of_Val_ins.homo_sep_axioms|fact"><span class="entity_def" id="PhiSem_Mem_C_Base.Map_of_Val_ins.sep_disj_homo_semi|fact"><span class="entity_def" id="PhiSem_Mem_C_Base.Map_of_Val_ins.homo_sep_disj_axioms|fact"><span class="entity_def" id="PhiSem_Mem_C_Base.Map_of_Val_ins.homo_mult|fact"><span class="entity_def" id="PhiSem_Mem_C_Base.Map_of_Val_ins.homo_sep_mult_axioms|fact"><span class="entity_def" id="PhiSem_Mem_C_Base.Map_of_Val_ins.one_in_D|thm"><span class="entity_def" id="PhiSem_Mem_C_Base.Map_of_Val_ins.sep_orthogonal|thm"><span class="entity_def" id="PhiSem_Mem_C_Base.Map_of_Val_ins.homo_join_sub|thm"><span class="entity_def" id="PhiSem_Mem_C_Base.Map_of_Val_ins.homo_mult|thm"><span class="entity_def" id="PhiSem_Mem_C_Base.Map_of_Val_ins.\&lt;F&gt;_functional_refinement|thm"><span class="entity_def" id="PhiSem_Mem_C_Base.Map_of_Val_ins.\&lt;F&gt;_functional_refinement_complex|thm"><span class="entity_def" id="PhiSem_Mem_C_Base.Map_of_Val_ins.\&lt;F&gt;_functional_projection|thm"><span class="entity_def" id="PhiSem_Mem_C_Base.Map_of_Val_ins.cancl_sep_orthogonal_monoid_axioms|thm"><span class="entity_def" id="PhiSem_Mem_C_Base.Map_of_Val_ins.simple_homo_mul|thm"><span class="entity_def" id="PhiSem_Mem_C_Base.Map_of_Val_ins.sep_orthogonal_monoid_axioms|thm"><span class="entity_def" id="PhiSem_Mem_C_Base.Map_of_Val_ins.sep_orthogonal_1_axioms|thm"><span class="entity_def" id="PhiSem_Mem_C_Base.Map_of_Val_ins.homo_one|thm"><span class="entity_def" id="PhiSem_Mem_C_Base.Map_of_Val_ins.homo_one_axioms|thm"><span class="entity_def" id="PhiSem_Mem_C_Base.Map_of_Val_ins.sep_orthogonal&apos;|thm"><span class="entity_def" id="PhiSem_Mem_C_Base.Map_of_Val_ins.sep_orthogonal_axioms|thm"><span class="entity_def" id="PhiSem_Mem_C_Base.Map_of_Val_ins.homo_join_sub_axioms|thm"><span class="entity_def" id="PhiSem_Mem_C_Base.Map_of_Val_ins.homo_sep_axioms|thm"><span class="entity_def" id="PhiSem_Mem_C_Base.Map_of_Val_ins.sep_disj_homo_semi|thm"><span class="entity_def" id="PhiSem_Mem_C_Base.Map_of_Val_ins.homo_sep_disj_axioms|thm"><span class="entity_def" id="PhiSem_Mem_C_Base.Map_of_Val_ins.homo_sep_mult_axioms|thm"><span>interpretation</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span> Map_of_Val_ins</span><span class="main"><span>:</span></span><span> </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Algebras.Algebras.html#Algebras.cancl_sep_orthogonal_monoid|locale"><span>cancl_sep_orthogonal_monoid</span></a><span> </span><span class="quoted"><span class="quoted"><span>‹</span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#PhiSem_Mem_C_Base.Map_of_Val_ins|const"><span>Map_of_Val_ins</span></a><span>›</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>‹</span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#PhiSem_Mem_C_Base.Map_of_Val_ins_dom|const"><span>Map_of_Val_ins_dom</span></a><span> </span><span class="free"><span>TY</span></span><span>›</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/classical.ML.html#HOL.standard|method"><span class="operator"><span>standard</span></span></a><span class="main"><span class="keyword3"><span>;</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.clarsimp|method"><span class="operator"><span>clarsimp</span></span></a><span> </span><span class="quasi_keyword"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#PhiSem_Mem_C_Base.Map_of_Val_ins_def|fact"><span>Map_of_Val_ins_def</span></a><span> </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Algebras.Algebras.html#Algebras.split_discrete_meta_all|fact"><span>split_discrete_meta_all</span></a><span>
                                      </span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#PhiSem_Mem_C_Base.Map_of_Val_ins_dom_def|fact"><span>Map_of_Val_ins_dom_def</span></a><span>
                            </span><span class="quasi_keyword"><span>split</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Option.html#Option.option.split|fact"><span>option.split</span></a><span class="main"><span>)</span></span><span>

  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span> </span><span class="quasi_keyword"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.fun_eq_iff|fact"><span>fun_eq_iff</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Option.html#Option.split_option_ex|fact"><span>split_option_ex</span></a><span> </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Algebras.Algebras.html#Algebras.times_fun|fact"><span>times_fun</span></a><span> 
                                  </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Algebras.Algebras.html#Algebras.sep_disj_fun_def|fact"><span>sep_disj_fun_def</span></a><span> </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Algebras.Algebras.html#Algebras.split_discrete_meta_all|fact"><span>split_discrete_meta_all</span></a><span>
                        </span><span class="quasi_keyword"><span>split</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Option.html#Option.option.split|fact"><span>option.split</span></a><span class="main"><span>)</span></span><span class="main"><span class="keyword3"><span>[</span></span></span><span>1</span><span class="main"><span class="keyword3"><span>]</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#PhiSem_Mem_C_Base.Mapof_not_1|fact"><span>Mapof_not_1</span></a><span> </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.fastforce|method"><span class="operator"><span>fastforce</span></span></a><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/HOL/Tools/Metis/metis_tactic.ML.html#Metis.metis|method"><span class="operator"><span>metis</span></span></a><span> </span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#PhiSem_Mem_C_Base.Map_of_Val_dom|fact"><span>Map_of_Val_dom</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Map.html#Map.domIff|fact"><span>domIff</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Option.html#Option.option.map_disc_iff|fact"><span>option.map_disc_iff</span></a><span> </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Algebras.Algebras.html#Algebras.times_option_none|fact"><span>times_option_none</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>premises</span></span></span><span> </span><span class="entity_def" id="offset_11251..11256">prems</span><span> </span><span class="keyword2"><span class="keyword"><span>for</span></span></span><span> a x x' </span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
    </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_11285..11287">t1</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>‹</span><span class="skolem"><span>a</span></span><span> </span><span class="skolem"><span>x</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span>›</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>for</span></span></span><span> </span><span class="skolem"><span>x</span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/HOL/Tools/Metis/metis_tactic.ML.html#Metis.metis|method"><span class="operator"><span>metis</span></span></a><span> </span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#PhiSem_Mem_C_Base.Map_of_Val_dom|fact"><span>Map_of_Val_dom</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Map.html#Map.domIff|fact"><span>domIff</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Option.html#Option.map_option_is_None|fact"><span>map_option_is_None</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.mult_1|fact"><span>mult_1</span></a><span> </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Algebras.Algebras.html#Algebras.one_option_def|fact"><span>one_option_def</span></a><span> </span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#offset_11251..11256"><span>prems</span></a><span class="main"><span class="main"><span>(</span></span></span><span>1</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#offset_11251..11256"><span>prems</span></a><span class="main"><span class="main"><span>(</span></span></span><span>2</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#offset_11251..11256"><span>prems</span></a><span class="main"><span class="main"><span>(</span></span></span><span>3</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#offset_11251..11256"><span>prems</span></a><span class="main"><span class="main"><span>(</span></span></span><span>4</span><span class="main"><span class="main"><span>)</span></span></span><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_11430..11432">t2</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>‹</span><a class="entity_ref" href="../../HOL/HOL/Option.html#Option.option.map_option|const"><span>map_option</span></a><span> </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Algebras.Algebras.html#Algebras.discrete.discrete|const"><span>discrete</span></a><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/Fun.html#Fun.comp|const"><span>o</span></a></span><span> </span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#PhiSem_Mem_C_Base.Map_of_Val|const"><span>Map_of_Val</span></a><span> </span><span class="skolem"><span>x</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Option.html#Option.option.map_option|const"><span>map_option</span></a><span> </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Algebras.Algebras.html#Algebras.discrete.discrete|const"><span>discrete</span></a><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/Fun.html#Fun.comp|const"><span>o</span></a></span><span> </span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#PhiSem_Mem_C_Base.Map_of_Val|const"><span>Map_of_Val</span></a><span> </span><span class="skolem"><span>x'</span></span><span>›</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#offset_11251..11256"><span>prems</span></a><span class="main"><span>(</span></span><span>4</span><span class="main"><span>)</span></span><span> </span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#offset_11285..11287"><span>t1</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span>
    </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/HOL/Tools/Metis/metis_tactic.ML.html#Metis.metis|method"><span class="operator"><span>metis</span></span></a><span> </span><span class="main"><span class="main"><span>(</span></span></span><span>mono_tags</span><span class="main"><span class="main"><span>,</span></span></span><span> lifting</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#PhiSem_Mem_C_Base.Map_of_Val_inj|fact"><span>Map_of_Val_inj</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Basic_BNFs.html#Basic_BNFs.fun.inj_map_strong|fact"><span>fun.inj_map_strong</span></a><span> </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Algebras.Algebras.html#Algebras.discrete.inject|fact"><span>discrete.inject</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Option.html#Option.Option.option.inj_map_strong|fact"><span>option.inj_map_strong</span></a><span> </span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#offset_11251..11256"><span>prems</span></a><span class="main"><span class="main"><span>(</span></span></span><span>2</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#offset_11251..11256"><span>prems</span></a><span class="main"><span class="main"><span>(</span></span></span><span>3</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#offset_11430..11432"><span>t2</span></a><span class="main"><span>)</span></span><span> 
  </span><span class="keyword1"><span class="command"><span>qed</span></span></span><span> </span><span class="keyword1"><span class="command"><span>.</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="PhiSem_Mem_C_Base.map_tree_refinement_modify|fact"><span class="entity_def" id="PhiSem_Mem_C_Base.map_tree_refinement_modify|thm"><span>map_tree_refinement_modify</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="quoted"><span class="quoted"><span>‹ </span><a class="entity_ref" href="../../HOL/HOL/Map.html#Map.dom|const"><span>dom</span></a><span> </span><span class="free"><span>a</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Map.html#Map.dom|const"><span>dom</span></a><span> </span><span class="free"><span>b</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Map.html#Map.dom|const"><span>dom</span></a><span> </span><span class="free"><span>b</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.subset_eq|const"><span>⊆</span></a></span><span> </span><span class="free"><span>D</span></span><span>
</span><span class="main"><span>⟹</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>⋀</span></span><span class="bound"><span>r</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>r</span></span><span> </span><span class="main"><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Algebras.Algebras.html#Algebras.sep_disj_class.sep_disj|const"><span>##</span></a></span><span> </span><a class="entity_ref" href="../Phi_System/Phi_Algebras.Map_of_Tree.html#Map_of_Tree.push_map|const"><span>push_map</span></a><span> </span><span class="free"><span>idx</span></span><span> </span><span class="free"><span>a</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="bound"><span>r</span></span><span> </span><span class="main"><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Algebras.Algebras.html#Algebras.sep_disj_class.sep_disj|const"><span>##</span></a></span><span> </span><a class="entity_ref" href="../Phi_System/Phi_Algebras.Map_of_Tree.html#Map_of_Tree.push_map|const"><span>push_map</span></a><span> </span><span class="free"><span>idx</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="bound"><span>r</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><a class="entity_ref" href="../Phi_System/Phi_Algebras.Map_of_Tree.html#Map_of_Tree.push_map|const"><span>push_map</span></a><span> </span><span class="free"><span>idx</span></span><span> </span><span class="free"><span>a</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span> </span><span class="free"><span>S</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="bound"><span>r</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><a class="entity_ref" href="../Phi_System/Phi_Algebras.Map_of_Tree.html#Map_of_Tree.push_map|const"><span>push_map</span></a><span> </span><span class="free"><span>idx</span></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span> </span><span class="free"><span>S</span></span><span class="main"><span>)</span></span><span>
</span><span class="main"><span>⟹</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>{</span></span><span class="main"><span>(</span></span><span class="bound"><span>a</span></span><span class="main"><span>,</span></span><span> </span><span class="bound"><span>a</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Map.html#Map.map_add|const"><span>++</span></a></span><span> </span><a class="entity_ref" href="../Phi_System/Phi_Algebras.Map_of_Tree.html#Map_of_Tree.push_map|const"><span>push_map</span></a><span> </span><span class="free"><span>idx</span></span><span> </span><span class="free"><span>b</span></span><span class="main"><span>)</span></span><span class="main"><span>}</span></span><span> </span><span class="keyword1"><span>𝗌𝗎𝖻𝗃</span></span><span> </span><span class="bound"><span>a</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Map.html#Map.dom|const"><span>dom</span></a><span> </span><span class="bound"><span>a</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="free"><span>D</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Relation.html#Relation.Id_on|const"><span>Id_on</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.UNIV|const"><span>UNIV</span></a><span>
    </span><span class="keyword1"><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Algebras.Phi_Fiction.html#Phi_Fiction.Fictional_Forward_Simulation|const"><span>𝗋𝖾𝖿𝗂𝗇𝖾𝗌</span></a></span><span> </span><span class="main"><span>{</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Phi_System/Phi_Algebras.Map_of_Tree.html#Map_of_Tree.push_map|const"><span>push_map</span></a><span> </span><span class="free"><span>idx</span></span><span> </span><span class="free"><span>a</span></span><span class="main"><span>,</span></span><span> </span><a class="entity_ref" href="../Phi_System/Phi_Algebras.Map_of_Tree.html#Map_of_Tree.push_map|const"><span>push_map</span></a><span> </span><span class="free"><span>idx</span></span><span> </span><span class="free"><span>b</span></span><span class="main"><span>)</span></span><span class="main"><span>}</span></span><span>
    </span><span class="keyword1"><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Algebras.Phi_Fiction.html#Phi_Fiction.Fictional_Forward_Simulation|const"><span>𝗐.𝗋.𝗍</span></a></span><span> </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Algebras.Phi_Fiction.html#Phi_Fiction.\&lt;F&gt;_functional|const"><span>ℱ_functional</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Fun.html#Fun.id|const"><span>id</span></a><span> </span><span class="free"><span>S</span></span><span>
    </span><span class="keyword1"><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Algebras.Phi_Fiction.html#Phi_Fiction.Fictional_Forward_Simulation|const"><span>𝗂𝗇</span></a></span><span> </span><span class="main"><span>{</span></span><span> </span><a class="entity_ref" href="../Phi_System/Phi_Algebras.Map_of_Tree.html#Map_of_Tree.push_map|const"><span>push_map</span></a><span> </span><span class="free"><span>idx</span></span><span> </span><span class="free"><span>a</span></span><span> </span><span class="main"><span>}</span></span><span>›</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>for</span></span></span><span> </span><span class="free"><span>a</span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>‹</span><span class="tfree"><span>'a</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/List.html#List.list|type"><span>list</span></a><span> </span><span class="main"><span>⇒</span></span><span> </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Semantics_Framework.html#Phi_Semantics_Framework.VAL|type"><span>VAL</span></a><span> </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Algebras.Algebras.html#Algebras.discrete|type"><span>discrete</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Option.html#Option.option|type"><span>option</span></a><span>›</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Algebras.Phi_Fiction.html#Phi_Fiction.Fictional_Forward_Simulation_def|fact"><span>Fictional_Forward_Simulation_def</span></a><span> </span><a class="entity_ref" href="../Phi_System/Phi_Algebras.Map_of_Tree.html#Map_of_Tree.the_subtree_def|fact"><span>the_subtree_def</span></a><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.clarsimp|method"><span class="operator"><span>clarsimp</span></span></a><span> </span><span class="quasi_keyword"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Algebras.Phi_Spec_Pre.html#Phi_Spec_Pre.Subjection_expn_set|fact"><span>Subjection_expn_set</span></a><span> </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Algebras.Algebras.html#Algebras.set_mult_expn|fact"><span>set_mult_expn</span></a><span> </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Algebras.Phi_Spec_Pre.html#Phi_Spec_Pre.ExSet_expn_set|fact"><span>ExSet_expn_set</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>premises</span></span></span><span> </span><span class="entity_def" id="offset_12229..12234">prems</span><span> </span><span class="keyword2"><span class="keyword"><span>for</span></span></span><span> r R a' u x
  </span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
    </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_12269..12271">t1</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>‹</span><a class="entity_ref" href="../../HOL/HOL/Map.html#Map.dom|const"><span>dom</span></a><span> </span><span class="skolem"><span>x</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.inter|const"><span>∩</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Map.html#Map.dom|const"><span>dom</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span>idx</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../Phi_System/Phi_Algebras.Map_of_Tree.html#Map_of_Tree.push_map|const"><span>‣<span class="hidden">⇩</span><sub>m</sub></span></a></span><span> </span><span class="free"><span>b</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.empty|const"><span>{}</span></a></span><span>›</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.disjoint_iff|fact"><span>disjoint_iff</span></a><span> </span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#offset_12229..12234"><span>prems</span></a><span class="main"><span>(</span></span><span>10</span><span class="main"><span>)</span></span><span> </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Algebras.Algebras.html#Algebras.sep_disj_partial_map_disjoint|fact"><span>sep_disj_partial_map_disjoint</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.fastforce|method"><span class="operator"><span>fastforce</span></span></a><span>
    </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_12391..12393">t2</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>‹</span><a class="entity_ref" href="../../HOL/HOL/Map.html#Map.dom|const"><span>dom</span></a><span> </span><span class="skolem"><span>r</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.inter|const"><span>∩</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Map.html#Map.dom|const"><span>dom</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span>idx</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../Phi_System/Phi_Algebras.Map_of_Tree.html#Map_of_Tree.push_map|const"><span>‣<span class="hidden">⇩</span><sub>m</sub></span></a></span><span> </span><span class="free"><span>b</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.empty|const"><span>{}</span></a></span><span>›</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/HOL/Tools/Metis/metis_tactic.ML.html#Metis.metis|method"><span class="operator"><span>metis</span></span></a><span> </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Algebras.Algebras.html#Algebras.dom1_dom|fact"><span>dom1_dom</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Lattices.html#Lattices.lattice_class.inf_sup_aci|fact"><span>inf_sup_aci</span></a><span class="main"><span class="main"><span>(</span></span></span><span>1</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#offset_12229..12234"><span>prems</span></a><span class="main"><span class="main"><span>(</span></span></span><span>2</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#offset_12229..12234"><span>prems</span></a><span class="main"><span class="main"><span>(</span></span></span><span>4</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><a class="entity_ref" href="../Phi_System/Phi_Algebras.Map_of_Tree.html#Map_of_Tree.push_map_dom_eq|fact"><span>push_map_dom_eq</span></a><span> </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Algebras.Algebras.html#Algebras.sep_disj_dom1_disj_disjoint|fact"><span>sep_disj_dom1_disj_disjoint</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_12538..12540">t3</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>‹</span><a class="entity_ref" href="../../HOL/HOL/Map.html#Map.dom|const"><span>dom</span></a><span> </span><span class="skolem"><span>u</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.inter|const"><span>∩</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Map.html#Map.dom|const"><span>dom</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span>idx</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../Phi_System/Phi_Algebras.Map_of_Tree.html#Map_of_Tree.push_map|const"><span>‣<span class="hidden">⇩</span><sub>m</sub></span></a></span><span> </span><span class="free"><span>b</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.empty|const"><span>{}</span></a></span><span>›</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/HOL/Tools/Metis/metis_tactic.ML.html#Metis.metis|method"><span class="operator"><span>metis</span></span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.Int_commute|fact"><span>Int_commute</span></a><span> </span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#offset_12229..12234"><span>prems</span></a><span class="main"><span class="main"><span>(</span></span></span><span>11</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#offset_12229..12234"><span>prems</span></a><span class="main"><span class="main"><span>(</span></span></span><span>2</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><a class="entity_ref" href="../Phi_System/Phi_Algebras.Map_of_Tree.html#Map_of_Tree.push_map_dom_eq|fact"><span>push_map_dom_eq</span></a><span> </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Algebras.Algebras.html#Algebras.sep_disj_partial_map_disjoint|fact"><span>sep_disj_partial_map_disjoint</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_12676..12678">t4</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>‹</span><span class="free"><span>idx</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../Phi_System/Phi_Algebras.Map_of_Tree.html#Map_of_Tree.push_map|const"><span>‣<span class="hidden">⇩</span><sub>m</sub></span></a></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="main"><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Algebras.Algebras.html#Algebras.sep_disj_class.sep_disj|const"><span>##</span></a></span><span> </span><span class="skolem"><span>u</span></span><span>›</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Algebras.Algebras.html#Algebras.sep_disj_partial_map_disjoint|fact"><span>sep_disj_partial_map_disjoint</span></a><span> </span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#offset_12538..12540"><span>t3</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/blast.ML.html#HOL.blast|method"><span class="operator"><span>blast</span></span></a><span>
    </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_12760..12762">t5</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>‹</span><span class="free"><span>idx</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../Phi_System/Phi_Algebras.Map_of_Tree.html#Map_of_Tree.push_map|const"><span>‣<span class="hidden">⇩</span><sub>m</sub></span></a></span><span> </span><span class="free"><span>b</span></span><span> </span><span class="main"><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Algebras.Algebras.html#Algebras.sep_disj_class.sep_disj|const"><span>##</span></a></span><span> </span><span class="skolem"><span>r</span></span><span>›</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Algebras.Algebras.html#Algebras.sep_disj_partial_map_disjoint|fact"><span>sep_disj_partial_map_disjoint</span></a><span> </span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#offset_12391..12393"><span>t2</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/blast.ML.html#HOL.blast|method"><span class="operator"><span>blast</span></span></a><span>
    </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span>t6</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>‹</span><a class="entity_ref" href="../../HOL/HOL/Map.html#Map.dom|const"><span>dom</span></a><span> </span><span class="skolem"><span>a'</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.inter|const"><span>∩</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Map.html#Map.dom|const"><span>dom</span></a><span> </span><span class="skolem"><span>x</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.empty|const"><span>{}</span></a></span><span>›</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/HOL/Tools/Meson/meson_tactic.ML.html#Meson.meson|method"><span class="operator"><span>meson</span></span></a><span> </span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#offset_12229..12234"><span>prems</span></a><span class="main"><span class="main"><span>(</span></span></span><span>9</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Algebras.Algebras.html#Algebras.sep_disj_partial_map_disjoint|fact"><span>sep_disj_partial_map_disjoint</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#offset_12760..12762"><span>t5</span></a><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/classical.ML.html#HOL.rule|method"><span class="operator"><span>rule</span></span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.exI|fact"><span>exI</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="keyword2"><span class="keyword"><a class="entity_ref" href="../Phi_System/ISABELLE_HOME/src/HOL/Eisbach/eisbach_rule_insts.ML.html#Eisbach.where|attribute"><span class="operator"><span>where</span></span></a></span></span><span> x</span><span class="main"><span class="main"><span class="main"><span>=</span></span></span></span><span class="quoted"><span class="skolem"><span>u</span></span></span><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#offset_12676..12678"><span>t4</span></a><span> </span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#offset_12229..12234"><span>prems</span></a><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/HOL/Tools/Metis/metis_tactic.ML.html#Metis.metis|method"><span class="operator"><span>metis</span></span></a><span> </span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#PhiSem_Mem_C_Base.map_add_subsumed_dom|fact"><span>map_add_subsumed_dom</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.ab_semigroup_mult_class.mult.commute|fact"><span>mult.commute</span></a><span> </span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#offset_12229..12234"><span>prems</span></a><span class="main"><span class="main"><span>(</span></span></span><span>1</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#offset_12229..12234"><span>prems</span></a><span class="main"><span class="main"><span>(</span></span></span><span>2</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#offset_12229..12234"><span>prems</span></a><span class="main"><span class="main"><span>(</span></span></span><span>4</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#offset_12229..12234"><span>prems</span></a><span class="main"><span class="main"><span>(</span></span></span><span>6</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#offset_12229..12234"><span>prems</span></a><span class="main"><span class="main"><span>(</span></span></span><span>7</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><a class="entity_ref" href="../Phi_System/Phi_Algebras.Map_of_Tree.html#Map_of_Tree.push_map_distrib_map_add|fact"><span>push_map_distrib_map_add</span></a><span> </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Algebras.Algebras.html#Algebras.comm_sep_disj_class.sep_disj_commute|fact"><span>sep_disj_commute</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.subset_refl|fact"><span>subset_refl</span></a><span> </span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#offset_12269..12271"><span>t1</span></a><span> </span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#offset_12391..12393"><span>t2</span></a><span> </span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#offset_12538..12540"><span>t3</span></a><span> </span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#offset_12760..12762"><span>t5</span></a><span> </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Algebras.Algebras.html#Algebras.times_fun_map_add_right|fact"><span>times_fun_map_add_right</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>qed</span></span></span><span> </span><span class="keyword1"><span class="command"><span>.</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="PhiSem_Mem_C_Base.fiction_Map_of_Val_ins_comp_id_simp|fact"><span class="entity_def" id="PhiSem_Mem_C_Base.fiction_Map_of_Val_ins_comp_id_simp|thm"><span>fiction_Map_of_Val_ins_comp_id_simp</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="quoted"><span class="quoted"><span>‹</span><span class="main"><span>(</span></span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Algebras.Phi_Fiction.html#Phi_Fiction.\&lt;F&gt;_functional|const"><span>ℱ_functional</span></a><span> </span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#PhiSem_Mem_C_Base.Map_of_Val_ins|const"><span>Map_of_Val_ins</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#PhiSem_Mem_C_Base.Map_of_Val_ins_dom|const"><span>Map_of_Val_ins_dom</span></a><span> </span><span class="free"><span>TY</span></span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Algebras.Phi_Fiction.html#Phi_Fiction.interp_comp|const"><span>⨾<span class="hidden">⇩</span><sub>ℐ</sub></span></a></span><span>
    </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Algebras.Phi_Fiction.html#Phi_Fiction.\&lt;F&gt;_functional|const"><span>ℱ_functional</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Fun.html#Fun.id|const"><span>id</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#PhiSem_Mem_C_Base.Map_of_Val_ins|const"><span>Map_of_Val_ins</span></a><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.image|const"><span>`</span></a></span><span> </span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#PhiSem_Mem_C_Base.Map_of_Val_ins_dom|const"><span>Map_of_Val_ins_dom</span></a><span> </span><span class="free"><span>TY</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>
  </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Algebras.Phi_Fiction.html#Phi_Fiction.\&lt;F&gt;_functional|const"><span>ℱ_functional</span></a><span> </span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#PhiSem_Mem_C_Base.Map_of_Val_ins|const"><span>Map_of_Val_ins</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#PhiSem_Mem_C_Base.Map_of_Val_ins_dom|const"><span>Map_of_Val_ins_dom</span></a><span> </span><span class="free"><span>TY</span></span><span class="main"><span>)</span></span><span>›</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/classical.ML.html#HOL.rule|method"><span class="operator"><span>rule</span></span></a><span> </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Algebras.Phi_Fiction.html#Phi_Fiction.\&lt;F&gt;_functional_comp|fact"><span>ℱ_functional_comp</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="keyword2"><span class="keyword"><a class="entity_ref" href="../Phi_System/ISABELLE_HOME/src/HOL/Eisbach/eisbach_rule_insts.ML.html#Eisbach.where|attribute"><span class="operator"><span>where</span></span></a></span></span><span> f</span><span class="main"><span class="main"><span class="main"><span>=</span></span></span></span><span class="quoted"><a class="entity_ref" href="../../HOL/HOL/Fun.html#Fun.id|const"><span>id</span></a></span><span class="main"><span class="main"><span>,</span></span></span><span> </span><span class="operator"><span>simplified</span></span><span class="main"><span class="main"><span>,</span></span></span><span> </span><span class="operator"><span>symmetric</span></span><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span class="keyword3"><span>;</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.clarsimp|method"><span class="operator"><span>clarsimp</span></span></a><span class="main"><span>)</span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="PhiSem_Mem_C_Base.val_map_eq_index_value_eq|fact"><span class="entity_def" id="PhiSem_Mem_C_Base.val_map_eq_index_value_eq|thm"><span>val_map_eq_index_value_eq</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="quoted"><span class="quoted"><span>‹</span><a class="entity_ref" href="../Phi_Semantics/PhiSem_Aggregate_Base.html#PhiSem_Aggregate_Base.valid_index|const"><span>valid_index</span></a><span> </span><span class="free"><span>TY</span></span><span> </span><span class="free"><span>idx</span></span><span> </span><span class="main"><span>⟹</span></span><span>
    </span><span class="free"><span>u_idx</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span> </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Semantics_Framework.html#Phi_Semantics_Framework.Well_Type|const"><span>Well_Type</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Phi_Semantics/PhiSem_Aggregate_Base.html#PhiSem_Aggregate_Base.index_type|const"><span>index_type</span></a><span> </span><span class="free"><span>idx</span></span><span> </span><span class="free"><span>TY</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>⟹</span></span><span>
    </span><span class="free"><span>v</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span> </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Semantics_Framework.html#Phi_Semantics_Framework.Well_Type|const"><span>Well_Type</span></a><span> </span><span class="free"><span>TY</span></span><span> </span><span class="main"><span>⟹</span></span><span>
    </span><a class="entity_ref" href="../../HOL/HOL/Option.html#Option.option.map_option|const"><span>map_option</span></a><span> </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Algebras.Algebras.html#Algebras.discrete.discrete|const"><span>discrete</span></a><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Fun.html#Fun.comp|const"><span>∘</span></a></span><span> </span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#PhiSem_Mem_C_Base.Map_of_Val|const"><span>Map_of_Val</span></a><span> </span><span class="free"><span>v</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="free"><span>idx</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../Phi_System/Phi_Algebras.Map_of_Tree.html#Map_of_Tree.push_map|const"><span>‣<span class="hidden">⇩</span><sub>m</sub></span></a></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/Option.html#Option.option.map_option|const"><span>map_option</span></a><span> </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Algebras.Algebras.html#Algebras.discrete.discrete|const"><span>discrete</span></a><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Fun.html#Fun.comp|const"><span>∘</span></a></span><span> </span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#PhiSem_Mem_C_Base.Map_of_Val|const"><span>Map_of_Val</span></a><span> </span><span class="free"><span>u_idx</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><span class="free"><span>u</span></span><span> </span><span class="main"><span>⟹</span></span><span>
    </span><span class="free"><span>u</span></span><span> </span><span class="main"><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Algebras.Algebras.html#Algebras.sep_disj_class.sep_disj|const"><span>##</span></a></span><span> </span><span class="free"><span>idx</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../Phi_System/Phi_Algebras.Map_of_Tree.html#Map_of_Tree.push_map|const"><span>‣<span class="hidden">⇩</span><sub>m</sub></span></a></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/Option.html#Option.option.map_option|const"><span>map_option</span></a><span> </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Algebras.Algebras.html#Algebras.discrete.discrete|const"><span>discrete</span></a><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Fun.html#Fun.comp|const"><span>∘</span></a></span><span> </span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#PhiSem_Mem_C_Base.Map_of_Val|const"><span>Map_of_Val</span></a><span> </span><span class="free"><span>u_idx</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>⟹</span></span><span>
    </span><a class="entity_ref" href="../Phi_Semantics/PhiSem_Aggregate_Base.html#PhiSem_Aggregate_Base.index_value|const"><span>index_value</span></a><span> </span><span class="free"><span>idx</span></span><span> </span><span class="free"><span>v</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="free"><span>u_idx</span></span><span> ›</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>premises</span></span></span><span> </span><span class="entity_def" id="offset_13835..13840">prems</span><span> </span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
    </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_13858..13860">t1</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>‹</span><a class="entity_ref" href="../../HOL/HOL/Map.html#Map.dom|const"><span>dom</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Phi_System/Phi_Algebras.Map_of_Tree.html#Map_of_Tree.pull_map|const"><span>pull_map</span></a><span> </span><span class="free"><span>idx</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#PhiSem_Mem_C_Base.Map_of_Val|const"><span>Map_of_Val</span></a><span> </span><span class="free"><span>v</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#PhiSem_Mem_C_Base.Dom_of_TY|const"><span>Dom_of_TY</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Phi_Semantics/PhiSem_Aggregate_Base.html#PhiSem_Aggregate_Base.index_type|const"><span>index_type</span></a><span> </span><span class="free"><span>idx</span></span><span> </span><span class="free"><span>TY</span></span><span class="main"><span>)</span></span><span>›</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#PhiSem_Mem_C_Base.Map_of_Val_dom|fact"><span>Map_of_Val_dom</span></a><span> </span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#PhiSem_Mem_C_Base.Map_of_Val_pull|fact"><span>Map_of_Val_pull</span></a><span> </span><a class="entity_ref" href="../Phi_Semantics/PhiSem_Aggregate_Base.html#PhiSem_Aggregate_Base.index_value_welltyp|fact"><span>index_value_welltyp</span></a><span> </span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#offset_13835..13840"><span>prems</span></a><span class="main"><span>(</span></span><span>1</span><span class="main"><span>)</span></span><span> </span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#offset_13835..13840"><span>prems</span></a><span class="main"><span>(</span></span><span>3</span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span>
    </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_14028..14030">t2</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>‹</span><a class="entity_ref" href="../../HOL/HOL/Map.html#Map.dom|const"><span>dom</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Phi_System/Phi_Algebras.Map_of_Tree.html#Map_of_Tree.pull_map|const"><span>pull_map</span></a><span> </span><span class="free"><span>idx</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#PhiSem_Mem_C_Base.Map_of_Val|const"><span>Map_of_Val</span></a><span> </span><span class="free"><span>v</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span>
              </span><a class="entity_ref" href="../../HOL/HOL/Map.html#Map.dom|const"><span>dom</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Phi_System/Phi_Algebras.Map_of_Tree.html#Map_of_Tree.pull_map|const"><span>pull_map</span></a><span> </span><span class="free"><span>idx</span></span><span> </span><span class="free"><span>u</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.union|const"><span>∪</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Map.html#Map.dom|const"><span>dom</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#PhiSem_Mem_C_Base.Map_of_Val|const"><span>Map_of_Val</span></a><span> </span><span class="free"><span>u_idx</span></span><span class="main"><span>)</span></span><span>›</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/HOL/Tools/Metis/metis_tactic.ML.html#Metis.metis|method"><span class="operator"><span>metis</span></span></a><span> </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Algebras.Algebras.html#Algebras.dom1_dom|fact"><span>dom1_dom</span></a><span> </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Algebras.Algebras.html#Algebras.dom1_mult|fact"><span>dom1_mult</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Map.html#Map.dom_map_option_comp|fact"><span>dom_map_option_comp</span></a><span> </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Algebras.Algebras.html#Algebras.homo_one_map_option|fact"><span>homo_one_map_option</span></a><span> </span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#offset_13835..13840"><span>prems</span></a><span class="main"><span class="main"><span>(</span></span></span><span>4</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#offset_13835..13840"><span>prems</span></a><span class="main"><span class="main"><span>(</span></span></span><span>5</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><a class="entity_ref" href="../Phi_System/Phi_Algebras.Map_of_Tree.html#Map_of_Tree.pull_map_funcomp|fact"><span>pull_map_funcomp</span></a><span> </span><a class="entity_ref" href="../Phi_System/Phi_Algebras.Map_of_Tree.html#Map_of_Tree.pull_map_homo_mult|fact"><span>pull_map_homo_mult</span></a><span> </span><a class="entity_ref" href="../Phi_System/Phi_Algebras.Map_of_Tree.html#Map_of_Tree.pull_map_sep_disj|fact"><span>pull_map_sep_disj</span></a><span> </span><a class="entity_ref" href="../Phi_System/Phi_Algebras.Map_of_Tree.html#Map_of_Tree.pull_push_map|fact"><span>pull_push_map</span></a><span> </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Algebras.Algebras.html#Algebras.sep_ab_semigroup_class.sep_mult_commute|fact"><span>sep_mult_commute</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_14318..14320">t3</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>‹</span><a class="entity_ref" href="../../HOL/HOL/Map.html#Map.dom|const"><span>dom</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Phi_System/Phi_Algebras.Map_of_Tree.html#Map_of_Tree.pull_map|const"><span>pull_map</span></a><span> </span><span class="free"><span>idx</span></span><span> </span><span class="free"><span>u</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.inter|const"><span>∩</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Map.html#Map.dom|const"><span>dom</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#PhiSem_Mem_C_Base.Map_of_Val|const"><span>Map_of_Val</span></a><span> </span><span class="free"><span>u_idx</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.empty|const"><span>{}</span></a></span><span>›</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/HOL/Tools/Metis/metis_tactic.ML.html#Metis.metis|method"><span class="operator"><span>metis</span></span></a><span> </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Algebras.Algebras.html#Algebras.dom1_dom|fact"><span>dom1_dom</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Map.html#Map.dom_map_option_comp|fact"><span>dom_map_option_comp</span></a><span> </span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#offset_13835..13840"><span>prems</span></a><span class="main"><span class="main"><span>(</span></span></span><span>5</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><a class="entity_ref" href="../Phi_System/Phi_Algebras.Map_of_Tree.html#Map_of_Tree.pull_map_sep_disj|fact"><span>pull_map_sep_disj</span></a><span> </span><a class="entity_ref" href="../Phi_System/Phi_Algebras.Map_of_Tree.html#Map_of_Tree.pull_push_map|fact"><span>pull_push_map</span></a><span> </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Algebras.Algebras.html#Algebras.sep_disj_dom1_disj_disjoint|fact"><span>sep_disj_dom1_disj_disjoint</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_14499..14501">t4</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>‹</span><a class="entity_ref" href="../../HOL/HOL/Map.html#Map.dom|const"><span>dom</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#PhiSem_Mem_C_Base.Map_of_Val|const"><span>Map_of_Val</span></a><span> </span><span class="free"><span>u_idx</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#PhiSem_Mem_C_Base.Dom_of_TY|const"><span>Dom_of_TY</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Phi_Semantics/PhiSem_Aggregate_Base.html#PhiSem_Aggregate_Base.index_type|const"><span>index_type</span></a><span> </span><span class="free"><span>idx</span></span><span> </span><span class="free"><span>TY</span></span><span class="main"><span>)</span></span><span>›</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#PhiSem_Mem_C_Base.Map_of_Val_dom|fact"><span>Map_of_Val_dom</span></a><span> </span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#offset_13835..13840"><span>prems</span></a><span class="main"><span>(</span></span><span>2</span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.force|method"><span class="operator"><span>force</span></span></a><span>
    </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span>t5</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>‹</span><a class="entity_ref" href="../Phi_System/Phi_Algebras.Map_of_Tree.html#Map_of_Tree.pull_map|const"><span>pull_map</span></a><span> </span><span class="free"><span>idx</span></span><span> </span><span class="free"><span>u</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span>›</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#offset_13858..13860"><span>t1</span></a><span> </span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#offset_14028..14030"><span>t2</span></a><span> </span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#offset_14318..14320"><span>t3</span></a><span> </span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#offset_14499..14501"><span>t4</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.fastforce|method"><span class="operator"><span>fastforce</span></span></a><span>
    </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>‹</span><a class="entity_ref" href="../Phi_System/Phi_Algebras.Map_of_Tree.html#Map_of_Tree.pull_map|const"><span>pull_map</span></a><span> </span><span class="free"><span>idx</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/Option.html#Option.option.map_option|const"><span>map_option</span></a><span> </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Algebras.Algebras.html#Algebras.discrete.discrete|const"><span>discrete</span></a><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Fun.html#Fun.comp|const"><span>∘</span></a></span><span> </span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#PhiSem_Mem_C_Base.Map_of_Val|const"><span>Map_of_Val</span></a><span> </span><span class="free"><span>v</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/Option.html#Option.option.map_option|const"><span>map_option</span></a><span> </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Algebras.Algebras.html#Algebras.discrete.discrete|const"><span>discrete</span></a><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Fun.html#Fun.comp|const"><span>∘</span></a></span><span> </span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#PhiSem_Mem_C_Base.Map_of_Val|const"><span>Map_of_Val</span></a><span> </span><span class="free"><span>u_idx</span></span><span class="main"><span>)</span></span><span>›</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#offset_13835..13840"><span>prems</span></a><span class="main"><span class="main"><span>(</span></span></span><span>4</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><a class="entity_ref" href="../Phi_System/Phi_Algebras.Map_of_Tree.html#Map_of_Tree.pull_map_homo_mult|fact"><span>pull_map_homo_mult</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>‹</span><a class="entity_ref" href="../Phi_System/Phi_Algebras.Map_of_Tree.html#Map_of_Tree.pull_map|const"><span>pull_map</span></a><span> </span><span class="free"><span>idx</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#PhiSem_Mem_C_Base.Map_of_Val|const"><span>Map_of_Val</span></a><span> </span><span class="free"><span>v</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#PhiSem_Mem_C_Base.Map_of_Val|const"><span>Map_of_Val</span></a><span> </span><span class="free"><span>u_idx</span></span><span>›</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/HOL/Tools/SMT/smt_systems.ML.html#SMT.smt|method"><span class="operator"><span>smt</span></span></a><span> </span><span class="main"><span class="main"><span>(</span></span></span><span>verit</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Basic_BNFs.html#Basic_BNFs.fun.inj_map_strong|fact"><span>fun.inj_map_strong</span></a><span> </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Algebras.Algebras.html#Algebras.homo_one_map_option|fact"><span>homo_one_map_option</span></a><span> </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Algebras.Algebras.html#Algebras.discrete.inject|fact"><span>discrete.inject</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Option.html#Option.Option.option.inj_map_strong|fact"><span>option.inj_map_strong</span></a><span> </span><a class="entity_ref" href="../Phi_System/Phi_Algebras.Map_of_Tree.html#Map_of_Tree.pull_map_funcomp|fact"><span>pull_map_funcomp</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/HOL/Tools/Metis/metis_tactic.ML.html#Metis.metis|method"><span class="operator"><span>metis</span></span></a><span> </span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#PhiSem_Mem_C_Base.Map_of_Val_inj|fact"><span>Map_of_Val_inj</span></a><span> </span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#PhiSem_Mem_C_Base.Map_of_Val_pull|fact"><span>Map_of_Val_pull</span></a><span> </span><a class="entity_ref" href="../Phi_Semantics/PhiSem_Aggregate_Base.html#PhiSem_Aggregate_Base.index_value_welltyp|fact"><span>index_value_welltyp</span></a><span> </span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#offset_13835..13840"><span>prems</span></a><span class="main"><span class="main"><span>(</span></span></span><span>1</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#offset_13835..13840"><span>prems</span></a><span class="main"><span class="main"><span>(</span></span></span><span>2</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#offset_13835..13840"><span>prems</span></a><span class="main"><span class="main"><span>(</span></span></span><span>3</span><span class="main"><span class="main"><span>)</span></span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>qed</span></span></span><span> </span><span class="keyword1"><span class="command"><span>.</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="PhiSem_Mem_C_Base.val_map_mod_index_value|fact"><span class="entity_def" id="PhiSem_Mem_C_Base.val_map_mod_index_value|thm"><span>val_map_mod_index_value</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="quoted"><span class="quoted"><span>‹ </span><a class="entity_ref" href="../Phi_Semantics/PhiSem_Aggregate_Base.html#PhiSem_Aggregate_Base.valid_index|const"><span>valid_index</span></a><span> </span><span class="free"><span>TY</span></span><span> </span><span class="free"><span>idx</span></span><span> </span><span class="main"><span>⟹</span></span><span>
    </span><span class="free"><span>x</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span> </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Semantics_Framework.html#Phi_Semantics_Framework.Well_Type|const"><span>Well_Type</span></a><span> </span><span class="free"><span>TY</span></span><span> </span><span class="main"><span>⟹</span></span><span>
    </span><span class="free"><span>u</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span> </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Semantics_Framework.html#Phi_Semantics_Framework.Well_Type|const"><span>Well_Type</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Phi_Semantics/PhiSem_Aggregate_Base.html#PhiSem_Aggregate_Base.index_type|const"><span>index_type</span></a><span> </span><span class="free"><span>idx</span></span><span> </span><span class="free"><span>TY</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>⟹</span></span><span>
    </span><span class="free"><span>v</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span> </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Semantics_Framework.html#Phi_Semantics_Framework.Well_Type|const"><span>Well_Type</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Phi_Semantics/PhiSem_Aggregate_Base.html#PhiSem_Aggregate_Base.index_type|const"><span>index_type</span></a><span> </span><span class="free"><span>idx</span></span><span> </span><span class="free"><span>TY</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>⟹</span></span><span>
    </span><span class="free"><span>idx</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../Phi_System/Phi_Algebras.Map_of_Tree.html#Map_of_Tree.push_map|const"><span>‣<span class="hidden">⇩</span><sub>m</sub></span></a></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/Option.html#Option.option.map_option|const"><span>map_option</span></a><span> </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Algebras.Algebras.html#Algebras.discrete.discrete|const"><span>discrete</span></a><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Fun.html#Fun.comp|const"><span>∘</span></a></span><span> </span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#PhiSem_Mem_C_Base.Map_of_Val|const"><span>Map_of_Val</span></a><span> </span><span class="free"><span>u</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Algebras.Algebras.html#Algebras.sep_disj_class.sep_disj|const"><span>##</span></a></span><span> </span><span class="free"><span>r</span></span><span> </span><span class="main"><span>⟹</span></span><span>
    </span><span class="free"><span>idx</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../Phi_System/Phi_Algebras.Map_of_Tree.html#Map_of_Tree.push_map|const"><span>‣<span class="hidden">⇩</span><sub>m</sub></span></a></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/Option.html#Option.option.map_option|const"><span>map_option</span></a><span> </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Algebras.Algebras.html#Algebras.discrete.discrete|const"><span>discrete</span></a><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Fun.html#Fun.comp|const"><span>∘</span></a></span><span> </span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#PhiSem_Mem_C_Base.Map_of_Val|const"><span>Map_of_Val</span></a><span> </span><span class="free"><span>v</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Algebras.Algebras.html#Algebras.sep_disj_class.sep_disj|const"><span>##</span></a></span><span> </span><span class="free"><span>r</span></span><span> </span><span class="main"><span>⟹</span></span><span>
    </span><span class="free"><span>idx</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../Phi_System/Phi_Algebras.Map_of_Tree.html#Map_of_Tree.push_map|const"><span>‣<span class="hidden">⇩</span><sub>m</sub></span></a></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/Option.html#Option.option.map_option|const"><span>map_option</span></a><span> </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Algebras.Algebras.html#Algebras.discrete.discrete|const"><span>discrete</span></a><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Fun.html#Fun.comp|const"><span>∘</span></a></span><span> </span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#PhiSem_Mem_C_Base.Map_of_Val|const"><span>Map_of_Val</span></a><span> </span><span class="free"><span>u</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><span class="free"><span>r</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Option.html#Option.option.map_option|const"><span>map_option</span></a><span> </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Algebras.Algebras.html#Algebras.discrete.discrete|const"><span>discrete</span></a><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Fun.html#Fun.comp|const"><span>∘</span></a></span><span> </span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#PhiSem_Mem_C_Base.Map_of_Val|const"><span>Map_of_Val</span></a><span> </span><span class="free"><span>x</span></span><span> </span><span class="main"><span>⟹</span></span><span>
    </span><span class="free"><span>idx</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../Phi_System/Phi_Algebras.Map_of_Tree.html#Map_of_Tree.push_map|const"><span>‣<span class="hidden">⇩</span><sub>m</sub></span></a></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/Option.html#Option.option.map_option|const"><span>map_option</span></a><span> </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Algebras.Algebras.html#Algebras.discrete.discrete|const"><span>discrete</span></a><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Fun.html#Fun.comp|const"><span>∘</span></a></span><span> </span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#PhiSem_Mem_C_Base.Map_of_Val|const"><span>Map_of_Val</span></a><span> </span><span class="free"><span>v</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><span class="free"><span>r</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Option.html#Option.option.map_option|const"><span>map_option</span></a><span> </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Algebras.Algebras.html#Algebras.discrete.discrete|const"><span>discrete</span></a><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Fun.html#Fun.comp|const"><span>∘</span></a></span><span> </span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#PhiSem_Mem_C_Base.Map_of_Val|const"><span>Map_of_Val</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Phi_Semantics/PhiSem_Aggregate_Base.html#PhiSem_Aggregate_Base.index_mod_value|const"><span>index_mod_value</span></a><span> </span><span class="free"><span>idx</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="main"><span class="bound"><span>_</span></span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>v</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>x</span></span><span class="main"><span>)</span></span><span>›</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#PhiSem_Mem_C_Base.Map_of_Val_mod|fact"><span>Map_of_Val_mod</span></a><span> </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Algebras.Algebras.html#Algebras.map_option_funcomp_map_add|fact"><span>map_option_funcomp_map_add</span></a><span class="main"><span class="keyword3"><span>,</span></span></span><span>
      </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/HOL/Tools/SMT/smt_systems.ML.html#SMT.smt|method"><span class="operator"><span>smt</span></span></a><span> </span><span class="main"><span class="main"><span>(</span></span></span><span>verit</span><span class="main"><span class="main"><span>,</span></span></span><span> del_insts</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#PhiSem_Mem_C_Base.Dom_of_TY|fact"><span>Dom_of_TY</span></a><span> </span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#PhiSem_Mem_C_Base.Map_of_Val_dom|fact"><span>Map_of_Val_dom</span></a><span> </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Algebras.Algebras.html#Algebras.homo_one_map_option|fact"><span>homo_one_map_option</span></a><span> </span><a class="entity_ref" href="../Phi_Semantics/PhiSem_Aggregate_Base.html#PhiSem_Aggregate_Base.index_type_idem|fact"><span>index_type_idem</span></a><span>
          </span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#PhiSem_Mem_C_Base.map_add_subsumed_dom|fact"><span>map_add_subsumed_dom</span></a><span> </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Algebras.Algebras.html#Algebras.map_option_funcomp_map_add|fact"><span>map_option_funcomp_map_add</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.ab_semigroup_mult_class.mult.commute|fact"><span>mult.commute</span></a><span> </span><a class="entity_ref" href="../Phi_System/Phi_Algebras.Map_of_Tree.html#Map_of_Tree.push_map_distrib_map_add|fact"><span>push_map_distrib_map_add</span></a><span>
          </span><a class="entity_ref" href="../Phi_System/Phi_Algebras.Map_of_Tree.html#Map_of_Tree.push_map_homo|fact"><span>push_map_homo</span></a><span> </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Algebras.Algebras.html#Algebras.comm_sep_disj_class.sep_disj_commute|fact"><span>sep_disj_commute</span></a><span> </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Algebras.Algebras.html#Algebras.sep_disj_partial_map_disjoint|fact"><span>sep_disj_partial_map_disjoint</span></a><span> </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Algebras.Algebras.html#Algebras.times_fun_map_add_right|fact"><span>times_fun_map_add_right</span></a><span> </span><a class="entity_ref" href="../Phi_Semantics/PhiSem_Aggregate_Base.html#PhiSem_Aggregate_Base.valid_index.simps|fact"><span>valid_index.simps</span></a><span class="main"><span class="main"><span>(</span></span></span><span>1</span><span class="main"><span class="main"><span>)</span></span></span><span class="main"><span>)</span></span><span>
      

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="PhiSem_Mem_C_Base.val_map_mod_index_value_projection|fact"><span class="entity_def" id="PhiSem_Mem_C_Base.val_map_mod_index_value_projection|thm"><span>val_map_mod_index_value_projection</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="quoted"><span class="quoted"><span>‹ </span><a class="entity_ref" href="../Phi_Semantics/PhiSem_Aggregate_Base.html#PhiSem_Aggregate_Base.valid_index|const"><span>valid_index</span></a><span> </span><span class="free"><span>TY</span></span><span> </span><span class="free"><span>idx</span></span><span> </span><span class="main"><span>⟹</span></span><span>
    </span><span class="free"><span>u_idx</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span> </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Semantics_Framework.html#Phi_Semantics_Framework.Well_Type|const"><span>Well_Type</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Phi_Semantics/PhiSem_Aggregate_Base.html#PhiSem_Aggregate_Base.index_type|const"><span>index_type</span></a><span> </span><span class="free"><span>idx</span></span><span> </span><span class="free"><span>TY</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>⟹</span></span><span>
    </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Algebras.Phi_Fiction.html#Phi_Fiction.refinement_projection|const"><span>refinement_projection</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Algebras.Phi_Fiction.html#Phi_Fiction.\&lt;F&gt;_functional|const"><span>ℱ_functional</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Fun.html#Fun.id|const"><span>id</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#PhiSem_Mem_C_Base.Map_of_Val_ins|const"><span>Map_of_Val_ins</span></a><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.image|const"><span>`</span></a></span><span> </span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#PhiSem_Mem_C_Base.Map_of_Val_ins_dom|const"><span>Map_of_Val_ins_dom</span></a><span> </span><span class="free"><span>TY</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>{</span></span><span class="free"><span>idx</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../Phi_System/Phi_Algebras.Map_of_Tree.html#Map_of_Tree.push_map|const"><span>‣<span class="hidden">⇩</span><sub>m</sub></span></a></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/Option.html#Option.option.map_option|const"><span>map_option</span></a><span> </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Algebras.Algebras.html#Algebras.discrete.discrete|const"><span>discrete</span></a><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Fun.html#Fun.comp|const"><span>∘</span></a></span><span> </span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#PhiSem_Mem_C_Base.Map_of_Val|const"><span>Map_of_Val</span></a><span> </span><span class="free"><span>u_idx</span></span><span class="main"><span>)</span></span><span class="main"><span>}</span></span><span>
    </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.subset_eq|const"><span>⊆</span></a></span><span> </span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#PhiSem_Mem_C_Base.Map_of_Val_ins|const"><span>Map_of_Val_ins</span></a><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.image|const"><span>`</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Option.html#Option.option.Some|const"><span>Some</span></a><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.image|const"><span>`</span></a></span><span> </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Algebras.Algebras.html#Algebras.discrete.discrete|const"><span>discrete</span></a><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.image|const"><span>`</span></a></span><span> </span><span class="main"><span>{</span></span><span class="bound"><span>a</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="../Phi_Semantics/PhiSem_Aggregate_Base.html#PhiSem_Aggregate_Base.index_value|const"><span>index_value</span></a><span> </span><span class="free"><span>idx</span></span><span> </span><span class="bound"><span>a</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="free"><span>u_idx</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="bound"><span>a</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span> </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Semantics_Framework.html#Phi_Semantics_Framework.Well_Type|const"><span>Well_Type</span></a><span> </span><span class="free"><span>TY</span></span><span class="main"><span>}</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.UNIV|const"><span>UNIV</span></a><span>›</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.clarsimp|method"><span class="operator"><span>clarsimp</span></span></a><span> </span><span class="quasi_keyword"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.image_iff|fact"><span>image_iff</span></a><span> </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Algebras.Algebras.html#Algebras.set_mult_expn|fact"><span>set_mult_expn</span></a><span> </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Algebras.Phi_Fiction.html#Phi_Fiction.refinement_projection_def|fact"><span>refinement_projection_def</span></a><span>
                            </span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#PhiSem_Mem_C_Base.Map_of_Val_ins_dom_def|fact"><span>Map_of_Val_ins_dom_def</span></a><span> </span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#PhiSem_Mem_C_Base.Map_of_Val_ins_def|fact"><span>Map_of_Val_ins_def</span></a><span class="main"><span class="keyword3"><span>;</span></span></span><span>
         </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Tools/induct_tacs.ML.html#HOL.case_tac|method"><span class="operator"><span>case_tac</span></span></a><span> </span><span class="quoted"><span class="improper"><span>xb</span></span></span><span class="main"><span class="keyword3"><span>;</span></span></span><span> </span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Algebras.Algebras.html#Algebras.split_discrete_meta_all|fact"><span>split_discrete_meta_all</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/HOL/Tools/SMT/smt_systems.ML.html#SMT.smt|method"><span class="operator"><span>smt</span></span></a><span> </span><span class="main"><span class="main"><span>(</span></span></span><span>verit</span><span class="main"><span class="main"><span>,</span></span></span><span> best</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#PhiSem_Mem_C_Base.Mapof_not_1|fact"><span>Mapof_not_1</span></a><span> </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Algebras.Algebras.html#Algebras.dom_1|fact"><span>dom_1</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Map.html#Map.dom_eq_empty_conv|fact"><span>dom_eq_empty_conv</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Map.html#Map.dom_map_option_comp|fact"><span>dom_map_option_comp</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/HOL/Tools/Metis/metis_tactic.ML.html#Metis.metis|method"><span class="operator"><span>metis</span></span></a><span> </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Algebras.Algebras.html#Algebras.mult_1_class.mult_1_right|fact"><span>mult_1_class.mult_1_right</span></a><span> </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Algebras.Algebras.html#Algebras.comm_sep_disj_class.sep_disj_commuteI|fact"><span>sep_disj_commuteI</span></a><span> </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Algebras.Algebras.html#Algebras.sep_magma_1_class.sep_magma_1_left|fact"><span>sep_magma_1_left</span></a><span> </span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#PhiSem_Mem_C_Base.val_map_eq_index_value_eq|fact"><span>val_map_eq_index_value_eq</span></a><span class="main"><span>)</span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="PhiSem_Mem_C_Base.fiction_Map_of_Val_ins_projection|fact"><span class="entity_def" id="PhiSem_Mem_C_Base.fiction_Map_of_Val_ins_projection|thm"><span>fiction_Map_of_Val_ins_projection</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="quoted"><span class="quoted"><span>‹ </span><a class="entity_ref" href="../Phi_Semantics/PhiSem_Aggregate_Base.html#PhiSem_Aggregate_Base.valid_index|const"><span>valid_index</span></a><span> </span><span class="free"><span>TY</span></span><span> </span><span class="free"><span>idx</span></span><span>
</span><span class="main"><span>⟹</span></span><span> </span><span class="free"><span>u_idx</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span> </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Semantics_Framework.html#Phi_Semantics_Framework.Well_Type|const"><span>Well_Type</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Phi_Semantics/PhiSem_Aggregate_Base.html#PhiSem_Aggregate_Base.index_type|const"><span>index_type</span></a><span> </span><span class="free"><span>idx</span></span><span> </span><span class="free"><span>TY</span></span><span class="main"><span>)</span></span><span>
</span><span class="main"><span>⟹</span></span><span> </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Algebras.Phi_Fiction.html#Phi_Fiction.refinement_projection|const"><span>refinement_projection</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Algebras.Phi_Fiction.html#Phi_Fiction.\&lt;F&gt;_functional|const"><span>ℱ_functional</span></a><span> </span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#PhiSem_Mem_C_Base.Map_of_Val_ins|const"><span>Map_of_Val_ins</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#PhiSem_Mem_C_Base.Map_of_Val_ins_dom|const"><span>Map_of_Val_ins_dom</span></a><span> </span><span class="free"><span>TY</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>
                          </span><span class="main"><span>{</span></span><span class="free"><span>idx</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../Phi_System/Phi_Algebras.Map_of_Tree.html#Map_of_Tree.push_map|const"><span>‣<span class="hidden">⇩</span><sub>m</sub></span></a></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/Option.html#Option.option.map_option|const"><span>map_option</span></a><span> </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Algebras.Algebras.html#Algebras.discrete.discrete|const"><span>discrete</span></a><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Fun.html#Fun.comp|const"><span>∘</span></a></span><span> </span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#PhiSem_Mem_C_Base.Map_of_Val|const"><span>Map_of_Val</span></a><span> </span><span class="free"><span>u_idx</span></span><span class="main"><span>)</span></span><span class="main"><span>}</span></span><span>
      </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.subset_eq|const"><span>⊆</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Option.html#Option.option.Some|const"><span>Some</span></a><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.image|const"><span>`</span></a></span><span> </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Algebras.Algebras.html#Algebras.discrete.discrete|const"><span>discrete</span></a><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.image|const"><span>`</span></a></span><span> </span><span class="main"><span>{</span></span><span class="bound"><span>a</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="../Phi_Semantics/PhiSem_Aggregate_Base.html#PhiSem_Aggregate_Base.index_value|const"><span>index_value</span></a><span> </span><span class="free"><span>idx</span></span><span> </span><span class="bound"><span>a</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="free"><span>u_idx</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="bound"><span>a</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span> </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Semantics_Framework.html#Phi_Semantics_Framework.Well_Type|const"><span>Well_Type</span></a><span> </span><span class="free"><span>TY</span></span><span> </span><span class="main"><span>}</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.UNIV|const"><span>UNIV</span></a><span>›</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Tools/eqsubst.ML.html#HOL.subst|method"><span class="operator"><span>subst</span></span></a><span> </span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#PhiSem_Mem_C_Base.fiction_Map_of_Val_ins_comp_id_simp|fact"><span>fiction_Map_of_Val_ins_comp_id_simp</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>symmetric</span></span><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/classical.ML.html#HOL.rule|method"><span class="operator"><span>rule</span></span></a><span> </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Algebras.Phi_Fiction.html#Phi_Fiction.refinement_projections_stepwise_UNIV_paired|fact"><span>refinement_projections_stepwise_UNIV_paired</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/classical.ML.html#HOL.rule|method"><span class="operator"><span>rule</span></span></a><span> </span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#PhiSem_Mem_C_Base.Map_of_Val_ins.\&lt;F&gt;_functional_projection|fact"><span>Map_of_Val_ins.ℱ_functional_projection</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.clarsimp|method"><span class="operator"><span>clarsimp</span></span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>insert</span></span><span> </span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#PhiSem_Mem_C_Base.val_map_mod_index_value_projection|fact"><span>val_map_mod_index_value_projection</span></a><span class="main"><span>)</span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="PhiSem_Mem_C_Base.fiction_Map_of_Val_ins_projection&apos;|fact"><span class="entity_def" id="PhiSem_Mem_C_Base.fiction_Map_of_Val_ins_projection&apos;|thm"><span>fiction_Map_of_Val_ins_projection'</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="quoted"><span class="quoted"><span>‹ </span><a class="entity_ref" href="../Phi_Semantics/PhiSem_Aggregate_Base.html#PhiSem_Aggregate_Base.valid_index|const"><span>valid_index</span></a><span> </span><span class="free"><span>TY</span></span><span> </span><span class="free"><span>idx</span></span><span>
</span><span class="main"><span>⟹</span></span><span> </span><span class="free"><span>u_idx</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span> </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Semantics_Framework.html#Phi_Semantics_Framework.Well_Type|const"><span>Well_Type</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Phi_Semantics/PhiSem_Aggregate_Base.html#PhiSem_Aggregate_Base.index_type|const"><span>index_type</span></a><span> </span><span class="free"><span>idx</span></span><span> </span><span class="free"><span>TY</span></span><span class="main"><span>)</span></span><span>
</span><span class="main"><span>⟹</span></span><span> </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Algebras.Phi_Fiction.html#Phi_Fiction.refinement_projection|const"><span>refinement_projection</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Algebras.Phi_Fiction.html#Phi_Fiction.\&lt;F&gt;_functional|const"><span>ℱ_functional</span></a><span> </span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#PhiSem_Mem_C_Base.Map_of_Val_ins|const"><span>Map_of_Val_ins</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#PhiSem_Mem_C_Base.Map_of_Val_ins_dom|const"><span>Map_of_Val_ins_dom</span></a><span> </span><span class="free"><span>TY</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>
                          </span><span class="main"><span>{</span></span><span class="free"><span>idx</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../Phi_System/Phi_Algebras.Map_of_Tree.html#Map_of_Tree.push_map|const"><span>‣<span class="hidden">⇩</span><sub>m</sub></span></a></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/Option.html#Option.option.map_option|const"><span>map_option</span></a><span> </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Algebras.Algebras.html#Algebras.discrete.discrete|const"><span>discrete</span></a><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Fun.html#Fun.comp|const"><span>∘</span></a></span><span> </span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#PhiSem_Mem_C_Base.Map_of_Val|const"><span>Map_of_Val</span></a><span> </span><span class="free"><span>u_idx</span></span><span class="main"><span>)</span></span><span class="main"><span>}</span></span><span>
      </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.subset_eq|const"><span>⊆</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Option.html#Option.option.Some|const"><span>Some</span></a><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.image|const"><span>`</span></a></span><span> </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Algebras.Algebras.html#Algebras.discrete.discrete|const"><span>discrete</span></a><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.image|const"><span>`</span></a></span><span> </span><span class="main"><span>{</span></span><span class="bound"><span>a</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="../Phi_Semantics/PhiSem_Aggregate_Base.html#PhiSem_Aggregate_Base.index_value|const"><span>index_value</span></a><span> </span><span class="free"><span>idx</span></span><span> </span><span class="bound"><span>a</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="free"><span>u_idx</span></span><span> </span><span class="main"><span>}</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.UNIV|const"><span>UNIV</span></a><span>›</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>premises</span></span></span><span> </span><span class="entity_def" id="offset_17665..17670">prems</span><span> </span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
    </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>‹ </span><a class="entity_ref" href="../../HOL/HOL/Option.html#Option.option.Some|const"><span>Some</span></a><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.image|const"><span>`</span></a></span><span> </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Algebras.Algebras.html#Algebras.discrete.discrete|const"><span>discrete</span></a><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.image|const"><span>`</span></a></span><span> </span><span class="main"><span>{</span></span><span class="bound"><span>a</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="../Phi_Semantics/PhiSem_Aggregate_Base.html#PhiSem_Aggregate_Base.index_value|const"><span>index_value</span></a><span> </span><span class="free"><span>idx</span></span><span> </span><span class="bound"><span>a</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="free"><span>u_idx</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="bound"><span>a</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span> </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Semantics_Framework.html#Phi_Semantics_Framework.Well_Type|const"><span>Well_Type</span></a><span> </span><span class="free"><span>TY</span></span><span> </span><span class="main"><span>}</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.UNIV|const"><span>UNIV</span></a><span>
         </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.subset_eq|const"><span>⊆</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Option.html#Option.option.Some|const"><span>Some</span></a><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.image|const"><span>`</span></a></span><span> </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Algebras.Algebras.html#Algebras.discrete.discrete|const"><span>discrete</span></a><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.image|const"><span>`</span></a></span><span> </span><span class="main"><span>{</span></span><span class="bound"><span>a</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="../Phi_Semantics/PhiSem_Aggregate_Base.html#PhiSem_Aggregate_Base.index_value|const"><span>index_value</span></a><span> </span><span class="free"><span>idx</span></span><span> </span><span class="bound"><span>a</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="free"><span>u_idx</span></span><span> </span><span class="main"><span>}</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.UNIV|const"><span>UNIV</span></a><span> ›</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.Collect_mono_iff|fact"><span>Collect_mono_iff</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.image_mono|fact"><span>image_mono</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#PhiSem_Mem_C_Base.fiction_Map_of_Val_ins_projection|fact"><span>fiction_Map_of_Val_ins_projection</span></a><span> </span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#offset_17665..17670"><span>prems</span></a><span class="main"><span>(</span></span><span>1</span><span class="main"><span>)</span></span><span> </span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#offset_17665..17670"><span>prems</span></a><span class="main"><span>(</span></span><span>2</span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/blast.ML.html#HOL.blast|method"><span class="operator"><span>blast</span></span></a><span>
  </span><span class="keyword1"><span class="command"><span>qed</span></span></span><span> </span><span class="keyword1"><span class="command"><span>.</span></span></span><span>


</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="PhiSem_Mem_C_Base.fiction_Map_of_Val_ins_refinement|fact"><span class="entity_def" id="PhiSem_Mem_C_Base.fiction_Map_of_Val_ins_refinement|thm"><span>fiction_Map_of_Val_ins_refinement</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="quoted"><span class="quoted"><span>‹ </span><a class="entity_ref" href="../Phi_Semantics/PhiSem_Aggregate_Base.html#PhiSem_Aggregate_Base.valid_index|const"><span>valid_index</span></a><span> </span><span class="free"><span>TY</span></span><span> </span><span class="free"><span>idx</span></span><span>
</span><span class="main"><span>⟹</span></span><span> </span><span class="free"><span>v</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span> </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Semantics_Framework.html#Phi_Semantics_Framework.Well_Type|const"><span>Well_Type</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Phi_Semantics/PhiSem_Aggregate_Base.html#PhiSem_Aggregate_Base.index_type|const"><span>index_type</span></a><span> </span><span class="free"><span>idx</span></span><span> </span><span class="free"><span>TY</span></span><span class="main"><span>)</span></span><span>
</span><span class="main"><span>⟹</span></span><span> </span><span class="free"><span>u_idx</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span> </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Semantics_Framework.html#Phi_Semantics_Framework.Well_Type|const"><span>Well_Type</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Phi_Semantics/PhiSem_Aggregate_Base.html#PhiSem_Aggregate_Base.index_type|const"><span>index_type</span></a><span> </span><span class="free"><span>idx</span></span><span> </span><span class="free"><span>TY</span></span><span class="main"><span>)</span></span><span>
</span><span class="main"><span>⟹</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>∀</span></span><span class="bound"><span>x</span></span><span> </span><span class="main"><span>∈</span></span><span> </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Semantics_Framework.html#Phi_Semantics_Framework.Well_Type|const"><span>Well_Type</span></a><span> </span><span class="free"><span>TY</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="../Phi_Semantics/PhiSem_Aggregate_Base.html#PhiSem_Aggregate_Base.index_mod_value|const"><span>index_mod_value</span></a><span> </span><span class="free"><span>cidx</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="main"><span class="bound"><span>_</span></span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>v</span></span><span class="main"><span>)</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="../Phi_Semantics/PhiSem_Aggregate_Base.html#PhiSem_Aggregate_Base.index_mod_value|const"><span>index_mod_value</span></a><span> </span><span class="free"><span>idx</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="main"><span class="bound"><span>_</span></span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>v</span></span><span class="main"><span>)</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><span>)</span></span><span>
</span><span class="main"><span>⟹</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>{</span></span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/Option.html#Option.option.Some|const"><span>Some</span></a><span> </span><span class="bound"><span>u</span></span><span class="main"><span>,</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/Option.html#Option.option.Some|const"><span>Some</span></a><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/Fun.html#Fun.comp|const"><span>o</span></a></span><span> </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Algebras.Algebras.html#Algebras.discrete.map_discrete|const"><span>map_discrete</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Phi_Semantics/PhiSem_Aggregate_Base.html#PhiSem_Aggregate_Base.index_mod_value|const"><span>index_mod_value</span></a><span> </span><span class="free"><span>cidx</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="main"><span class="bound"><span>_</span></span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>v</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="bound"><span>u</span></span><span class="main"><span>)</span></span><span class="main"><span>}</span></span><span>
          </span><span class="keyword1"><span>𝗌𝗎𝖻𝗃</span></span><span> </span><span class="bound"><span>u</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>u</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span> </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Algebras.Algebras.html#Algebras.discrete.discrete|const"><span>discrete</span></a><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.image|const"><span>`</span></a></span><span> </span><span class="main"><span>{</span></span><span class="bound"><span>a</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="../Phi_Semantics/PhiSem_Aggregate_Base.html#PhiSem_Aggregate_Base.index_value|const"><span>index_value</span></a><span> </span><span class="free"><span>idx</span></span><span> </span><span class="bound"><span>a</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="free"><span>u_idx</span></span><span class="main"><span>}</span></span><span>
            </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="bound"><span>u</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span> </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Algebras.Algebras.html#Algebras.discrete.discrete|const"><span>discrete</span></a><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.image|const"><span>`</span></a></span><span> </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Semantics_Framework.html#Phi_Semantics_Framework.Well_Type|const"><span>Well_Type</span></a><span> </span><span class="free"><span>TY</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Relation.html#Relation.Id_on|const"><span>Id_on</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.UNIV|const"><span>UNIV</span></a><span>
    </span><span class="keyword1"><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Algebras.Phi_Fiction.html#Phi_Fiction.Fictional_Forward_Simulation|const"><span>𝗋𝖾𝖿𝗂𝗇𝖾𝗌</span></a></span><span> </span><span class="main"><span>{</span></span><span class="main"><span>(</span></span><span class="free"><span>idx</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../Phi_System/Phi_Algebras.Map_of_Tree.html#Map_of_Tree.push_map|const"><span>‣<span class="hidden">⇩</span><sub>m</sub></span></a></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/Option.html#Option.option.map_option|const"><span>map_option</span></a><span> </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Algebras.Algebras.html#Algebras.discrete.discrete|const"><span>discrete</span></a><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Fun.html#Fun.comp|const"><span>∘</span></a></span><span> </span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#PhiSem_Mem_C_Base.Map_of_Val|const"><span>Map_of_Val</span></a><span> </span><span class="free"><span>u_idx</span></span><span class="main"><span>)</span></span><span class="main"><span>,</span></span><span>
            </span><span class="free"><span>idx</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../Phi_System/Phi_Algebras.Map_of_Tree.html#Map_of_Tree.push_map|const"><span>‣<span class="hidden">⇩</span><sub>m</sub></span></a></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/Option.html#Option.option.map_option|const"><span>map_option</span></a><span> </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Algebras.Algebras.html#Algebras.discrete.discrete|const"><span>discrete</span></a><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Fun.html#Fun.comp|const"><span>∘</span></a></span><span> </span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#PhiSem_Mem_C_Base.Map_of_Val|const"><span>Map_of_Val</span></a><span> </span><span class="free"><span>v</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>}</span></span><span>
    </span><span class="keyword1"><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Algebras.Phi_Fiction.html#Phi_Fiction.Fictional_Forward_Simulation|const"><span>𝗐.𝗋.𝗍</span></a></span><span> </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Algebras.Phi_Fiction.html#Phi_Fiction.\&lt;F&gt;_functional|const"><span>ℱ_functional</span></a><span> </span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#PhiSem_Mem_C_Base.Map_of_Val_ins|const"><span>Map_of_Val_ins</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#PhiSem_Mem_C_Base.Map_of_Val_ins_dom|const"><span>Map_of_Val_ins_dom</span></a><span> </span><span class="free"><span>TY</span></span><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Algebras.Phi_Fiction.html#Phi_Fiction.Fictional_Forward_Simulation|const"><span>𝗂𝗇</span></a></span><span> </span><span class="main"><span>{</span></span><span class="free"><span>idx</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../Phi_System/Phi_Algebras.Map_of_Tree.html#Map_of_Tree.push_map|const"><span>‣<span class="hidden">⇩</span><sub>m</sub></span></a></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/Option.html#Option.option.map_option|const"><span>map_option</span></a><span> </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Algebras.Algebras.html#Algebras.discrete.discrete|const"><span>discrete</span></a><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Fun.html#Fun.comp|const"><span>∘</span></a></span><span> </span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#PhiSem_Mem_C_Base.Map_of_Val|const"><span>Map_of_Val</span></a><span> </span><span class="free"><span>u_idx</span></span><span class="main"><span>)</span></span><span class="main"><span>}</span></span><span>›</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Tools/eqsubst.ML.html#HOL.subst|method"><span class="operator"><span>subst</span></span></a><span> </span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#PhiSem_Mem_C_Base.fiction_Map_of_Val_ins_comp_id_simp|fact"><span>fiction_Map_of_Val_ins_comp_id_simp</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>symmetric</span></span><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/classical.ML.html#HOL.rule|method"><span class="operator"><span>rule</span></span></a><span> </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Algebras.Phi_Fiction.html#Phi_Fiction.sep_refinement_stepwise|fact"><span>sep_refinement_stepwise</span></a><span class="main"><span class="main"><span>[</span></span></span><span>
            </span><span class="operator"><span>OF</span></span><span> </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Algebras.Phi_Fiction.html#Phi_Fiction.refinement_frame|fact"><span>refinement_frame</span></a><span class="main"><span class="main"><span class="main"><span>[</span></span></span></span><span class="keyword2"><span class="keyword"><a class="entity_ref" href="../Phi_System/ISABELLE_HOME/src/HOL/Eisbach/eisbach_rule_insts.ML.html#Eisbach.where|attribute"><span class="operator"><span>where</span></span></a></span></span><span> R </span><span class="main"><span class="main"><span class="main"><span class="main"><span>=</span></span></span></span></span><span> </span><span class="quoted"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.UNIV|const"><span>UNIV</span></a></span><span class="main"><span class="main"><span class="main"><span>,</span></span></span></span><span> </span><span class="operator"><span>OF</span></span><span> </span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#PhiSem_Mem_C_Base.Map_of_Val_ins.\&lt;F&gt;_functional_refinement_complex|fact"><span>Map_of_Val_ins.ℱ_functional_refinement_complex</span></a><span class="main"><span class="main"><span class="main"><span>[</span></span></span></span><span class="operator"><span>simplified</span></span><span class="main"><span class="main"><span class="main"><span>]</span></span></span></span><span class="main"><span class="main"><span class="main"><span>]</span></span></span></span><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Algebras.Phi_Spec_Pre.html#Phi_Spec_Pre.ExSet_expn_set|fact"><span>ExSet_expn_set</span></a><span> </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Algebras.Phi_Spec_Pre.html#Phi_Spec_Pre.Subjection_expn_set|fact"><span>Subjection_expn_set</span></a><span> </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Algebras.Algebras.html#Algebras.split_discrete_ex|fact"><span>split_discrete_ex</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Fun.html#Fun.inj_image_mem_iff|fact"><span>inj_image_mem_iff</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Option.html#Option.split_option_all|fact"><span>split_option_all</span></a><span>
                   </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Algebras.Algebras.html#Algebras.split_discrete_all|fact"><span>split_discrete_all</span></a><span> </span><a class="entity_ref" href="../Phi_Semantics/PhiSem_Aggregate_Base.html#PhiSem_Aggregate_Base.index_mod_value_welltyp|fact"><span>index_mod_value_welltyp</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Algebras.Phi_Fiction.html#Phi_Fiction.frame_preserving_relation_def|fact"><span>frame_preserving_relation_def</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Option.html#Option.split_option_all|fact"><span>split_option_all</span></a><span> </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Algebras.Algebras.html#Algebras.split_discrete_all|fact"><span>split_discrete_all</span></a><span>
                   </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Algebras.Phi_Spec_Pre.html#Phi_Spec_Pre.ExSet_expn_set|fact"><span>ExSet_expn_set</span></a><span> </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Algebras.Phi_Spec_Pre.html#Phi_Spec_Pre.Subjection_expn_set|fact"><span>Subjection_expn_set</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Algebras.Phi_Algebra_Set.html#Phi_Algebra_Set.Sep_Closed_def|fact"><span>Sep_Closed_def</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>premises</span></span></span><span> </span><span class="entity_def" id="offset_19230..19235">prems</span><span> </span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
    </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_19253..19255">t1</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>‹</span><span class="skolem"><span>A</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.subset_eq|const"><span>⊆</span></a></span><span> </span><span class="skolem"><span>A'</span></span><span> </span><span class="main"><span>⟹</span></span><span> </span><span class="skolem"><span>A</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><span class="skolem"><span>B</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.subset_eq|const"><span>⊆</span></a></span><span> </span><span class="skolem"><span>A'</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><span class="skolem"><span>B</span></span><span>›</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>for</span></span></span><span> </span><span class="skolem"><span>A</span></span><span> </span><span class="skolem"><span>A'</span></span><span> </span><span class="skolem"><span>B</span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.clarsimp|method"><span class="operator"><span>clarsimp</span></span></a><span> </span><span class="quasi_keyword"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.subset_iff|fact"><span>subset_iff</span></a><span> </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Algebras.Algebras.html#Algebras.set_mult_expn|fact"><span>set_mult_expn</span></a><span class="main"><span class="keyword3"><span>;</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/blast.ML.html#HOL.blast|method"><span class="operator"><span>blast</span></span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>‹</span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Algebras.Phi_Fiction.html#Phi_Fiction.pairself|const"><span>pairself</span></a><span> </span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#PhiSem_Mem_C_Base.Map_of_Val_ins|const"><span>Map_of_Val_ins</span></a><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.image|const"><span>`</span></a></span><span>
            </span><span class="main"><span>(</span></span><span class="main"><span>{</span></span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/Option.html#Option.option.Some|const"><span>Some</span></a><span> </span><span class="bound"><span>u</span></span><span class="main"><span>,</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/Option.html#Option.option.Some|const"><span>Some</span></a><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Fun.html#Fun.comp|const"><span>∘</span></a></span><span> </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Algebras.Algebras.html#Algebras.discrete.map_discrete|const"><span>map_discrete</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Phi_Semantics/PhiSem_Aggregate_Base.html#PhiSem_Aggregate_Base.index_mod_value|const"><span>index_mod_value</span></a><span> </span><span class="free"><span>cidx</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="main"><span class="bound"><span>_</span></span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>v</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="bound"><span>u</span></span><span class="main"><span>)</span></span><span class="main"><span>}</span></span><span> </span><span class="keyword1"><span>𝗌𝗎𝖻𝗃</span></span><span> </span><span class="bound"><span>u</span></span><span class="main"><span>.</span></span><span>
             </span><span class="bound"><span>u</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span> </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Algebras.Algebras.html#Algebras.discrete.discrete|const"><span>discrete</span></a><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.image|const"><span>`</span></a></span><span> </span><span class="main"><span>{</span></span><span class="bound"><span>a</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="../Phi_Semantics/PhiSem_Aggregate_Base.html#PhiSem_Aggregate_Base.index_value|const"><span>index_value</span></a><span> </span><span class="free"><span>idx</span></span><span> </span><span class="bound"><span>a</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="free"><span>u_idx</span></span><span class="main"><span>}</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="bound"><span>u</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span> </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Algebras.Algebras.html#Algebras.discrete.discrete|const"><span>discrete</span></a><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.image|const"><span>`</span></a></span><span> </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Semantics_Framework.html#Phi_Semantics_Framework.Well_Type|const"><span>Well_Type</span></a><span> </span><span class="free"><span>TY</span></span><span class="main"><span>)</span></span><span>
        </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.subset_eq|const"><span>⊆</span></a></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>{</span></span><span class="main"><span>(</span></span><span class="bound"><span>a</span></span><span class="main"><span>,</span></span><span> </span><span class="bound"><span>a</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Map.html#Map.map_add|const"><span>++</span></a></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>idx</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../Phi_System/Phi_Algebras.Map_of_Tree.html#Map_of_Tree.push_map|const"><span>‣<span class="hidden">⇩</span><sub>m</sub></span></a></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/Option.html#Option.option.map_option|const"><span>map_option</span></a><span> </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Algebras.Algebras.html#Algebras.discrete.discrete|const"><span>discrete</span></a><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Fun.html#Fun.comp|const"><span>∘</span></a></span><span> </span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#PhiSem_Mem_C_Base.Map_of_Val|const"><span>Map_of_Val</span></a><span> </span><span class="free"><span>v</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>}</span></span><span> </span><span class="keyword1"><span>𝗌𝗎𝖻𝗃</span></span><span> </span><span class="bound"><span>a</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Map.html#Map.dom|const"><span>dom</span></a><span> </span><span class="bound"><span>a</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#PhiSem_Mem_C_Base.Dom_of_TY|const"><span>Dom_of_TY</span></a><span> </span><span class="free"><span>TY</span></span><span class="main"><span>)</span></span><span>›</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.clarsimp|method"><span class="operator"><span>clarsimp</span></span></a><span> </span><span class="quasi_keyword"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.set_eq_iff|fact"><span>set_eq_iff</span></a><span> </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Algebras.Phi_Spec_Pre.html#Phi_Spec_Pre.ExSet_image|fact"><span>ExSet_image</span></a><span> </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Algebras.Phi_Spec_Pre.html#Phi_Spec_Pre.Subjection_image|fact"><span>Subjection_image</span></a><span class="main"><span class="keyword3"><span>;</span></span></span><span>
             </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span> </span><span class="quasi_keyword"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>‹</span><span class="main"><span>∀</span></span><span class="bound"><span>x</span></span><span class="main"><span>∈</span></span><span class="main"><span>_</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><span>_</span></span><span>›</span></span></span><span> </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Algebras.Phi_Spec_Pre.html#Phi_Spec_Pre.ExSet_expn_set|fact"><span>ExSet_expn_set</span></a><span> </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Algebras.Phi_Spec_Pre.html#Phi_Spec_Pre.Subjection_expn_set|fact"><span>Subjection_expn_set</span></a><span> </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Algebras.Algebras.html#Algebras.split_discrete_ex|fact"><span>split_discrete_ex</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Fun.html#Fun.inj_image_mem_iff|fact"><span>inj_image_mem_iff</span></a><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/HOL/Tools/Metis/metis_tactic.ML.html#Metis.metis|method"><span class="operator"><span>metis</span></span></a><span> </span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#PhiSem_Mem_C_Base.Map_of_Val_mod|fact"><span>Map_of_Val_mod</span></a><span> </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Algebras.Algebras.html#Algebras.map_option_funcomp_map_add|fact"><span>map_option_funcomp_map_add</span></a><span> </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Algebras.Algebras.html#Algebras.homo_one_map_option|fact"><span>homo_one_map_option</span></a><span> </span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#offset_19230..19235"><span>prems</span></a><span class="main"><span class="main"><span>(</span></span></span><span>1</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#offset_19230..19235"><span>prems</span></a><span class="main"><span class="main"><span>(</span></span></span><span>2</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><a class="entity_ref" href="../Phi_System/Phi_Algebras.Map_of_Tree.html#Map_of_Tree.push_map_homo|fact"><span>push_map_homo</span></a><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#PhiSem_Mem_C_Base.Map_of_Val_dom|fact"><span>Map_of_Val_dom</span></a><span> </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/blast.ML.html#HOL.blast|method"><span class="operator"><span>blast</span></span></a><span>
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#PhiSem_Mem_C_Base.Map_of_Val_dom|fact"><span>Map_of_Val_dom</span></a><span> </span><span class="keyword1"><span class="command"><span class="entity_def" id="offset_20034..20036">by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/blast.ML.html#HOL.blast|method"><span class="operator"><span>blast</span></span></a><span>
    </span><span class="keyword1"><span class="command"><span>note</span></span></span><span> </span><span class="entity_def" id="offset_20052..20054">t2</span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#offset_20034..20036"><span>this</span></a><span class="main"><span>[</span></span><span class="operator"><span>THEN</span></span><span> </span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#offset_19253..19255"><span>t1</span></a><span class="main"><span>,</span></span><span> </span><span class="operator"><span>THEN</span></span><span> </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Algebras.Phi_Fiction.html#Phi_Fiction.refinement_sub_fun|fact"><span>refinement_sub_fun</span></a><span class="main"><span>]</span></span><span>
    </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_20105..20107">t3</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>‹</span><a class="entity_ref" href="../../HOL/HOL/Map.html#Map.dom|const"><span>dom</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#PhiSem_Mem_C_Base.Map_of_Val|const"><span>Map_of_Val</span></a><span> </span><span class="free"><span>v</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#PhiSem_Mem_C_Base.Dom_of_TY|const"><span>Dom_of_TY</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Phi_Semantics/PhiSem_Aggregate_Base.html#PhiSem_Aggregate_Base.index_type|const"><span>index_type</span></a><span> </span><span class="free"><span>idx</span></span><span> </span><span class="free"><span>TY</span></span><span class="main"><span>)</span></span><span>›</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#PhiSem_Mem_C_Base.Map_of_Val_dom|fact"><span>Map_of_Val_dom</span></a><span> </span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#offset_19230..19235"><span>prems</span></a><span class="main"><span>(</span></span><span>2</span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.force|method"><span class="operator"><span>force</span></span></a><span>
    </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_20216..20218">t4</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>‹</span><span class="free"><span>idx</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../Phi_System/Phi_Algebras.Map_of_Tree.html#Map_of_Tree.push_map|const"><span>‣<span class="hidden">⇩</span><sub>m</sub></span></a></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/Option.html#Option.option.map_option|const"><span>map_option</span></a><span> </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Algebras.Algebras.html#Algebras.discrete.discrete|const"><span>discrete</span></a><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Fun.html#Fun.comp|const"><span>∘</span></a></span><span> </span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#PhiSem_Mem_C_Base.Map_of_Val|const"><span>Map_of_Val</span></a><span> </span><span class="free"><span>u_idx</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.not_equal|const"><span>≠</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span>›</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/HOL/Tools/Metis/metis_tactic.ML.html#Metis.metis|method"><span class="operator"><span>metis</span></span></a><span> </span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#PhiSem_Mem_C_Base.Map_of_Val_ins_None|fact"><span>Map_of_Val_ins_None</span></a><span> </span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#PhiSem_Mem_C_Base.Map_of_Val_ins_dom_eval|fact"><span>Map_of_Val_ins_dom_eval</span></a><span> </span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#PhiSem_Mem_C_Base.Map_of_Val_ins_eval|fact"><span>Map_of_Val_ins_eval</span></a><span class="main"><span class="main"><span>(</span></span></span><span>1</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Option.html#Option.option.distinct|fact"><span>option.distinct</span></a><span class="main"><span class="main"><span>(</span></span></span><span>1</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#offset_19230..19235"><span>prems</span></a><span class="main"><span class="main"><span>(</span></span></span><span>3</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><a class="entity_ref" href="../Phi_System/Phi_Algebras.Map_of_Tree.html#Map_of_Tree.push_map_eq_1|fact"><span>push_map_eq_1</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>then</span></span></span><span> </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_20415..20417">t5</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>‹ </span><span class="free"><span>idx</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../Phi_System/Phi_Algebras.Map_of_Tree.html#Map_of_Tree.push_map|const"><span>‣<span class="hidden">⇩</span><sub>m</sub></span></a></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/Option.html#Option.option.map_option|const"><span>map_option</span></a><span> </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Algebras.Algebras.html#Algebras.discrete.discrete|const"><span>discrete</span></a><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Fun.html#Fun.comp|const"><span>∘</span></a></span><span> </span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#PhiSem_Mem_C_Base.Map_of_Val|const"><span>Map_of_Val</span></a><span> </span><span class="free"><span>u_idx</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><span class="skolem"><span>r</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.not_equal|const"><span>≠</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span>›</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>for</span></span></span><span> </span><span class="skolem"><span>r</span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/HOL/Tools/Metis/metis_tactic.ML.html#Metis.metis|method"><span class="operator"><span>metis</span></span></a><span> </span><span class="main"><span class="main"><span>(</span></span></span><span>no_types</span><span class="main"><span class="main"><span>,</span></span></span><span> opaque_lifting</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Algebras.Algebras.html#Algebras.dom1_disjoint_sep_disj|fact"><span>dom1_disjoint_sep_disj</span></a><span> </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Algebras.Algebras.html#Algebras.dom1_dom|fact"><span>dom1_dom</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Map.html#Map.dom_eq_empty_conv|fact"><span>dom_eq_empty_conv</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.empty_subsetI|fact"><span>empty_subsetI</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Lattices.html#Lattices.semilattice_inf_class.inf.orderE|fact"><span>inf.orderE</span></a><span> </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Algebras.Algebras.html#Algebras.one_partial_map|fact"><span>one_partial_map</span></a><span> </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Algebras.Algebras.html#Algebras.sep_no_inverse_class.sep_no_inverse|fact"><span>sep_no_inverse</span></a><span> </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Algebras.Algebras.html#Algebras.times_fun_def|fact"><span>times_fun_def</span></a><span> </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Algebras.Algebras.html#Algebras.times_option_none|fact"><span>times_option_none</span></a><span class="main"><span>)</span></span><span>

    </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/classical.ML.html#HOL.rule|method"><span class="operator"><span>rule</span></span></a><span> </span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#offset_20052..20054"><span>t2</span></a><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/classical.ML.html#HOL.rule|method"><span class="operator"><span>rule</span></span></a><span> </span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#PhiSem_Mem_C_Base.map_tree_refinement_modify|fact"><span>map_tree_refinement_modify</span></a><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#PhiSem_Mem_C_Base.Dom_of_TY|fact"><span>Dom_of_TY</span></a><span> </span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#PhiSem_Mem_C_Base.Map_of_Val_dom|fact"><span>Map_of_Val_dom</span></a><span> </span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#offset_19230..19235"><span>prems</span></a><span class="main"><span class="main"><span>(</span></span></span><span>1</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#offset_19230..19235"><span>prems</span></a><span class="main"><span class="main"><span>(</span></span></span><span>3</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#offset_20105..20107"><span>t3</span></a><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#PhiSem_Mem_C_Base.Map_of_Val_ins_def|fact"><span>Map_of_Val_ins_def</span></a><span> </span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#PhiSem_Mem_C_Base.Map_of_Val_ins_dom_def|fact"><span>Map_of_Val_ins_dom_def</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.image_iff|fact"><span>image_iff</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Option.html#Option.split_option_ex|fact"><span>split_option_ex</span></a><span>
                       </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Algebras.Algebras.html#Algebras.split_discrete_ex|fact"><span>split_discrete_ex</span></a><span> </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Algebras.Algebras.html#Algebras.split_discrete_meta_all|fact"><span>split_discrete_meta_all</span></a><span> </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Algebras.Algebras.html#Algebras.split_discrete_all|fact"><span>split_discrete_all</span></a><span> </span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#offset_20415..20417"><span>t5</span></a><span class="main"><span>)</span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/HOL/Tools/SMT/smt_systems.ML.html#SMT.smt|method"><span class="operator"><span>smt</span></span></a><span> </span><span class="main"><span class="main"><span>(</span></span></span><span>verit</span><span class="main"><span class="main"><span>,</span></span></span><span> ccfv_threshold</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><a class="entity_ref" href="../Phi_Semantics/PhiSem_Aggregate_Base.html#PhiSem_Aggregate_Base.index_mod_value_welltyp|fact"><span>index_mod_value_welltyp</span></a><span> </span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#offset_19230..19235"><span>prems</span></a><span class="main"><span class="main"><span>(</span></span></span><span>1</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#offset_19230..19235"><span>prems</span></a><span class="main"><span class="main"><span>(</span></span></span><span>2</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#offset_19230..19235"><span>prems</span></a><span class="main"><span class="main"><span>(</span></span></span><span>3</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Algebras.Algebras.html#Algebras.comm_sep_disj_class.sep_disj_commuteI|fact"><span>sep_disj_commuteI</span></a><span> </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Algebras.Algebras.html#Algebras.sep_ab_semigroup_class.sep_mult_commute|fact"><span>sep_mult_commute</span></a><span> </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Algebras.Algebras.html#Algebras.sep_no_inverse_class.sep_no_inverse|fact"><span>sep_no_inverse</span></a><span> </span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#offset_20216..20218"><span>t4</span></a><span> </span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#PhiSem_Mem_C_Base.val_map_mod_index_value|fact"><span>val_map_mod_index_value</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>qed</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>premises</span></span></span><span> </span><span class="entity_def" id="offset_21194..21199">prems</span><span> </span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
    </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_21217..21219">t1</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>‹ </span><a class="entity_ref" href="../../HOL/HOL/Relation.html#Relation.Domain|const"><span>Domain</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>{</span></span><span class="main"><span>(</span></span><span class="skolem"><span>a</span></span><span> </span><span class="bound"><span>u</span></span><span class="main"><span>,</span></span><span> </span><span class="skolem"><span>b</span></span><span> </span><span class="bound"><span>u</span></span><span class="main"><span>)</span></span><span class="main"><span>}</span></span><span> </span><span class="keyword1"><span>𝗌𝗎𝖻𝗃</span></span><span> </span><span class="bound"><span>u</span></span><span class="main"><span>.</span></span><span> </span><span class="skolem"><span>P</span></span><span> </span><span class="bound"><span>u</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="main"><span>{</span></span><span> </span><span class="skolem"><span>a</span></span><span> </span><span class="bound"><span>u</span></span><span> </span><span class="main"><span>|</span></span><span class="bound"><span>u</span></span><span class="main"><span>.</span></span><span> </span><span class="skolem"><span>P</span></span><span> </span><span class="bound"><span>u</span></span><span> </span><span class="main"><span>}</span></span><span>›</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>for</span></span></span><span> </span><span class="skolem"><span>a</span></span><span> </span><span class="skolem"><span>b</span></span><span> </span><span class="skolem"><span>P</span></span><span>
      </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.set_eq_iff|fact"><span>set_eq_iff</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Relation.html#Relation.Domain_unfold|fact"><span>Domain_unfold</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.clarsimp|method"><span class="operator"><span>clarsimp</span></span></a><span> </span><span class="quasi_keyword"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Algebras.Phi_Spec_Pre.html#Phi_Spec_Pre.ExSet_expn_set|fact"><span>ExSet_expn_set</span></a><span> </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Algebras.Phi_Spec_Pre.html#Phi_Spec_Pre.Subjection_expn_set|fact"><span>Subjection_expn_set</span></a><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="entity_def" id="offset_21395..21397">t2</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>‹</span><span class="main"><span>{</span></span><a class="entity_ref" href="../../HOL/HOL/Option.html#Option.option.Some|const"><span>Some</span></a><span> </span><span class="bound"><span>u</span></span><span> </span><span class="main"><span>|</span></span><span class="bound"><span>u</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>u</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span> </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Algebras.Algebras.html#Algebras.discrete.discrete|const"><span>discrete</span></a><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.image|const"><span>`</span></a></span><span> </span><span class="main"><span>{</span></span><span class="bound"><span>a</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="../Phi_Semantics/PhiSem_Aggregate_Base.html#PhiSem_Aggregate_Base.index_value|const"><span>index_value</span></a><span> </span><span class="free"><span>idx</span></span><span> </span><span class="bound"><span>a</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="free"><span>u_idx</span></span><span class="main"><span>}</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="bound"><span>u</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span> </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Algebras.Algebras.html#Algebras.discrete.discrete|const"><span>discrete</span></a><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.image|const"><span>`</span></a></span><span> </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Semantics_Framework.html#Phi_Semantics_Framework.Well_Type|const"><span>Well_Type</span></a><span> </span><span class="free"><span>TY</span></span><span class="main"><span>}</span></span><span>
                </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Option.html#Option.option.Some|const"><span>Some</span></a><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.image|const"><span>`</span></a></span><span> </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Algebras.Algebras.html#Algebras.discrete.discrete|const"><span>discrete</span></a><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.image|const"><span>`</span></a></span><span> </span><span class="main"><span>{</span></span><span class="bound"><span>a</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="../Phi_Semantics/PhiSem_Aggregate_Base.html#PhiSem_Aggregate_Base.index_value|const"><span>index_value</span></a><span> </span><span class="free"><span>idx</span></span><span> </span><span class="bound"><span>a</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="free"><span>u_idx</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="bound"><span>a</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span> </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Semantics_Framework.html#Phi_Semantics_Framework.Well_Type|const"><span>Well_Type</span></a><span> </span><span class="free"><span>TY</span></span><span class="main"><span>}</span></span><span>›</span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.clarsimp|method"><span class="operator"><span>clarsimp</span></span></a><span> </span><span class="quasi_keyword"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.set_eq_iff|fact"><span>set_eq_iff</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.image_iff|fact"><span>image_iff</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.Bex_def|fact"><span>Bex_def</span></a><span class="main"><span class="keyword3"><span>;</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/blast.ML.html#HOL.blast|method"><span class="operator"><span>blast</span></span></a><span class="main"><span>)</span></span><span>

    </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span>
      </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Tools/eqsubst.ML.html#HOL.subst|method"><span class="operator"><span>subst</span></span></a><span> </span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#offset_21217..21219"><span>t1</span></a><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Tools/eqsubst.ML.html#HOL.subst|method"><span class="operator"><span>subst</span></span></a><span> </span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#offset_21395..21397"><span>t2</span></a><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/classical.ML.html#HOL.rule|method"><span class="operator"><span>rule</span></span></a><span> </span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#PhiSem_Mem_C_Base.val_map_mod_index_value_projection|fact"><span>val_map_mod_index_value_projection</span></a><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>insert</span></span><span> </span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#offset_21194..21199"><span>prems</span></a><span class="main"><span class="main"><span>(</span></span></span><span>1</span><span class="main"><span class="main"><span>)</span></span></span><span> </span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#offset_21194..21199"><span>prems</span></a><span class="main"><span class="main"><span>(</span></span></span><span>3</span><span class="main"><span class="main"><span>)</span></span></span><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>qed</span></span></span><span> </span><span class="keyword1"><span class="command"><span>.</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>context</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>notes</span></span></span><span> </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Algebras.Algebras.html#Algebras.mul_carrier_option_def|fact"><span>mul_carrier_option_def</span></a><span class="main"><span>[</span></span><span class="operator"><span>simp</span></span><span class="main"><span>]</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Option.html#Option.Option.option.pred_True|fact"><span>option.pred_True</span></a><span class="main"><span>[</span></span><span class="operator"><span>simp</span></span><span class="main"><span>]</span></span><span> </span><span class="keyword2"><span class="keyword"><span>begin</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="PhiSem_Mem_C_Base.fiction_Map_of_Val_perm_partial_refinement|fact"><span class="entity_def" id="PhiSem_Mem_C_Base.fiction_Map_of_Val_perm_partial_refinement|thm"><span>fiction_Map_of_Val_perm_partial_refinement</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="quoted"><span class="quoted"><span>‹ </span><a class="entity_ref" href="../Phi_Semantics/PhiSem_Aggregate_Base.html#PhiSem_Aggregate_Base.valid_index|const"><span>valid_index</span></a><span> </span><span class="free"><span>TY</span></span><span> </span><span class="free"><span>idx</span></span><span>
</span><span class="main"><span>⟹</span></span><span> </span><span class="free"><span>v</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span> </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Semantics_Framework.html#Phi_Semantics_Framework.Well_Type|const"><span>Well_Type</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Phi_Semantics/PhiSem_Aggregate_Base.html#PhiSem_Aggregate_Base.index_type|const"><span>index_type</span></a><span> </span><span class="free"><span>idx</span></span><span> </span><span class="free"><span>TY</span></span><span class="main"><span>)</span></span><span>
</span><span class="main"><span>⟹</span></span><span> </span><span class="free"><span>u_idx</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span> </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Semantics_Framework.html#Phi_Semantics_Framework.Well_Type|const"><span>Well_Type</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Phi_Semantics/PhiSem_Aggregate_Base.html#PhiSem_Aggregate_Base.index_type|const"><span>index_type</span></a><span> </span><span class="free"><span>idx</span></span><span> </span><span class="free"><span>TY</span></span><span class="main"><span>)</span></span><span>
</span><span class="main"><span>⟹</span></span><span> </span><span class="main"><span>∀</span></span><span class="bound"><span>x</span></span><span class="main"><span>∈</span></span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Semantics_Framework.html#Phi_Semantics_Framework.Well_Type|const"><span>Well_Type</span></a><span> </span><span class="free"><span>TY</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="../Phi_Semantics/PhiSem_Aggregate_Base.html#PhiSem_Aggregate_Base.index_mod_value|const"><span>index_mod_value</span></a><span> </span><span class="free"><span>cidx</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="main"><span class="bound"><span>_</span></span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>v</span></span><span class="main"><span>)</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="../Phi_Semantics/PhiSem_Aggregate_Base.html#PhiSem_Aggregate_Base.index_mod_value|const"><span>index_mod_value</span></a><span> </span><span class="free"><span>idx</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="main"><span class="bound"><span>_</span></span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>v</span></span><span class="main"><span>)</span></span><span> </span><span class="bound"><span>x</span></span><span>
</span><span class="main"><span>⟹</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>{</span></span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/Option.html#Option.option.Some|const"><span>Some</span></a><span> </span><span class="bound"><span>u</span></span><span class="main"><span>,</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/Option.html#Option.option.Some|const"><span>Some</span></a><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/Fun.html#Fun.comp|const"><span>o</span></a></span><span> </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Algebras.Algebras.html#Algebras.discrete.map_discrete|const"><span>map_discrete</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Phi_Semantics/PhiSem_Aggregate_Base.html#PhiSem_Aggregate_Base.index_mod_value|const"><span>index_mod_value</span></a><span> </span><span class="free"><span>cidx</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="main"><span class="bound"><span>_</span></span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>v</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="bound"><span>u</span></span><span class="main"><span>)</span></span><span class="main"><span>}</span></span><span>
          </span><span class="keyword1"><span>𝗌𝗎𝖻𝗃</span></span><span> </span><span class="bound"><span>u</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>u</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span> </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Algebras.Algebras.html#Algebras.discrete.discrete|const"><span>discrete</span></a><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.image|const"><span>`</span></a></span><span> </span><span class="main"><span>{</span></span><span class="bound"><span>a</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="../Phi_Semantics/PhiSem_Aggregate_Base.html#PhiSem_Aggregate_Base.index_value|const"><span>index_value</span></a><span> </span><span class="free"><span>idx</span></span><span> </span><span class="bound"><span>a</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="free"><span>u_idx</span></span><span class="main"><span>}</span></span><span>
            </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="bound"><span>u</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span> </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Algebras.Algebras.html#Algebras.discrete.discrete|const"><span>discrete</span></a><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.image|const"><span>`</span></a></span><span> </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Semantics_Framework.html#Phi_Semantics_Framework.Well_Type|const"><span>Well_Type</span></a><span> </span><span class="free"><span>TY</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Relation.html#Relation.Id_on|const"><span>Id_on</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.UNIV|const"><span>UNIV</span></a><span>
    </span><span class="keyword1"><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Algebras.Phi_Fiction.html#Phi_Fiction.Fictional_Forward_Simulation|const"><span>𝗋𝖾𝖿𝗂𝗇𝖾𝗌</span></a></span><span> </span><span class="main"><span>{</span></span><span class="main"><span>(</span></span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Algebras.Algebras.html#Algebras.to_share|const"><span>to_share</span></a><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/Fun.html#Fun.comp|const"><span>o</span></a></span><span> </span><span class="free"><span>idx</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../Phi_System/Phi_Algebras.Map_of_Tree.html#Map_of_Tree.push_map|const"><span>‣<span class="hidden">⇩</span><sub>m</sub></span></a></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/Option.html#Option.option.map_option|const"><span>map_option</span></a><span> </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Algebras.Algebras.html#Algebras.discrete.discrete|const"><span>discrete</span></a><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Fun.html#Fun.comp|const"><span>∘</span></a></span><span> </span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#PhiSem_Mem_C_Base.Map_of_Val|const"><span>Map_of_Val</span></a><span> </span><span class="free"><span>u_idx</span></span><span class="main"><span>)</span></span><span class="main"><span>,</span></span><span>
            </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Algebras.Algebras.html#Algebras.to_share|const"><span>to_share</span></a><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/Fun.html#Fun.comp|const"><span>o</span></a></span><span> </span><span class="free"><span>idx</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../Phi_System/Phi_Algebras.Map_of_Tree.html#Map_of_Tree.push_map|const"><span>‣<span class="hidden">⇩</span><sub>m</sub></span></a></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/Option.html#Option.option.map_option|const"><span>map_option</span></a><span> </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Algebras.Algebras.html#Algebras.discrete.discrete|const"><span>discrete</span></a><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Fun.html#Fun.comp|const"><span>∘</span></a></span><span> </span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#PhiSem_Mem_C_Base.Map_of_Val|const"><span>Map_of_Val</span></a><span> </span><span class="free"><span>v</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>}</span></span><span>
    </span><span class="keyword1"><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Algebras.Phi_Fiction.html#Phi_Fiction.Fictional_Forward_Simulation|const"><span>𝗐.𝗋.𝗍</span></a></span><span> </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Algebras.Phi_Fiction.html#Phi_Fiction.\&lt;F&gt;_functional|const"><span>ℱ_functional</span></a><span class="main"><span>(</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Fun.html#Fun.comp|const"><span>(∘)</span></a></span><span> </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Algebras.Algebras.html#Algebras.to_share|const"><span>to_share</span></a><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Fun.html#Fun.comp|const"><span>∘</span></a></span><span> </span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#PhiSem_Mem_C_Base.Map_of_Val_ins|const"><span>Map_of_Val_ins</span></a><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#PhiSem_Mem_C_Base.Map_of_Val_ins_dom|const"><span>Map_of_Val_ins_dom</span></a><span> </span><span class="free"><span>TY</span></span><span class="main"><span>)</span></span><span>
    </span><span class="keyword1"><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Algebras.Phi_Fiction.html#Phi_Fiction.Fictional_Forward_Simulation|const"><span>𝗂𝗇</span></a></span><span> </span><span class="main"><span>{</span></span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Algebras.Algebras.html#Algebras.to_share|const"><span>to_share</span></a><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/Fun.html#Fun.comp|const"><span>o</span></a></span><span> </span><span class="free"><span>idx</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../Phi_System/Phi_Algebras.Map_of_Tree.html#Map_of_Tree.push_map|const"><span>‣<span class="hidden">⇩</span><sub>m</sub></span></a></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/Option.html#Option.option.map_option|const"><span>map_option</span></a><span> </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Algebras.Algebras.html#Algebras.discrete.discrete|const"><span>discrete</span></a><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Fun.html#Fun.comp|const"><span>∘</span></a></span><span> </span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#PhiSem_Mem_C_Base.Map_of_Val|const"><span>Map_of_Val</span></a><span> </span><span class="free"><span>u_idx</span></span><span class="main"><span>)</span></span><span class="main"><span>}</span></span><span>›</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Algebras.Phi_Fiction.html#Phi_Fiction.\&lt;F&gt;_functional_comp|fact"><span>ℱ_functional_comp</span></a><span class="main"><span>[</span></span><span class="keyword2"><span class="keyword"><a class="entity_ref" href="../Phi_System/ISABELLE_HOME/src/HOL/Eisbach/eisbach_rule_insts.ML.html#Eisbach.where|attribute"><span class="operator"><span>where</span></span></a></span></span><span> f</span><span class="main"><span class="main"><span>=</span></span></span><span class="quoted"><span class="quoted"><span>‹</span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Fun.html#Fun.comp|const"><span>(∘)</span></a></span><span> </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Algebras.Algebras.html#Algebras.to_share|const"><span>to_share</span></a><span>›</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span class="quasi_keyword"><span>and</span></span></span></span><span> Df</span><span class="main"><span class="main"><span>=</span></span></span><span class="quoted"><span class="quoted"><span>‹</span><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.UNIV|const"><span>UNIV</span></a><span>›</span></span></span><span class="main"><span>,</span></span><span> </span><span class="operator"><span>simplified</span></span><span class="main"><span>]</span></span><span>
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/classical.ML.html#HOL.rule|method"><span class="operator"><span>rule</span></span></a><span> </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Algebras.Phi_Fiction.html#Phi_Fiction.sep_refinement_stepwise|fact"><span>sep_refinement_stepwise</span></a><span class="main"><span class="keyword3"><span>,</span></span></span><span>
      </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/classical.ML.html#HOL.rule|method"><span class="operator"><span>rule</span></span></a><span> </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Algebras.Phi_Fiction.html#Phi_Fiction.refinement_frame|fact"><span>refinement_frame</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>OF</span></span><span> </span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#PhiSem_Mem_C_Base.fiction_Map_of_Val_ins_refinement|fact"><span>fiction_Map_of_Val_ins_refinement</span></a><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span class="keyword3"><span>,</span></span></span><span>
      </span><span class="operator"><span>assumption</span></span><span class="main"><span class="keyword3"><span>,</span></span></span><span>
      </span><span class="operator"><span>assumption</span></span><span class="main"><span class="keyword3"><span>,</span></span></span><span>
      </span><span class="operator"><span>assumption</span></span><span class="main"><span class="keyword3"><span>,</span></span></span><span>
      </span><span class="operator"><span>assumption</span></span><span class="main"><span class="keyword3"><span>,</span></span></span><span>
      </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/classical.ML.html#HOL.rule|method"><span class="operator"><span>rule</span></span></a><span> </span><a class="entity_ref" href="../Phi_Semantics/Phi_System.Resource_Template.html#Resource_Template.pointwise_to_share.\&lt;F&gt;_functional_refinement|fact"><span>pointwise_to_share.ℱ_functional_refinement</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="keyword2"><span class="keyword"><a class="entity_ref" href="../Phi_System/ISABELLE_HOME/src/HOL/Eisbach/eisbach_rule_insts.ML.html#Eisbach.where|attribute"><span class="operator"><span>where</span></span></a></span></span><span> a</span><span class="main"><span class="main"><span class="main"><span>=</span></span></span></span><span class="quoted"><span class="quoted"><span>‹</span><span class="free"><span>idx</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../Phi_System/Phi_Algebras.Map_of_Tree.html#Map_of_Tree.push_map|const"><span>‣<span class="hidden">⇩</span><sub>m</sub></span></a></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/Option.html#Option.option.map_option|const"><span>map_option</span></a><span> </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Algebras.Algebras.html#Algebras.discrete.discrete|const"><span>discrete</span></a><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Fun.html#Fun.comp|const"><span>∘</span></a></span><span> </span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#PhiSem_Mem_C_Base.Map_of_Val|const"><span>Map_of_Val</span></a><span> </span><span class="free"><span>u_idx</span></span><span class="main"><span>)</span></span><span>›</span></span></span><span class="main"><span class="main"><span>,</span></span></span><span>
              </span><span class="operator"><span>simplified</span></span><span class="main"><span class="main"><span>,</span></span></span><span> </span><span class="operator"><span>simplified</span></span><span> </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Algebras.Algebras.html#Algebras.pointwise_set_UNIV|fact"><span>pointwise_set_UNIV</span></a><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span class="keyword3"><span>,</span></span></span><span>
      </span><span class="operator"><span>simp</span></span><span class="main"><span class="keyword3"><span>,</span></span></span><span>
      </span><span class="operator"><span>simp</span></span><span class="main"><span class="keyword3"><span>,</span></span></span><span>
      </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/classical.ML.html#HOL.rule|method"><span class="operator"><span>rule</span></span></a><span> </span><a class="entity_ref" href="../Phi_Semantics/Phi_System.Resource_Template.html#Resource_Template.pointwise_to_share.\&lt;F&gt;_functional_projection|fact"><span>pointwise_to_share.ℱ_functional_projection</span></a><span class="main"><span class="main"><span>[</span></span></span><span>
        </span><span class="keyword2"><span class="keyword"><a class="entity_ref" href="../Phi_System/ISABELLE_HOME/src/HOL/Eisbach/eisbach_rule_insts.ML.html#Eisbach.where|attribute"><span class="operator"><span>where</span></span></a></span></span><span> S</span><span class="main"><span class="main"><span class="main"><span>=</span></span></span></span><span class="quoted"><span class="quoted"><span>‹</span><span class="main"><span>{</span></span><span class="free"><span>idx</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../Phi_System/Phi_Algebras.Map_of_Tree.html#Map_of_Tree.push_map|const"><span>‣<span class="hidden">⇩</span><sub>m</sub></span></a></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/Option.html#Option.option.map_option|const"><span>map_option</span></a><span> </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Algebras.Algebras.html#Algebras.discrete.discrete|const"><span>discrete</span></a><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Fun.html#Fun.comp|const"><span>∘</span></a></span><span> </span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#PhiSem_Mem_C_Base.Map_of_Val|const"><span>Map_of_Val</span></a><span> </span><span class="free"><span>u_idx</span></span><span class="main"><span>)</span></span><span class="main"><span>}</span></span><span>›</span></span></span><span class="main"><span class="main"><span>,</span></span></span><span> </span><span class="operator"><span>simplified</span></span><span class="main"><span class="main"><span>,</span></span></span><span> </span><span class="operator"><span>simplified</span></span><span> </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Algebras.Algebras.html#Algebras.pointwise_set_UNIV|fact"><span>pointwise_set_UNIV</span></a><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span class="keyword3"><span>,</span></span></span><span>
      </span><span class="operator"><span>simp</span></span><span class="main"><span>)</span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="PhiSem_Mem_C_Base.fiction_Map_of_Val_ins_perm_projection|fact"><span class="entity_def" id="PhiSem_Mem_C_Base.fiction_Map_of_Val_ins_perm_projection|thm"><span>fiction_Map_of_Val_ins_perm_projection</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="quoted"><span class="quoted"><span>‹ </span><a class="entity_ref" href="../Phi_Semantics/PhiSem_Aggregate_Base.html#PhiSem_Aggregate_Base.valid_index|const"><span>valid_index</span></a><span> </span><span class="free"><span>TY</span></span><span> </span><span class="free"><span>idx</span></span><span>
</span><span class="main"><span>⟹</span></span><span> </span><span class="free"><span>u_idx</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span> </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Semantics_Framework.html#Phi_Semantics_Framework.Well_Type|const"><span>Well_Type</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Phi_Semantics/PhiSem_Aggregate_Base.html#PhiSem_Aggregate_Base.index_type|const"><span>index_type</span></a><span> </span><span class="free"><span>idx</span></span><span> </span><span class="free"><span>TY</span></span><span class="main"><span>)</span></span><span>
</span><span class="main"><span>⟹</span></span><span> </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Algebras.Phi_Fiction.html#Phi_Fiction.refinement_projection|const"><span>refinement_projection</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Algebras.Phi_Fiction.html#Phi_Fiction.\&lt;F&gt;_functional|const"><span>ℱ_functional</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Fun.html#Fun.comp|const"><span>(∘)</span></a></span><span> </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Algebras.Algebras.html#Algebras.to_share|const"><span>to_share</span></a><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/Fun.html#Fun.comp|const"><span>o</span></a></span><span> </span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#PhiSem_Mem_C_Base.Map_of_Val_ins|const"><span>Map_of_Val_ins</span></a><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#PhiSem_Mem_C_Base.Map_of_Val_ins_dom|const"><span>Map_of_Val_ins_dom</span></a><span> </span><span class="free"><span>TY</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>
                          </span><span class="main"><span>{</span></span><span> </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Algebras.Algebras.html#Algebras.to_share|const"><span>to_share</span></a><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/Fun.html#Fun.comp|const"><span>o</span></a></span><span> </span><span class="free"><span>idx</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../Phi_System/Phi_Algebras.Map_of_Tree.html#Map_of_Tree.push_map|const"><span>‣<span class="hidden">⇩</span><sub>m</sub></span></a></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/Option.html#Option.option.map_option|const"><span>map_option</span></a><span> </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Algebras.Algebras.html#Algebras.discrete.discrete|const"><span>discrete</span></a><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Fun.html#Fun.comp|const"><span>∘</span></a></span><span> </span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#PhiSem_Mem_C_Base.Map_of_Val|const"><span>Map_of_Val</span></a><span> </span><span class="free"><span>u_idx</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>}</span></span><span>
      </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.subset_eq|const"><span>⊆</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Option.html#Option.option.Some|const"><span>Some</span></a><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.image|const"><span>`</span></a></span><span> </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Algebras.Algebras.html#Algebras.discrete.discrete|const"><span>discrete</span></a><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.image|const"><span>`</span></a></span><span> </span><span class="main"><span>{</span></span><span class="bound"><span>a</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="../Phi_Semantics/PhiSem_Aggregate_Base.html#PhiSem_Aggregate_Base.index_value|const"><span>index_value</span></a><span> </span><span class="free"><span>idx</span></span><span> </span><span class="bound"><span>a</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="free"><span>u_idx</span></span><span> </span><span class="main"><span>}</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.UNIV|const"><span>UNIV</span></a><span> ›</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Algebras.Phi_Fiction.html#Phi_Fiction.\&lt;F&gt;_functional_comp|fact"><span>ℱ_functional_comp</span></a><span class="main"><span>[</span></span><span class="keyword2"><span class="keyword"><a class="entity_ref" href="../Phi_System/ISABELLE_HOME/src/HOL/Eisbach/eisbach_rule_insts.ML.html#Eisbach.where|attribute"><span class="operator"><span>where</span></span></a></span></span><span> f</span><span class="main"><span class="main"><span>=</span></span></span><span class="quoted"><span class="quoted"><span>‹</span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Fun.html#Fun.comp|const"><span>(∘)</span></a></span><span> </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Algebras.Algebras.html#Algebras.to_share|const"><span>to_share</span></a><span>›</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span class="quasi_keyword"><span>and</span></span></span></span><span> Df</span><span class="main"><span class="main"><span>=</span></span></span><span class="quoted"><span class="quoted"><span>‹</span><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.UNIV|const"><span>UNIV</span></a><span>›</span></span></span><span class="main"><span>,</span></span><span> </span><span class="operator"><span>simplified</span></span><span class="main"><span>]</span></span><span>
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/classical.ML.html#HOL.rule|method"><span class="operator"><span>rule</span></span></a><span> </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Algebras.Phi_Fiction.html#Phi_Fiction.refinement_projections_stepwise_UNIV_paired|fact"><span>refinement_projections_stepwise_UNIV_paired</span></a><span class="main"><span class="keyword3"><span>,</span></span></span><span>
      </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/classical.ML.html#HOL.rule|method"><span class="operator"><span>rule</span></span></a><span> </span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#PhiSem_Mem_C_Base.fiction_Map_of_Val_ins_projection&apos;|fact"><span>fiction_Map_of_Val_ins_projection'</span></a><span class="main"><span class="keyword3"><span>,</span></span></span><span>
      </span><span class="operator"><span>assumption</span></span><span class="main"><span class="keyword3"><span>,</span></span></span><span>
      </span><span class="operator"><span>assumption</span></span><span class="main"><span class="keyword3"><span>,</span></span></span><span>
      </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/classical.ML.html#HOL.rule|method"><span class="operator"><span>rule</span></span></a><span> </span><a class="entity_ref" href="../Phi_Semantics/Phi_System.Resource_Template.html#Resource_Template.pointwise_to_share.\&lt;F&gt;_functional_projection|fact"><span>pointwise_to_share.ℱ_functional_projection</span></a><span class="main"><span class="main"><span>[</span></span></span><span>
        </span><span class="keyword2"><span class="keyword"><a class="entity_ref" href="../Phi_System/ISABELLE_HOME/src/HOL/Eisbach/eisbach_rule_insts.ML.html#Eisbach.where|attribute"><span class="operator"><span>where</span></span></a></span></span><span> S</span><span class="main"><span class="main"><span class="main"><span>=</span></span></span></span><span class="quoted"><span class="quoted"><span>‹</span><span class="main"><span>{</span></span><span class="free"><span>idx</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../Phi_System/Phi_Algebras.Map_of_Tree.html#Map_of_Tree.push_map|const"><span>‣<span class="hidden">⇩</span><sub>m</sub></span></a></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/Option.html#Option.option.map_option|const"><span>map_option</span></a><span> </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Algebras.Algebras.html#Algebras.discrete.discrete|const"><span>discrete</span></a><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Fun.html#Fun.comp|const"><span>∘</span></a></span><span> </span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#PhiSem_Mem_C_Base.Map_of_Val|const"><span>Map_of_Val</span></a><span> </span><span class="free"><span>u_idx</span></span><span class="main"><span>)</span></span><span class="main"><span>}</span></span><span>›</span></span></span><span class="main"><span class="main"><span>,</span></span></span><span> </span><span class="operator"><span>simplified</span></span><span class="main"><span class="main"><span>,</span></span></span><span> </span><span class="operator"><span>simplified</span></span><span> </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Algebras.Algebras.html#Algebras.pointwise_set_UNIV|fact"><span>pointwise_set_UNIV</span></a><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span class="keyword3"><span>,</span></span></span><span>
      </span><span class="operator"><span>simp</span></span><span class="main"><span>)</span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="PhiSem_Mem_C_Base.fiction_Map_of_Val_ins_perm_projection_half|fact"><span class="entity_def" id="PhiSem_Mem_C_Base.fiction_Map_of_Val_ins_perm_projection_half|thm"><span>fiction_Map_of_Val_ins_perm_projection_half</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="quoted"><span class="quoted"><span>‹ </span><a class="entity_ref" href="../Phi_Semantics/PhiSem_Aggregate_Base.html#PhiSem_Aggregate_Base.valid_index|const"><span>valid_index</span></a><span> </span><span class="free"><span>TY</span></span><span> </span><span class="free"><span>idx</span></span><span>
</span><span class="main"><span>⟹</span></span><span> </span><span class="free"><span>u_idx</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span> </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Semantics_Framework.html#Phi_Semantics_Framework.Well_Type|const"><span>Well_Type</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Phi_Semantics/PhiSem_Aggregate_Base.html#PhiSem_Aggregate_Base.index_type|const"><span>index_type</span></a><span> </span><span class="free"><span>idx</span></span><span> </span><span class="free"><span>TY</span></span><span class="main"><span>)</span></span><span>
</span><span class="main"><span>⟹</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span> </span><span class="free"><span>n</span></span><span>
</span><span class="main"><span>⟹</span></span><span> </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Algebras.Phi_Fiction.html#Phi_Fiction.refinement_projection|const"><span>refinement_projection</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Algebras.Phi_Fiction.html#Phi_Fiction.\&lt;F&gt;_functional|const"><span>ℱ_functional</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Fun.html#Fun.comp|const"><span>(∘)</span></a></span><span> </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Algebras.Algebras.html#Algebras.to_share|const"><span>to_share</span></a><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/Fun.html#Fun.comp|const"><span>o</span></a></span><span> </span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#PhiSem_Mem_C_Base.Map_of_Val_ins|const"><span>Map_of_Val_ins</span></a><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#PhiSem_Mem_C_Base.Map_of_Val_ins_dom|const"><span>Map_of_Val_ins_dom</span></a><span> </span><span class="free"><span>TY</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>
                          </span><span class="main"><span>{</span></span><span> </span><span class="free"><span>n</span></span><span> </span><span class="main"><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Algebras.Algebras.html#Algebras.raw_share_class.share|const"><span>⦼</span></a></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Algebras.Algebras.html#Algebras.to_share|const"><span>to_share</span></a><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/Fun.html#Fun.comp|const"><span>o</span></a></span><span> </span><span class="free"><span>idx</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../Phi_System/Phi_Algebras.Map_of_Tree.html#Map_of_Tree.push_map|const"><span>‣<span class="hidden">⇩</span><sub>m</sub></span></a></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/Option.html#Option.option.map_option|const"><span>map_option</span></a><span> </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Algebras.Algebras.html#Algebras.discrete.discrete|const"><span>discrete</span></a><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Fun.html#Fun.comp|const"><span>∘</span></a></span><span> </span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#PhiSem_Mem_C_Base.Map_of_Val|const"><span>Map_of_Val</span></a><span> </span><span class="free"><span>u_idx</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>}</span></span><span>
      </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.subset_eq|const"><span>⊆</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Option.html#Option.option.Some|const"><span>Some</span></a><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.image|const"><span>`</span></a></span><span> </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Algebras.Algebras.html#Algebras.discrete.discrete|const"><span>discrete</span></a><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.image|const"><span>`</span></a></span><span> </span><span class="main"><span>{</span></span><span class="bound"><span>a</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="../Phi_Semantics/PhiSem_Aggregate_Base.html#PhiSem_Aggregate_Base.index_value|const"><span>index_value</span></a><span> </span><span class="free"><span>idx</span></span><span> </span><span class="bound"><span>a</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="free"><span>u_idx</span></span><span> </span><span class="main"><span>}</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.times_class.times|const"><span>*</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.UNIV|const"><span>UNIV</span></a><span>›</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Algebras.Phi_Fiction.html#Phi_Fiction.\&lt;F&gt;_functional_comp|fact"><span>ℱ_functional_comp</span></a><span class="main"><span>[</span></span><span class="keyword2"><span class="keyword"><a class="entity_ref" href="../Phi_System/ISABELLE_HOME/src/HOL/Eisbach/eisbach_rule_insts.ML.html#Eisbach.where|attribute"><span class="operator"><span>where</span></span></a></span></span><span> f</span><span class="main"><span class="main"><span>=</span></span></span><span class="quoted"><span class="quoted"><span>‹</span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Fun.html#Fun.comp|const"><span>(∘)</span></a></span><span> </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Algebras.Algebras.html#Algebras.to_share|const"><span>to_share</span></a><span>›</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span class="quasi_keyword"><span>and</span></span></span></span><span> Df</span><span class="main"><span class="main"><span>=</span></span></span><span class="quoted"><span class="quoted"><span>‹</span><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.UNIV|const"><span>UNIV</span></a><span>›</span></span></span><span class="main"><span>,</span></span><span> </span><span class="operator"><span>simplified</span></span><span class="main"><span>]</span></span><span>
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/classical.ML.html#HOL.rule|method"><span class="operator"><span>rule</span></span></a><span> </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Algebras.Phi_Fiction.html#Phi_Fiction.refinement_projections_stepwise_UNIV_paired|fact"><span>refinement_projections_stepwise_UNIV_paired</span></a><span class="main"><span class="keyword3"><span>,</span></span></span><span>
      </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/classical.ML.html#HOL.rule|method"><span class="operator"><span>rule</span></span></a><span> </span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#PhiSem_Mem_C_Base.fiction_Map_of_Val_ins_projection&apos;|fact"><span>fiction_Map_of_Val_ins_projection'</span></a><span class="main"><span class="keyword3"><span>,</span></span></span><span>
      </span><span class="operator"><span>assumption</span></span><span class="main"><span class="keyword3"><span>,</span></span></span><span>
      </span><span class="operator"><span>assumption</span></span><span class="main"><span class="keyword3"><span>,</span></span></span><span>
      </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/classical.ML.html#HOL.rule|method"><span class="operator"><span>rule</span></span></a><span> </span><a class="entity_ref" href="../Phi_Semantics/Phi_System.Resource_Template.html#Resource_Template.pointwise_to_share.refinement_projection_half_perm|fact"><span>pointwise_to_share.refinement_projection_half_perm</span></a><span class="main"><span class="main"><span>[</span></span></span><span>
        </span><span class="keyword2"><span class="keyword"><a class="entity_ref" href="../Phi_System/ISABELLE_HOME/src/HOL/Eisbach/eisbach_rule_insts.ML.html#Eisbach.where|attribute"><span class="operator"><span>where</span></span></a></span></span><span> S</span><span class="main"><span class="main"><span class="main"><span>=</span></span></span></span><span class="quoted"><span class="quoted"><span>‹</span><span class="main"><span>{</span></span><span class="free"><span>idx</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../Phi_System/Phi_Algebras.Map_of_Tree.html#Map_of_Tree.push_map|const"><span>‣<span class="hidden">⇩</span><sub>m</sub></span></a></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/Option.html#Option.option.map_option|const"><span>map_option</span></a><span> </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Algebras.Algebras.html#Algebras.discrete.discrete|const"><span>discrete</span></a><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Fun.html#Fun.comp|const"><span>∘</span></a></span><span> </span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#PhiSem_Mem_C_Base.Map_of_Val|const"><span>Map_of_Val</span></a><span> </span><span class="free"><span>u_idx</span></span><span class="main"><span>)</span></span><span class="main"><span>}</span></span><span>›</span></span></span><span class="main"><span class="main"><span>,</span></span></span><span> </span><span class="operator"><span>simplified</span></span><span class="main"><span class="main"><span>,</span></span></span><span> </span><span class="operator"><span>simplified</span></span><span> </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Algebras.Algebras.html#Algebras.pointwise_set_UNIV|fact"><span>pointwise_set_UNIV</span></a><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span class="keyword3"><span>,</span></span></span><span>
      </span><span class="operator"><span>simp</span></span><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><span class="operator"><span>simp</span></span><span class="main"><span>)</span></span><span>

</span><span class="keyword2"><span class="keyword"><span>end</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="PhiSem_Mem_C_Base.aggregate_mem_resource.axioms|fact"><span class="entity_def" id="PhiSem_Mem_C_Base.aggregate_mem_resource.intro|fact"><span class="entity_def" id="PhiSem_Mem_C_Base.aggregate_mem_resource_def|fact"><span class="entity_def" id="PhiSem_Mem_C_Base.aggregate_mem_resource.axioms|thm"><span class="entity_def" id="PhiSem_Mem_C_Base.aggregate_mem_resource.intro|thm"><span class="entity_def" id="PhiSem_Mem_C_Base.aggregate_mem_resource_def|thm"><span class="entity_def" id="PhiSem_Mem_C_Base.aggregate_mem_resource_def|axiom"><span>locale</span></span></span></span></span></span></span></span></span></span><span> </span><span class="entity_def" id="PhiSem_Mem_C_Base.aggregate_mem_resource|locale"><span class="entity_def" id="PhiSem_Mem_C_Base.aggregate_mem_resource|const"><span>aggregate_mem_resource</span></span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><a class="entity_ref" href="../Phi_Semantics/Phi_System.Resource_Template.html#Resource_Template.partial_map_resource|locale"><span>partial_map_resource</span></a><span> </span><span class="quoted"><span class="free"><span>Res</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>‹</span><span class="main"><span>λ</span></span><span class="bound"><span>blk</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Algebras.Algebras.html#Algebras.discrete.discrete|const"><span>discrete</span></a><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.image|const"><span>`</span></a></span><span> </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Semantics_Framework.html#Phi_Semantics_Framework.Well_Type|const"><span>Well_Type</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span>typ_of_blk</span></span><span> </span><span class="bound"><span>blk</span></span><span class="main"><span>)</span></span><span>›</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>for</span></span></span><span> </span><span class="free"><span>Res</span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="tfree"><span>'blk</span></span><span> </span><span class="main"><span>⇒</span></span><span> </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Semantics_Framework.html#Phi_Semantics_Framework.VAL|type"><span>VAL</span></a><span> </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Algebras.Algebras.html#Algebras.discrete|type"><span>discrete</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Option.html#Option.option|type"><span>option</span></a><span class="main"><span>)</span></span><span> </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Semantics_Framework.html#Phi_Semantics_Framework.resource_entry|type"><span>resource_entry</span></a><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="free"><span>typ_of_blk</span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>‹</span><span class="tfree"><span>'blk</span></span><span> </span><span class="main"><span>⇒</span></span><span> </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Semantics_Framework.html#Phi_Semantics_Framework.TY|type"><span>TY</span></a><span>›</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="PhiSem_Mem_C_Base.perm_aggregate_mem_fiction.axioms|fact"><span class="entity_def" id="PhiSem_Mem_C_Base.perm_aggregate_mem_fiction.intro|fact"><span class="entity_def" id="PhiSem_Mem_C_Base.perm_aggregate_mem_fiction_def|fact"><span class="entity_def" id="PhiSem_Mem_C_Base.perm_aggregate_mem_fiction.axioms|thm"><span class="entity_def" id="PhiSem_Mem_C_Base.perm_aggregate_mem_fiction.intro|thm"><span class="entity_def" id="PhiSem_Mem_C_Base.perm_aggregate_mem_fiction_def|thm"><span class="entity_def" id="PhiSem_Mem_C_Base.perm_aggregate_mem_fiction_def|axiom"><span>locale</span></span></span></span></span></span></span></span></span></span><span> </span><span class="entity_def" id="PhiSem_Mem_C_Base.perm_aggregate_mem_fiction|locale"><span class="entity_def" id="PhiSem_Mem_C_Base.perm_aggregate_mem_fiction|const"><span>perm_aggregate_mem_fiction</span></span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><a class="entity_ref" href="../Phi_Semantics/Phi_System.Resource_Template.html#Resource_Template.pointwise_base_fiction_for_partial_mapping_resource|locale"><span>pointwise_base_fiction_for_partial_mapping_resource</span></a><span>
      </span><span class="quoted"><span class="free"><span>Res</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>‹</span><span class="main"><span>λ</span></span><span class="bound"><span>blk</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Algebras.Phi_Fiction.html#Phi_Fiction.\&lt;F&gt;_functional|const"><span>ℱ_functional</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Fun.html#Fun.comp|const"><span>(∘)</span></a></span><span> </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Algebras.Algebras.html#Algebras.to_share|const"><span>to_share</span></a><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Fun.html#Fun.comp|const"><span>∘</span></a></span><span> </span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#PhiSem_Mem_C_Base.Map_of_Val_ins|const"><span>Map_of_Val_ins</span></a><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#PhiSem_Mem_C_Base.Map_of_Val_ins_dom|const"><span>Map_of_Val_ins_dom</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span>typ_of_blk</span></span><span> </span><span class="bound"><span>blk</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>›</span></span></span><span>
      </span><span class="quoted"><span class="free"><span>Fic</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>‹</span><span class="main"><span>λ</span></span><span class="bound"><span>blk</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Algebras.Algebras.html#Algebras.discrete.discrete|const"><span>discrete</span></a><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.image|const"><span>`</span></a></span><span> </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Semantics_Framework.html#Phi_Semantics_Framework.Well_Type|const"><span>Well_Type</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span>typ_of_blk</span></span><span> </span><span class="bound"><span>blk</span></span><span class="main"><span>)</span></span><span>›</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>for</span></span></span><span> </span><span class="free"><span>Res</span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="tfree"><span>'blk</span></span><span> </span><span class="main"><span>⇒</span></span><span> </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Semantics_Framework.html#Phi_Semantics_Framework.VAL|type"><span>VAL</span></a><span> </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Algebras.Algebras.html#Algebras.discrete|type"><span>discrete</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Option.html#Option.option|type"><span>option</span></a><span class="main"><span>)</span></span><span> </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Semantics_Framework.html#Phi_Semantics_Framework.resource_entry|type"><span>resource_entry</span></a><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="free"><span>typ_of_blk</span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>‹</span><span class="tfree"><span>'blk</span></span><span> </span><span class="main"><span>⇒</span></span><span> </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Semantics_Framework.html#Phi_Semantics_Framework.TY|type"><span>TY</span></a><span>›</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="free"><span>null_blk</span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="tfree"><span class="quoted"><span class="tfree"><span>'blk</span></span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="free"><span>Fic</span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="tfree"><span>'blk</span></span><span> </span><span class="main"><span>⇒</span></span><span> </span><a class="entity_ref" href="../Phi_System/Phi_Element_Path.html#Phi_Element_Path.aggregate_path|type"><span>aggregate_path</span></a><span> </span><span class="main"><span>⇒</span></span><span> </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Semantics_Framework.html#Phi_Semantics_Framework.VAL|type"><span>VAL</span></a><span> </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Algebras.Algebras.html#Algebras.discrete|type"><span>discrete</span></a><span> </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Algebras.Algebras.html#Algebras.share|type"><span>share</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Option.html#Option.option|type"><span>option</span></a><span class="main"><span>)</span></span><span> </span><a class="entity_ref" href="../Phi_System/Spec_Framework.html#Spec_Framework.fiction_entry|type"><span>fiction_entry</span></a><span>"</span></span></span><span>
</span><span class="keyword2"><span class="keyword"><span>begin</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>sublocale</span></span></span><span> </span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#PhiSem_Mem_C_Base.aggregate_mem_resource|locale"><span>aggregate_mem_resource</span></a><span> </span><span class="quoted"><span class="free"><span>Res</span></span></span><span> </span><span class="quoted"><span class="free"><span>typ_of_blk</span></span></span><span> </span><span class="keyword1"><span class="command"><span>..</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="PhiSem_Mem_C_Base.perm_aggregate_mem_fiction.getter_rule|fact"><span class="entity_def" id="PhiSem_Mem_C_Base.perm_aggregate_mem_fiction.getter_rule|thm"><span>getter_rule</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="quoted"><span class="quoted"><span>‹ </span><a class="entity_ref" href="../Phi_Semantics/PhiSem_Aggregate_Base.html#PhiSem_Aggregate_Base.valid_index|const"><span>valid_index</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span>typ_of_blk</span></span><span> </span><span class="free"><span>blk</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>idx</span></span><span>
</span><span class="main"><span>⟹</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../Phi_System/Phi_Logic_Programming_Reasoner.PLPR.html#PLPR.Normal_Premise|const"><span>𝗉𝗋𝖾𝗆𝗂𝗌𝖾</span></a></span><span> </span><span class="free"><span>u_idx</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span> </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Semantics_Framework.html#Phi_Semantics_Framework.Well_Type|const"><span>Well_Type</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Phi_Semantics/PhiSem_Aggregate_Base.html#PhiSem_Aggregate_Base.index_type|const"><span>index_type</span></a><span> </span><span class="free"><span>idx</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>typ_of_blk</span></span><span> </span><span class="free"><span>blk</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="free"><span>cblk</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="free"><span>blk</span></span><span>
</span><span class="main"><span>⟹</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../Phi_System/Phi_Logic_Programming_Reasoner.PLPR.html#PLPR.Normal_Premise|const"><span>𝗉𝗋𝖾𝗆𝗂𝗌𝖾</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span> </span><span class="free"><span>n</span></span><span>
</span><span class="main"><span>⟹</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../Phi_System/Spec_Framework.html#Spec_Framework.\&lt;phi&gt;Procedure_no_exception|const"><span>𝗉𝗋𝗈𝖼</span></a></span><span> </span><span>R.φR_get_res_entry'</span><span> </span><span class="free"><span>cblk</span></span><span> </span><span class="main"><a class="entity_ref" href="../Phi_System/Spec_Framework.html#Spec_Framework.\&lt;phi&gt;Procedure_no_exception|const"><span>⦃</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span class="main"><span>(</span></span><span class="free"><span>blk</span></span><span> </span><span class="main"><span>:=</span></span><span> </span><span class="free"><span>n</span></span><span> </span><span class="main"><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Algebras.Algebras.html#Algebras.raw_share_class.share|const"><span>⦼</span></a></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Algebras.Algebras.html#Algebras.to_share|const"><span>to_share</span></a><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Fun.html#Fun.comp|const"><span>∘</span></a></span><span> </span><span class="free"><span>idx</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../Phi_System/Phi_Algebras.Map_of_Tree.html#Map_of_Tree.push_map|const"><span>‣<span class="hidden">⇩</span><sub>m</sub></span></a></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/Option.html#Option.option.map_option|const"><span>map_option</span></a><span> </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Algebras.Algebras.html#Algebras.discrete.discrete|const"><span>discrete</span></a><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Fun.html#Fun.comp|const"><span>∘</span></a></span><span> </span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#PhiSem_Mem_C_Base.Map_of_Val|const"><span>Map_of_Val</span></a><span> </span><span class="free"><span>u_idx</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../Phi_System/Phi_BI.html#Phi_BI.\&lt;phi&gt;Type|const"><span>⦂</span></a></span><span> </span><span>φ</span><span> </span><a class="entity_ref" href="../Phi_System/Phi_BI.html#Phi_BI.Itself|const"><span>Itself</span></a><span> </span><span class="main"><a class="entity_ref" href="../Phi_System/Spec_Framework.html#Spec_Framework.\&lt;phi&gt;Procedure_no_exception|const"><span>⟼</span></a></span><span>
      </span><span class="main"><span>λ</span></span><span class="bound"><span>ret</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span class="main"><span>(</span></span><span class="free"><span>blk</span></span><span> </span><span class="main"><span>:=</span></span><span> </span><span class="free"><span>n</span></span><span> </span><span class="main"><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Algebras.Algebras.html#Algebras.raw_share_class.share|const"><span>⦼</span></a></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Algebras.Algebras.html#Algebras.to_share|const"><span>to_share</span></a><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Fun.html#Fun.comp|const"><span>∘</span></a></span><span> </span><span class="free"><span>idx</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../Phi_System/Phi_Algebras.Map_of_Tree.html#Map_of_Tree.push_map|const"><span>‣<span class="hidden">⇩</span><sub>m</sub></span></a></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/Option.html#Option.option.map_option|const"><span>map_option</span></a><span> </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Algebras.Algebras.html#Algebras.discrete.discrete|const"><span>discrete</span></a><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Fun.html#Fun.comp|const"><span>∘</span></a></span><span> </span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#PhiSem_Mem_C_Base.Map_of_Val|const"><span>Map_of_Val</span></a><span> </span><span class="free"><span>u_idx</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../Phi_System/Phi_BI.html#Phi_BI.\&lt;phi&gt;Type|const"><span>⦂</span></a></span><span> </span><span>φ</span><span> </span><a class="entity_ref" href="../Phi_System/Phi_BI.html#Phi_BI.Itself|const"><span>Itself</span></a><span>
          </span><span class="keyword1"><span>𝗌𝗎𝖻𝗃</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>ret</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Semantics_Framework.html#Phi_Semantics_Framework.\&lt;phi&gt;arg.\&lt;phi&gt;arg|const"><span>φarg</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Algebras.Algebras.html#Algebras.discrete.discrete|const"><span>discrete</span></a><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span> </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Semantics_Framework.html#Phi_Semantics_Framework.Well_Type|const"><span>Well_Type</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span>typ_of_blk</span></span><span> </span><span class="free"><span>blk</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span> </span><span class="main"><span>{</span></span><span class="bound"><span>a</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="../Phi_Semantics/PhiSem_Aggregate_Base.html#PhiSem_Aggregate_Base.index_value|const"><span>index_value</span></a><span> </span><span class="free"><span>idx</span></span><span> </span><span class="bound"><span>a</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="free"><span>u_idx</span></span><span class="main"><span>}</span></span><span> </span><span class="main"><a class="entity_ref" href="../Phi_System/Spec_Framework.html#Spec_Framework.\&lt;phi&gt;Procedure_no_exception|const"><span>⦄</span></a></span><span>›</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="../Phi_System/Phi_Logic_Programming_Reasoner.PLPR.html#PLPR.Premise_def|fact"><span>Premise_def</span></a><span>
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/classical.ML.html#HOL.rule|method"><span class="operator"><span>rule</span></span></a><span> </span><span class="quoted"><span>"</span><span>_getter_rule_2_</span><span>"</span></span><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>OF</span></span><span> _ </span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#PhiSem_Mem_C_Base.fiction_Map_of_Val_ins_perm_projection_half|fact"><span>fiction_Map_of_Val_ins_perm_projection_half</span></a><span class="main"><span class="main"><span>,</span></span></span><span>
                                </span><span class="operator"><span>simplified</span></span><span> </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Algebras.Algebras.html#Algebras.split_discrete_ExSet|fact"><span>split_discrete_ExSet</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Fun.html#Fun.inj_image_mem_iff|fact"><span>inj_image_mem_iff</span></a><span> </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Algebras.Algebras.html#Algebras.inj_discrete|fact"><span>inj_discrete</span></a><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span class="keyword3"><span>;</span></span></span><span>
      </span><span class="operator"><span>simp</span></span><span class="main"><span>)</span></span><span>

</span><span class="keyword1"><span class="command"><span>context</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>notes</span></span></span><span> </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Algebras.Algebras.html#Algebras.mul_carrier_option_def|fact"><span>mul_carrier_option_def</span></a><span class="main"><span>[</span></span><span class="operator"><span>simp</span></span><span class="main"><span>]</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Option.html#Option.Option.option.pred_True|fact"><span>option.pred_True</span></a><span class="main"><span>[</span></span><span class="operator"><span>simp</span></span><span class="main"><span>]</span></span><span> </span><span class="keyword2"><span class="keyword"><span>begin</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="PhiSem_Mem_C_Base.perm_aggregate_mem_fiction.allocate_rule|fact"><span class="entity_def" id="PhiSem_Mem_C_Base.perm_aggregate_mem_fiction.allocate_rule|thm"><span>allocate_rule</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="quoted"><span class="quoted"><span>‹ </span><span class="keyword1"><a class="entity_ref" href="../Phi_System/Phi_Logic_Programming_Reasoner.PLPR.html#PLPR.Normal_Premise|const"><span>𝗉𝗋𝖾𝗆𝗂𝗌𝖾</span></a></span><span> </span><span class="main"><span>(</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.All|const"><span>∀</span></a></span><span class="bound"><span>r</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.All|const"><span>.</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Finite_Set.html#Finite_Set.finite|const"><span>finite</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/Map.html#Map.dom|const"><span>dom</span></a><span> </span><span class="bound"><span>r</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.implies|const"><span>⟶</span></a></span><span> </span><span class="main"><span>(</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Ex|const"><span>∃</span></a></span><span class="bound"><span>blk</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Ex|const"><span>.</span></a></span><span> </span><span class="bound"><span>blk</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.not_member|const"><span>∉</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Map.html#Map.dom|const"><span>dom</span></a><span> </span><span class="bound"><span>r</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="free"><span>typ_of_blk</span></span><span> </span><span class="bound"><span>blk</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="free"><span>TY</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="bound"><span>blk</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.not_equal|const"><span>≠</span></a></span><span> </span><span class="free"><span>null_blk</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>
</span><span class="main"><span>⟹</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../Phi_System/Phi_Logic_Programming_Reasoner.PLPR.html#PLPR.Normal_Premise|const"><span>𝗉𝗋𝖾𝗆𝗂𝗌𝖾</span></a></span><span> </span><span class="free"><span>v</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span> </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Semantics_Framework.html#Phi_Semantics_Framework.Well_Type|const"><span>Well_Type</span></a><span> </span><span class="free"><span>TY</span></span><span>
</span><span class="main"><span>⟹</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../Phi_System/Spec_Framework.html#Spec_Framework.\&lt;phi&gt;Procedure_no_exception|const"><span>𝗉𝗋𝗈𝖼</span></a></span><span> </span><span>R.φR_allocate_res_entry'</span><span> </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="bound"><span>blk</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>typ_of_blk</span></span><span> </span><span class="bound"><span>blk</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="free"><span>TY</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="bound"><span>blk</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.not_equal|const"><span>≠</span></a></span><span> </span><span class="free"><span>null_blk</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/Option.html#Option.option.Some|const"><span>Some</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Algebras.Algebras.html#Algebras.discrete.discrete|const"><span>discrete</span></a><span> </span><span class="free"><span>v</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>
      </span><span class="main"><a class="entity_ref" href="../Phi_System/Spec_Framework.html#Spec_Framework.\&lt;phi&gt;Procedure_no_exception|const"><span>⦃</span></a></span><span> </span><a class="entity_ref" href="../Phi_System/Spec_Framework.html#Spec_Framework.Void|const"><span>Void</span></a><span> </span><span class="main"><a class="entity_ref" href="../Phi_System/Spec_Framework.html#Spec_Framework.\&lt;phi&gt;Procedure_no_exception|const"><span>⟼</span></a></span><span> </span><span class="main"><span>λ</span></span><span class="bound"><span>ret</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span class="main"><span>(</span></span><span class="bound"><span>blk</span></span><span> </span><span class="main"><span>:=</span></span><span> </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Algebras.Algebras.html#Algebras.to_share|const"><span>to_share</span></a><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Fun.html#Fun.comp|const"><span>∘</span></a></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/Option.html#Option.option.map_option|const"><span>map_option</span></a><span> </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Algebras.Algebras.html#Algebras.discrete.discrete|const"><span>discrete</span></a><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Fun.html#Fun.comp|const"><span>∘</span></a></span><span> </span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#PhiSem_Mem_C_Base.Map_of_Val|const"><span>Map_of_Val</span></a><span> </span><span class="free"><span>v</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../Phi_System/Phi_BI.html#Phi_BI.\&lt;phi&gt;Type|const"><span>⦂</span></a></span><span> </span><span>φ</span><span> </span><a class="entity_ref" href="../Phi_System/Phi_BI.html#Phi_BI.Itself|const"><span>Itself</span></a><span> </span><span class="keyword1"><span>𝗌𝗎𝖻𝗃</span></span><span> </span><span class="bound"><span>blk</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>ret</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Semantics_Framework.html#Phi_Semantics_Framework.\&lt;phi&gt;arg.\&lt;phi&gt;arg|const"><span>φarg</span></a><span> </span><span class="bound"><span>blk</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="free"><span>typ_of_blk</span></span><span> </span><span class="bound"><span>blk</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="free"><span>TY</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>∧</span></a></span><span> </span><span class="bound"><span>blk</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.not_equal|const"><span>≠</span></a></span><span> </span><span class="free"><span>null_blk</span></span><span>  </span><span class="main"><a class="entity_ref" href="../Phi_System/Spec_Framework.html#Spec_Framework.\&lt;phi&gt;Procedure_no_exception|const"><span>⦄</span></a></span><span> ›</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="../Phi_System/Phi_Logic_Programming_Reasoner.PLPR.html#PLPR.Premise_def|fact"><span>Premise_def</span></a><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>premises</span></span></span><span> </span><span class="entity_def" id="offset_26656..26661">prems</span><span> </span><span class="keyword1"><span class="command"><span>proof</span></span></span><span class="operator"><span>-</span></span><span>

  </span><span class="keyword1"><span class="command"><span>note</span></span></span><span> </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Algebras.Algebras.html#Algebras.pointwise_set_UNIV|fact"><span>pointwise_set_UNIV</span></a><span class="main"><span>[</span></span><span class="operator"><span>simp</span></span><span class="main"><span>]</span></span><span> </span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#PhiSem_Mem_C_Base.\&lt;F&gt;_functional_condition_Map_of_Val_ins_dom|fact"><span>ℱ_functional_condition_Map_of_Val_ins_dom</span></a><span class="main"><span>[</span></span><span class="operator"><span>simp</span></span><span class="main"><span>]</span></span><span>
  </span><span class="keyword1"><span class="command"><span>note</span></span></span><span> </span><span class="main"><span>[</span></span><span class="main"><span>[</span></span><span class="operator"><span>unify_trace_failure</span></span><span class="main"><span>]</span></span><span class="main"><span>]</span></span><span>

  </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/classical.ML.html#HOL.rule|method"><span class="operator"><span>rule</span></span></a><span> </span><span class="quoted"><span>"</span><span>__allocate_rule_3__</span><span>"</span></span><span class="main"><span class="keyword3"><span>,</span></span></span><span>
      </span><span class="operator"><span>unfold</span></span><span> </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Algebras.Phi_Fiction.html#Phi_Fiction.\&lt;F&gt;_functional_comp|fact"><span>ℱ_functional_comp</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="keyword2"><span class="keyword"><a class="entity_ref" href="../Phi_System/ISABELLE_HOME/src/HOL/Eisbach/eisbach_rule_insts.ML.html#Eisbach.where|attribute"><span class="operator"><span>where</span></span></a></span></span><span> f</span><span class="main"><span class="main"><span class="main"><span>=</span></span></span></span><span class="quoted"><span class="quoted"><span>‹</span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Fun.html#Fun.comp|const"><span>(∘)</span></a></span><span> </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Algebras.Algebras.html#Algebras.to_share|const"><span>to_share</span></a><span>›</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span class="quasi_keyword"><span class="quasi_keyword"><span>and</span></span></span></span></span><span> Df</span><span class="main"><span class="main"><span class="main"><span>=</span></span></span></span><span class="quoted"><span class="quoted"><span>‹</span><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.UNIV|const"><span>UNIV</span></a><span>›</span></span></span><span class="main"><span class="main"><span>,</span></span></span><span> </span><span class="operator"><span>simplified</span></span><span class="main"><span class="main"><span>,</span></span></span><span> </span><span class="operator"><span>simp</span></span><span class="main"><span class="main"><span>]</span></span></span><span>
             </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Algebras.Algebras.html#Algebras.one_option_def|fact"><span>one_option_def</span></a><span class="main"><span class="keyword3"><span>,</span></span></span><span>
      </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/classical.ML.html#HOL.rule|method"><span class="operator"><span>rule</span></span></a><span> </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Algebras.Phi_Fiction.html#Phi_Fiction.sep_refinement_stepwise|fact"><span>sep_refinement_stepwise</span></a><span class="main"><span class="main"><span>[</span></span></span><span>
                  </span><span class="operator"><span>OF</span></span><span> </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Algebras.Phi_Fiction.html#Phi_Fiction.refinement_frame|fact"><span>refinement_frame</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>OF</span></span><span> </span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#PhiSem_Mem_C_Base.Map_of_Val_ins.\&lt;F&gt;_functional_refinement|fact"><span>Map_of_Val_ins.ℱ_functional_refinement</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>simplified</span></span><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span class="main"><span>]</span></span></span><span>
                     </span><a class="entity_ref" href="../Phi_Semantics/Phi_System.Resource_Template.html#Resource_Template.pointwise_to_share.\&lt;F&gt;_functional_refinement|fact"><span>pointwise_to_share.ℱ_functional_refinement</span></a><span>
                     </span><a class="entity_ref" href="../Phi_Semantics/Phi_System.Resource_Template.html#Resource_Template.pointwise_to_share.\&lt;F&gt;_functional_projection|fact"><span>pointwise_to_share.ℱ_functional_projection</span></a><span class="main"><span class="main"><span>,</span></span></span><span>
                  </span><span class="keyword2"><span class="keyword"><a class="entity_ref" href="../Phi_System/ISABELLE_HOME/src/HOL/Eisbach/eisbach_rule_insts.ML.html#Eisbach.where|attribute"><span class="operator"><span>where</span></span></a></span></span><span> a4</span><span class="main"><span class="main"><span class="main"><span>=</span></span></span></span><span class="quoted"><span class="quoted"><span>‹</span><a class="entity_ref" href="../../HOL/HOL/Option.html#Option.option.None|const"><span>None</span></a><span>›</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span class="quasi_keyword"><span class="quasi_keyword"><span>and</span></span></span></span></span><span> b4</span><span class="main"><span class="main"><span class="main"><span>=</span></span></span></span><span class="quoted"><span class="quoted"><span>‹</span><a class="entity_ref" href="../../HOL/HOL/Option.html#Option.option.Some|const"><span>Some</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Algebras.Algebras.html#Algebras.discrete.discrete|const"><span>discrete</span></a><span> </span><span class="skolem"><span>u</span></span><span class="main"><span>)</span></span><span>›</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span class="quasi_keyword"><span class="quasi_keyword"><span>for</span></span></span></span></span><span> </span><span class="skolem"><span>u</span></span><span class="main"><span class="main"><span>,</span></span></span><span>
                  </span><span class="operator"><span>simplified</span></span><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span class="keyword3"><span>,</span></span></span><span>
      </span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#PhiSem_Mem_C_Base.Map_of_Val_ins_dom_def|fact"><span>Map_of_Val_ins_dom_def</span></a><span> </span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#offset_26656..26661"><span>prems</span></a><span class="main"><span class="main"><span>(</span></span></span><span>2</span><span class="main"><span class="main"><span>)</span></span></span><span class="main"><span class="keyword3"><span>,</span></span></span><span>
      </span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><span>R.in_invariant</span><span> </span><a class="entity_ref" href="../../HOL/HOL/Fun.html#Fun.inj_image_mem_iff|fact"><span>inj_image_mem_iff</span></a><span> </span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#offset_26656..26661"><span>prems</span></a><span class="main"><span class="main"><span>(</span></span></span><span>2</span><span class="main"><span class="main"><span>)</span></span></span><span class="main"><span class="keyword3"><span>,</span></span></span><span>
      </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.clarsimp|method"><span class="operator"><span>clarsimp</span></span></a><span> </span><span class="quasi_keyword"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><span>R.in_invariant</span><span> </span><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.Ball_def|fact"><span>Ball_def</span></a><span> </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Algebras.Algebras.html#Algebras.dom1_dom|fact"><span>dom1_dom</span></a><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/HOL/Tools/Metis/metis_tactic.ML.html#Metis.metis|method"><span class="operator"><span>metis</span></span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Map.html#Map.dom_map_option_comp|fact"><span>dom_map_option_comp</span></a><span> </span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#offset_26656..26661"><span>prems</span></a><span class="main"><span class="main"><span>(</span></span></span><span>1</span><span class="main"><span class="main"><span>)</span></span></span><span class="main"><span>)</span></span><span>
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span> </span><span class="keyword1"><span class="command"><span>.</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="PhiSem_Mem_C_Base.perm_aggregate_mem_fiction.setter_rule|fact"><span class="entity_def" id="PhiSem_Mem_C_Base.perm_aggregate_mem_fiction.setter_rule|thm"><span>setter_rule</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>assumes</span></span></span><span> </span><span class="entity_def" id="offset_27543..27545">EQ</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>‹</span><span class="keyword1"><a class="entity_ref" href="../Phi_System/Phi_Logic_Programming_Reasoner.PLPR.html#PLPR.Normal_Premise|const"><span>𝗉𝗋𝖾𝗆𝗂𝗌𝖾</span></a></span><span> </span><span class="free"><span>cblk</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="free"><span>blk</span></span><span>›</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>shows</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>‹ </span><a class="entity_ref" href="../Phi_Semantics/PhiSem_Aggregate_Base.html#PhiSem_Aggregate_Base.valid_index|const"><span>valid_index</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span>typ_of_blk</span></span><span> </span><span class="free"><span>blk</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>idx</span></span><span>
      </span><span class="main"><span>⟹</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../Phi_System/Phi_Logic_Programming_Reasoner.PLPR.html#PLPR.Normal_Premise|const"><span>𝗉𝗋𝖾𝗆𝗂𝗌𝖾</span></a></span><span> </span><span class="free"><span>v</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span> </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Semantics_Framework.html#Phi_Semantics_Framework.Well_Type|const"><span>Well_Type</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Phi_Semantics/PhiSem_Aggregate_Base.html#PhiSem_Aggregate_Base.index_type|const"><span>index_type</span></a><span> </span><span class="free"><span>idx</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>typ_of_blk</span></span><span> </span><span class="free"><span>blk</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>
      </span><span class="main"><span>⟹</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../Phi_System/Phi_Logic_Programming_Reasoner.PLPR.html#PLPR.Normal_Premise|const"><span>𝗉𝗋𝖾𝗆𝗂𝗌𝖾</span></a></span><span> </span><span class="free"><span>u_idx</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span> </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Semantics_Framework.html#Phi_Semantics_Framework.Well_Type|const"><span>Well_Type</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Phi_Semantics/PhiSem_Aggregate_Base.html#PhiSem_Aggregate_Base.index_type|const"><span>index_type</span></a><span> </span><span class="free"><span>idx</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>typ_of_blk</span></span><span> </span><span class="free"><span>blk</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>
      </span><span class="main"><span>⟹</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../Phi_System/Phi_Logic_Programming_Reasoner.PLPR.html#PLPR.Normal_Premise|const"><span>𝗉𝗋𝖾𝗆𝗂𝗌𝖾</span></a></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>∀</span></span><span class="bound"><span>x</span></span><span class="main"><span>∈</span></span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Semantics_Framework.html#Phi_Semantics_Framework.Well_Type|const"><span>Well_Type</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span>typ_of_blk</span></span><span> </span><span class="free"><span>blk</span></span><span class="main"><span>)</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="../Phi_Semantics/PhiSem_Aggregate_Base.html#PhiSem_Aggregate_Base.index_mod_value|const"><span>index_mod_value</span></a><span> </span><span class="free"><span>cidx</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="main"><span class="bound"><span>_</span></span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>v</span></span><span class="main"><span>)</span></span><span> </span><span class="bound"><span>x</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="../Phi_Semantics/PhiSem_Aggregate_Base.html#PhiSem_Aggregate_Base.index_mod_value|const"><span>index_mod_value</span></a><span> </span><span class="free"><span>idx</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="main"><span class="bound"><span>_</span></span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>v</span></span><span class="main"><span>)</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span>
      </span><span class="main"><span>⟹</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../Phi_System/Spec_Framework.html#Spec_Framework.\&lt;phi&gt;Procedure_no_exception|const"><span>𝗉𝗋𝗈𝖼</span></a></span><span> </span><span>R.φR_set_res'</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Phi_Semantics/Phi_System.Resource_Template.html#Resource_Template.map_fun_at|const"><span>map_fun_at</span></a><span> </span><span class="free"><span>cblk</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/Option.html#Option.option.Some|const"><span>Some</span></a><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Fun.html#Fun.comp|const"><span>∘</span></a></span><span> </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Algebras.Algebras.html#Algebras.discrete.map_discrete|const"><span>map_discrete</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Phi_Semantics/PhiSem_Aggregate_Base.html#PhiSem_Aggregate_Base.index_mod_value|const"><span>index_mod_value</span></a><span> </span><span class="free"><span>cidx</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="main"><span class="bound"><span>_</span></span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>v</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Fun.html#Fun.comp|const"><span>∘</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Option.html#Option.option.the|const"><span>the</span></a><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>
            </span><span class="main"><a class="entity_ref" href="../Phi_System/Spec_Framework.html#Spec_Framework.\&lt;phi&gt;Procedure_no_exception|const"><span>⦃</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span class="main"><span>(</span></span><span class="free"><span>blk</span></span><span> </span><span class="main"><span>:=</span></span><span> </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Algebras.Algebras.html#Algebras.to_share|const"><span>to_share</span></a><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Fun.html#Fun.comp|const"><span>∘</span></a></span><span> </span><span class="free"><span>idx</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../Phi_System/Phi_Algebras.Map_of_Tree.html#Map_of_Tree.push_map|const"><span>‣<span class="hidden">⇩</span><sub>m</sub></span></a></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/Option.html#Option.option.map_option|const"><span>map_option</span></a><span> </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Algebras.Algebras.html#Algebras.discrete.discrete|const"><span>discrete</span></a><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Fun.html#Fun.comp|const"><span>∘</span></a></span><span> </span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#PhiSem_Mem_C_Base.Map_of_Val|const"><span>Map_of_Val</span></a><span> </span><span class="free"><span>u_idx</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../Phi_System/Phi_BI.html#Phi_BI.\&lt;phi&gt;Type|const"><span>⦂</span></a></span><span> </span><span>φ</span><span> </span><a class="entity_ref" href="../Phi_System/Phi_BI.html#Phi_BI.Itself|const"><span>Itself</span></a><span> </span><span class="main"><a class="entity_ref" href="../Phi_System/Spec_Framework.html#Spec_Framework.\&lt;phi&gt;Procedure_no_exception|const"><span>⟼</span></a></span><span>
              </span><span class="main"><span>λ</span></span><span class="bound"><span>𝗋𝖾𝗍</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span class="main"><span>(</span></span><span class="free"><span>blk</span></span><span> </span><span class="main"><span>:=</span></span><span> </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Algebras.Algebras.html#Algebras.to_share|const"><span>to_share</span></a><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Fun.html#Fun.comp|const"><span>∘</span></a></span><span> </span><span class="free"><span>idx</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../Phi_System/Phi_Algebras.Map_of_Tree.html#Map_of_Tree.push_map|const"><span>‣<span class="hidden">⇩</span><sub>m</sub></span></a></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/Option.html#Option.option.map_option|const"><span>map_option</span></a><span> </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Algebras.Algebras.html#Algebras.discrete.discrete|const"><span>discrete</span></a><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Fun.html#Fun.comp|const"><span>∘</span></a></span><span> </span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#PhiSem_Mem_C_Base.Map_of_Val|const"><span>Map_of_Val</span></a><span> </span><span class="free"><span>v</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../Phi_System/Phi_BI.html#Phi_BI.\&lt;phi&gt;Type|const"><span>⦂</span></a></span><span> </span><span>φ</span><span> </span><a class="entity_ref" href="../Phi_System/Phi_BI.html#Phi_BI.Itself|const"><span>Itself</span></a><span> </span><span class="main"><a class="entity_ref" href="../Phi_System/Spec_Framework.html#Spec_Framework.\&lt;phi&gt;Procedure_no_exception|const"><span>⦄</span></a></span><span> ›</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="../Phi_System/Phi_Logic_Programming_Reasoner.PLPR.html#PLPR.Premise_def|fact"><span>Premise_def</span></a><span>
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>only</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#offset_27543..27545"><span>EQ</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>unfolded</span></span><span> </span><a class="entity_ref" href="../Phi_System/Phi_Logic_Programming_Reasoner.PLPR.html#PLPR.Premise_def|fact"><span>Premise_def</span></a><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span class="keyword3"><span>,</span></span></span><span>
      </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/classical.ML.html#HOL.rule|method"><span class="operator"><span>rule</span></span></a><span> </span><span class="quoted"><span>"</span><span>_setter_rule_2_</span><span>"</span></span><span class="main"><span class="main"><span>[</span></span></span><span class="keyword2"><span class="keyword"><a class="entity_ref" href="../Phi_System/ISABELLE_HOME/src/HOL/Eisbach/eisbach_rule_insts.ML.html#Eisbach.where|attribute"><span class="operator"><span>where</span></span></a></span></span><span> f</span><span class="main"><span class="main"><span class="main"><span>=</span></span></span></span><span class="quoted"><span class="quoted"><span>‹</span><a class="entity_ref" href="../../HOL/HOL/Option.html#Option.option.Some|const"><span>Some</span></a><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Fun.html#Fun.comp|const"><span>∘</span></a></span><span> </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Algebras.Algebras.html#Algebras.discrete.map_discrete|const"><span>map_discrete</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Phi_Semantics/PhiSem_Aggregate_Base.html#PhiSem_Aggregate_Base.index_mod_value|const"><span>index_mod_value</span></a><span> </span><span class="skolem"><span>cidx</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="main"><span class="bound"><span>_</span></span></span><span class="main"><span>.</span></span><span> </span><span class="skolem"><span>v</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>›</span></span></span><span>
                        </span><span class="keyword2"><span class="keyword"><span class="quasi_keyword"><span class="quasi_keyword"><span>and</span></span></span></span></span><span> V</span><span class="main"><span class="main"><span class="main"><span>=</span></span></span></span><span class="quoted"><span class="quoted"><span>‹</span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Algebras.Algebras.html#Algebras.discrete.discrete|const"><span>discrete</span></a><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.image|const"><span>`</span></a></span><span> </span><span class="main"><span>{</span></span><span class="bound"><span>a</span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="../Phi_Semantics/PhiSem_Aggregate_Base.html#PhiSem_Aggregate_Base.index_value|const"><span>index_value</span></a><span> </span><span class="skolem"><span>idx</span></span><span> </span><span class="bound"><span>a</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="skolem"><span>u_idx</span></span><span class="main"><span>}</span></span><span>›</span></span></span><span>
                        </span><span class="keyword2"><span class="keyword"><span class="quasi_keyword"><span class="quasi_keyword"><span>and</span></span></span></span></span><span> F</span><span class="main"><span class="main"><span class="main"><span>=</span></span></span></span><span class="quoted"><span class="quoted"><span>‹</span><span class="main"><span>λ</span></span><span class="main"><span class="bound"><span>_</span></span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Algebras.Algebras.html#Algebras.to_share|const"><span>to_share</span></a><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/Fun.html#Fun.comp|const"><span>o</span></a></span><span> </span><span class="skolem"><span>idx</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../Phi_System/Phi_Algebras.Map_of_Tree.html#Map_of_Tree.push_map|const"><span>‣<span class="hidden">⇩</span><sub>m</sub></span></a></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/Option.html#Option.option.map_option|const"><span>map_option</span></a><span> </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Algebras.Algebras.html#Algebras.discrete.discrete|const"><span>discrete</span></a><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Fun.html#Fun.comp|const"><span>∘</span></a></span><span> </span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#PhiSem_Mem_C_Base.Map_of_Val|const"><span>Map_of_Val</span></a><span> </span><span class="skolem"><span>v</span></span><span class="main"><span>)</span></span><span>›</span></span></span><span>
                        </span><span class="keyword2"><span class="keyword"><span class="quasi_keyword"><span class="quasi_keyword"><span>for</span></span></span></span></span><span> </span><span class="skolem"><span>idx</span></span><span> </span><span class="skolem"><span>cidx</span></span><span> </span><span class="skolem"><span>v</span></span><span> </span><span class="skolem"><span>u_idx</span></span><span class="main"><span class="main"><span>,</span></span></span><span>
                      </span><span class="operator"><span>OF</span></span><span> _ </span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#PhiSem_Mem_C_Base.fiction_Map_of_Val_perm_partial_refinement|fact"><span>fiction_Map_of_Val_perm_partial_refinement</span></a><span>
                         </span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#PhiSem_Mem_C_Base.fiction_Map_of_Val_ins_perm_projection|fact"><span>fiction_Map_of_Val_ins_perm_projection</span></a><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span class="keyword3"><span>,</span></span></span><span>
      </span><span class="operator"><span>simp</span></span><span class="main"><span class="keyword3"><span>,</span></span></span><span>
      </span><span class="operator"><span>assumption</span></span><span class="main"><span class="keyword3"><span>,</span></span></span><span>
      </span><span class="operator"><span>assumption</span></span><span class="main"><span class="keyword3"><span>,</span></span></span><span>
      </span><span class="operator"><span>assumption</span></span><span class="main"><span class="keyword3"><span>,</span></span></span><span>
      </span><span class="operator"><span>assumption</span></span><span class="main"><span class="keyword3"><span>,</span></span></span><span>
      </span><span class="operator"><span>assumption</span></span><span class="main"><span class="keyword3"><span>,</span></span></span><span>
      </span><span class="operator"><span>assumption</span></span><span class="main"><span class="keyword3"><span>,</span></span></span><span>
      </span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Algebras.Algebras.html#Algebras.split_discrete_meta_all|fact"><span>split_discrete_meta_all</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Fun.html#Fun.inj_image_mem_iff|fact"><span>inj_image_mem_iff</span></a><span> </span><a class="entity_ref" href="../Phi_Semantics/PhiSem_Aggregate_Base.html#PhiSem_Aggregate_Base.index_mod_value_welltyp|fact"><span>index_mod_value_welltyp</span></a><span class="main"><span>)</span></span><span>


</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="PhiSem_Mem_C_Base.perm_aggregate_mem_fiction.deallocate_rule|fact"><span class="entity_def" id="PhiSem_Mem_C_Base.perm_aggregate_mem_fiction.deallocate_rule|thm"><span>deallocate_rule</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="quoted"><span class="quoted"><span>‹ </span><span class="keyword1"><a class="entity_ref" href="../Phi_System/Phi_Logic_Programming_Reasoner.PLPR.html#PLPR.Normal_Premise|const"><span>𝗉𝗋𝖾𝗆𝗂𝗌𝖾</span></a></span><span> </span><span class="free"><span>v</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>∈</span></a></span><span> </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Semantics_Framework.html#Phi_Semantics_Framework.Well_Type|const"><span>Well_Type</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span>typ_of_blk</span></span><span> </span><span class="free"><span>blk</span></span><span class="main"><span>)</span></span><span>
</span><span class="main"><span>⟹</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../Phi_System/Spec_Framework.html#Spec_Framework.\&lt;phi&gt;Procedure_no_exception|const"><span>𝗉𝗋𝗈𝖼</span></a></span><span> </span><span>R.φR_set_res'</span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Phi_Semantics/Phi_System.Resource_Template.html#Resource_Template.map_fun_at|const"><span>map_fun_at</span></a><span> </span><span class="free"><span>blk</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Map.html#Map.empty|const"><span>Map.empty</span></a><span class="main"><span>)</span></span><span>
      </span><span class="main"><a class="entity_ref" href="../Phi_System/Spec_Framework.html#Spec_Framework.\&lt;phi&gt;Procedure_no_exception|const"><span>⦃</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span class="main"><span>(</span></span><span class="free"><span>blk</span></span><span> </span><span class="main"><span>:=</span></span><span> </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Algebras.Algebras.html#Algebras.to_share|const"><span>to_share</span></a><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Fun.html#Fun.comp|const"><span>∘</span></a></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/Option.html#Option.option.map_option|const"><span>map_option</span></a><span> </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Algebras.Algebras.html#Algebras.discrete.discrete|const"><span>discrete</span></a><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Fun.html#Fun.comp|const"><span>∘</span></a></span><span> </span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#PhiSem_Mem_C_Base.Map_of_Val|const"><span>Map_of_Val</span></a><span> </span><span class="free"><span>v</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../Phi_System/Phi_BI.html#Phi_BI.\&lt;phi&gt;Type|const"><span>⦂</span></a></span><span> </span><span>φ</span><span> </span><a class="entity_ref" href="../Phi_System/Phi_BI.html#Phi_BI.Itself|const"><span>Itself</span></a><span> </span><span class="main"><a class="entity_ref" href="../Phi_System/Spec_Framework.html#Spec_Framework.\&lt;phi&gt;Procedure_no_exception|const"><span>⟼</span></a></span><span>
        </span><span class="main"><span>λ</span></span><span class="bound"><span>𝗋𝖾𝗍</span></span><span class="main"><span>.</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../Phi_System/Phi_BI.html#Phi_BI.\&lt;phi&gt;Type|const"><span>⦂</span></a></span><span> </span><span>φ</span><span> </span><a class="entity_ref" href="../Phi_System/Phi_BI.html#Phi_BI.Itself|const"><span>Itself</span></a><span> </span><span class="main"><a class="entity_ref" href="../Phi_System/Spec_Framework.html#Spec_Framework.\&lt;phi&gt;Procedure_no_exception|const"><span>⦄</span></a></span><span> ›</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="../Phi_System/Phi_Logic_Programming_Reasoner.PLPR.html#PLPR.Premise_def|fact"><span>Premise_def</span></a><span>
</span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>subgoal</span></span></span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>premises</span></span></span><span> </span><span class="entity_def" id="offset_29132..29137">prems</span><span>
</span><span class="keyword1"><span class="command"><span>proof</span></span></span><span> </span><span class="operator"><span>-</span></span><span>
  </span><span class="keyword1"><span class="command"><span>have</span></span></span><span> </span><span class="main"><span>[</span></span><span class="operator"><span>simp</span></span><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span>
    </span><span class="quoted"><span class="quoted"><span>‹</span><a class="entity_ref" href="../../HOL/HOL/Map.html#Map.empty|const"><span>Map.empty</span></a><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Fun.html#Fun.comp|const"><span>∘</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Option.html#Option.option.the|const"><span>the</span></a><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Map.html#Map.empty|const"><span>Map.empty</span></a><span>›</span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.fun_eq_iff|fact"><span>fun_eq_iff</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="operator"><span>simp</span></span><span>

  </span><span class="keyword1"><span class="command"><span>note</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Fun.html#Fun.inj_image_mem_iff|fact"><span>inj_image_mem_iff</span></a><span class="main"><span>[</span></span><span class="operator"><span>simp</span></span><span class="main"><span>]</span></span><span> </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Algebras.Algebras.html#Algebras.pointwise_set_UNIV|fact"><span>pointwise_set_UNIV</span></a><span class="main"><span>[</span></span><span class="operator"><span>simp</span></span><span class="main"><span>]</span></span><span> </span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#PhiSem_Mem_C_Base.\&lt;F&gt;_functional_condition_Map_of_Val_ins_dom|fact"><span>ℱ_functional_condition_Map_of_Val_ins_dom</span></a><span class="main"><span>[</span></span><span class="operator"><span>simp</span></span><span class="main"><span>]</span></span><span>
       </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Algebras.Phi_Fiction.html#Phi_Fiction.\&lt;F&gt;_functional_comp|fact"><span>ℱ_functional_comp</span></a><span class="main"><span>[</span></span><span class="keyword2"><span class="keyword"><a class="entity_ref" href="../Phi_System/ISABELLE_HOME/src/HOL/Eisbach/eisbach_rule_insts.ML.html#Eisbach.where|attribute"><span class="operator"><span>where</span></span></a></span></span><span> f</span><span class="main"><span class="main"><span>=</span></span></span><span class="quoted"><span class="quoted"><span>‹</span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Fun.html#Fun.comp|const"><span>(∘)</span></a></span><span> </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Algebras.Algebras.html#Algebras.to_share|const"><span>to_share</span></a><span>›</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span class="quasi_keyword"><span>and</span></span></span></span><span> Df</span><span class="main"><span class="main"><span>=</span></span></span><span class="quoted"><span class="quoted"><span>‹</span><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.UNIV|const"><span>UNIV</span></a><span>›</span></span></span><span class="main"><span>,</span></span><span> </span><span class="operator"><span>simplified</span></span><span class="main"><span>,</span></span><span> </span><span class="operator"><span>symmetric</span></span><span class="main"><span>,</span></span><span> </span><span class="operator"><span>simp</span></span><span class="main"><span>]</span></span><span>

  </span><span class="keyword3"><span class="command"><span>show</span></span></span><span> </span><span class="var"><span class="quoted"><span class="var"><span>?thesis</span></span></span></span><span>
    </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/classical.ML.html#HOL.rule|method"><span class="operator"><span>rule</span></span></a><span> </span><span class="quoted"><span>"</span><span>_setter_rule_2_</span><span>"</span></span><span class="main"><span class="main"><span>[</span></span></span><span class="keyword2"><span class="keyword"><a class="entity_ref" href="../Phi_System/ISABELLE_HOME/src/HOL/Eisbach/eisbach_rule_insts.ML.html#Eisbach.where|attribute"><span class="operator"><span>where</span></span></a></span></span><span> f</span><span class="main"><span class="main"><span class="main"><span>=</span></span></span></span><span class="quoted"><span class="quoted"><span>‹</span><span class="main"><span>λ</span></span><span class="main"><span class="bound"><span>_</span></span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Option.html#Option.option.None|const"><span>None</span></a><span>›</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span class="quasi_keyword"><span class="quasi_keyword"><span>and</span></span></span></span></span><span> V</span><span class="main"><span class="main"><span class="main"><span>=</span></span></span></span><span class="quoted"><span class="quoted"><span>‹</span><span class="main"><span>{</span></span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Algebras.Algebras.html#Algebras.discrete.discrete|const"><span>discrete</span></a><span> </span><span class="skolem"><span>v</span></span><span class="main"><span>}</span></span><span>›</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span class="quasi_keyword"><span class="quasi_keyword"><span>and</span></span></span></span></span><span> F</span><span class="main"><span class="main"><span class="main"><span>=</span></span></span></span><span class="quoted"><span class="quoted"><span>‹</span><span class="main"><span>λ</span></span><span class="main"><span class="bound"><span>_</span></span></span><span class="main"><span>.</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.one_class.one|const"><span>1</span></a></span><span>›</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span class="quasi_keyword"><span class="quasi_keyword"><span>for</span></span></span></span></span><span> </span><span class="skolem"><span>v</span></span><span class="main"><span class="main"><span>,</span></span></span><span> </span><span class="operator"><span>simplified</span></span><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span class="keyword3"><span>,</span></span></span><span>
        </span><span class="operator"><span>simp</span></span><span class="main"><span class="keyword3"><span>,</span></span></span><span>
        </span><span class="operator"><span>unfold</span></span><span> </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Algebras.Phi_Fiction.html#Phi_Fiction.refinement_source_subjection|fact"><span>refinement_source_subjection</span></a><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/classical.ML.html#HOL.rule|method"><span class="operator"><span>rule</span></span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.impI|fact"><span>impI</span></a><span class="main"><span class="keyword3"><span>,</span></span></span><span>
        </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/classical.ML.html#HOL.rule|method"><span class="operator"><span>rule</span></span></a><span> </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Algebras.Phi_Fiction.html#Phi_Fiction.sep_refinement_stepwise|fact"><span>sep_refinement_stepwise</span></a><span class="main"><span class="main"><span>[</span></span></span><span>
                  </span><span class="operator"><span>OF</span></span><span> </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Algebras.Phi_Fiction.html#Phi_Fiction.refinement_frame|fact"><span>refinement_frame</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>OF</span></span><span> </span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#PhiSem_Mem_C_Base.Map_of_Val_ins.\&lt;F&gt;_functional_refinement|fact"><span>Map_of_Val_ins.ℱ_functional_refinement</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>simplified</span></span><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span class="main"><span>]</span></span></span><span>
                     </span><a class="entity_ref" href="../Phi_Semantics/Phi_System.Resource_Template.html#Resource_Template.pointwise_to_share.\&lt;F&gt;_functional_refinement|fact"><span>pointwise_to_share.ℱ_functional_refinement</span></a><span>
                     </span><a class="entity_ref" href="../Phi_Semantics/Phi_System.Resource_Template.html#Resource_Template.pointwise_to_share.\&lt;F&gt;_functional_projection|fact"><span>pointwise_to_share.ℱ_functional_projection</span></a><span class="main"><span class="main"><span>,</span></span></span><span>
                  </span><span class="keyword2"><span class="keyword"><a class="entity_ref" href="../Phi_System/ISABELLE_HOME/src/HOL/Eisbach/eisbach_rule_insts.ML.html#Eisbach.where|attribute"><span class="operator"><span>where</span></span></a></span></span><span> a4</span><span class="main"><span class="main"><span class="main"><span>=</span></span></span></span><span class="quoted"><span class="quoted"><span>‹</span><a class="entity_ref" href="../../HOL/HOL/Option.html#Option.option.Some|const"><span>Some</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Algebras.Algebras.html#Algebras.discrete.discrete|const"><span>discrete</span></a><span> </span><span class="skolem"><span>u</span></span><span class="main"><span>)</span></span><span>›</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span class="quasi_keyword"><span class="quasi_keyword"><span>and</span></span></span></span></span><span> b4</span><span class="main"><span class="main"><span class="main"><span>=</span></span></span></span><span class="quoted"><a class="entity_ref" href="../../HOL/HOL/Option.html#Option.option.None|const"><span>None</span></a></span><span> </span><span class="keyword2"><span class="keyword"><span class="quasi_keyword"><span class="quasi_keyword"><span>for</span></span></span></span></span><span> </span><span class="skolem"><span>u</span></span><span class="main"><span class="main"><span>,</span></span></span><span>
                  </span><span class="operator"><span>simplified</span></span><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span class="keyword3"><span>,</span></span></span><span>
        </span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#PhiSem_Mem_C_Base.Map_of_Val_ins_dom_def|fact"><span>Map_of_Val_ins_dom_def</span></a><span class="main"><span class="keyword3"><span>,</span></span></span><span>

        </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/classical.ML.html#HOL.rule|method"><span class="operator"><span>rule</span></span></a><span> </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Algebras.Phi_Fiction.html#Phi_Fiction.refinement_projections_stepwise_UNIV_paired|fact"><span>refinement_projections_stepwise_UNIV_paired</span></a><span class="main"><span class="main"><span>[</span></span></span><span>
          </span><span class="operator"><span>OF</span></span><span> </span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#PhiSem_Mem_C_Base.Map_of_Val_ins.\&lt;F&gt;_functional_projection|fact"><span>Map_of_Val_ins.ℱ_functional_projection</span></a><span>
             </span><a class="entity_ref" href="../Phi_Semantics/Phi_System.Resource_Template.html#Resource_Template.pointwise_to_share.\&lt;F&gt;_functional_projection|fact"><span>pointwise_to_share.ℱ_functional_projection</span></a><span class="main"><span class="main"><span>,</span></span></span><span>
          </span><span class="keyword2"><span class="keyword"><a class="entity_ref" href="../Phi_System/ISABELLE_HOME/src/HOL/Eisbach/eisbach_rule_insts.ML.html#Eisbach.where|attribute"><span class="operator"><span>where</span></span></a></span></span><span> Dc</span><span class="main"><span class="main"><span class="main"><span>=</span></span></span></span><span class="quoted"><span class="quoted"><span>‹</span><span class="main"><span>{</span></span><a class="entity_ref" href="../../HOL/HOL/Option.html#Option.option.Some|const"><span>Some</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Algebras.Algebras.html#Algebras.discrete.discrete|const"><span>discrete</span></a><span> </span><span class="free"><span>v</span></span><span class="main"><span>)</span></span><span class="main"><span>}</span></span><span>›</span></span></span><span class="main"><span class="main"><span>,</span></span></span><span>
          </span><span class="operator"><span>simplified</span></span><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span class="keyword3"><span>,</span></span></span><span>
        </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/classical.ML.html#HOL.rule|method"><span class="operator"><span>rule</span></span></a><span> </span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#offset_29132..29137"><span>prems</span></a><span class="main"><span>)</span></span><span>
</span><span class="keyword1"><span class="command"><span>qed</span></span></span><span> </span><span class="keyword1"><span class="command"><span>.</span></span></span><span>

</span><span class="keyword2"><span class="keyword"><span>end</span></span></span><span>

</span><span class="keyword2"><span class="keyword"><span>end</span></span></span><span>

</span><span class="keyword2"><span class="keyword"><span>end</span></span></span></pre>
</body>

</html>